{"version":3,"file":"push.js","names":["commands","rimrafAsync","B","promisify","rimraf","writeFileAsync","fs","writeFile","pushNotification","payload","dstPath","path","resolve","os","tmpdir","uuidV4","JSON","stringify","exec","args","requireUdid"],"sources":["../../../lib/subcommands/push.js"],"sourcesContent":["import rimraf from 'rimraf';\nimport { v4 as uuidV4 } from 'uuid';\nimport path from 'path';\nimport os from 'os';\nimport fs from 'fs';\nimport B from 'bluebird';\n\nconst commands = {};\nconst rimrafAsync = B.promisify(rimraf);\nconst writeFileAsync = B.promisify(fs.writeFile);\n\n/**\n * Send a simulated push notification\n *\n * @since Xcode 11.4 SDK\n * @param {Object} payload - The object that describes Apple push notification content.\n * It must contain a top-level \"Simulator Target Bundle\" key with a string value matching\n * the target applicationâ€˜s bundle identifier and \"aps\" key with valid Apple Push Notification values.\n * For example:\n * {\n *   \"Simulator Target Bundle\": \"com.apple.Preferences\",\n *   \"aps\": {\n *     \"alert\": \"This is a simulated notification!\",\n *     \"badge\": 3,\n *     \"sound\": \"default\"\n *   }\n * }\n * @throws {Error} if the current SDK version does not support the command\n * or there was an error while pushing the notification\n * @throws {Error} If the `udid` instance property is unset\n */\ncommands.pushNotification = async function pushNotification (payload) {\n  const dstPath = path.resolve(os.tmpdir(), `${uuidV4()}.json`);\n  try {\n    await writeFileAsync(dstPath, JSON.stringify(payload), 'utf8');\n    await this.exec('push', {\n      args: [this.requireUdid('push'), dstPath],\n    });\n  } finally {\n    await rimrafAsync(dstPath);\n  }\n};\n\nexport default commands;\n"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,QAAQ,GAAG,CAAC,CAAC;AACnB,MAAMC,WAAW,GAAGC,iBAAC,CAACC,SAAS,CAACC,eAAM,CAAC;AACvC,MAAMC,cAAc,GAAGH,iBAAC,CAACC,SAAS,CAACG,WAAE,CAACC,SAAS,CAAC;AAsBhDP,QAAQ,CAACQ,gBAAgB,GAAG,eAAeA,gBAAgB,CAAEC,OAAO,EAAE;EACpE,MAAMC,OAAO,GAAGC,aAAI,CAACC,OAAO,CAACC,WAAE,CAACC,MAAM,EAAE,EAAG,GAAE,IAAAC,QAAM,GAAG,OAAM,CAAC;EAC7D,IAAI;IACF,MAAMV,cAAc,CAACK,OAAO,EAAEM,IAAI,CAACC,SAAS,CAACR,OAAO,CAAC,EAAE,MAAM,CAAC;IAC9D,MAAM,IAAI,CAACS,IAAI,CAAC,MAAM,EAAE;MACtBC,IAAI,EAAE,CAAC,IAAI,CAACC,WAAW,CAAC,MAAM,CAAC,EAAEV,OAAO;IAC1C,CAAC,CAAC;EACJ,CAAC,SAAS;IACR,MAAMT,WAAW,CAACS,OAAO,CAAC;EAC5B;AACF,CAAC;AAAC,eAEaV,QAAQ;AAAA"}