"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PlistServiceDecoder = void 0;
require("source-map-support/register");
var _lodash = _interopRequireDefault(require("lodash"));
var _stream = _interopRequireDefault(require("stream"));
var _support = require("@appium/support");
const HEADER_LENGTH = 4;
class PlistServiceDecoder extends _stream.default.Transform {
  constructor() {
    super({
      objectMode: true
    });
  }
  _transform(data, encoding, onData) {
    this._decode(data);
    onData();
  }
  _decode(data) {
    const payload = data.slice(HEADER_LENGTH, data.length);
    if (_lodash.default.isEmpty(payload)) {
      return;
    }
    const object = _support.plist.parsePlist(payload);
    if (!object) {
      return;
    }
    this.push(object);
  }
}
exports.PlistServiceDecoder = PlistServiceDecoder;
var _default = PlistServiceDecoder;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJIRUFERVJfTEVOR1RIIiwiUGxpc3RTZXJ2aWNlRGVjb2RlciIsIlN0cmVhbSIsIlRyYW5zZm9ybSIsImNvbnN0cnVjdG9yIiwib2JqZWN0TW9kZSIsIl90cmFuc2Zvcm0iLCJkYXRhIiwiZW5jb2RpbmciLCJvbkRhdGEiLCJfZGVjb2RlIiwicGF5bG9hZCIsInNsaWNlIiwibGVuZ3RoIiwiXyIsImlzRW1wdHkiLCJvYmplY3QiLCJwbGlzdCIsInBhcnNlUGxpc3QiLCJwdXNoIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vbGliL3BsaXN0LXNlcnZpY2UvdHJhbnNmb3JtZXIvcGxpc3Qtc2VydmljZS1kZWNvZGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgU3RyZWFtIGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgeyBwbGlzdCB9IGZyb20gJ0BhcHBpdW0vc3VwcG9ydCc7XG5cbmNvbnN0IEhFQURFUl9MRU5HVEggPSA0O1xuXG5jbGFzcyBQbGlzdFNlcnZpY2VEZWNvZGVyIGV4dGVuZHMgU3RyZWFtLlRyYW5zZm9ybSB7XG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHN1cGVyKHsgb2JqZWN0TW9kZTogdHJ1ZSB9KTtcbiAgfVxuXG4gIF90cmFuc2Zvcm0gKGRhdGEsIGVuY29kaW5nLCBvbkRhdGEpIHtcbiAgICB0aGlzLl9kZWNvZGUoZGF0YSk7XG4gICAgb25EYXRhKCk7XG4gIH1cblxuICBfZGVjb2RlIChkYXRhKSB7XG4gICAgY29uc3QgcGF5bG9hZCA9IGRhdGEuc2xpY2UoSEVBREVSX0xFTkdUSCwgZGF0YS5sZW5ndGgpO1xuICAgIGlmIChfLmlzRW1wdHkocGF5bG9hZCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgb2JqZWN0ID0gcGxpc3QucGFyc2VQbGlzdChwYXlsb2FkKTtcbiAgICBpZiAoIW9iamVjdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnB1c2gob2JqZWN0KTtcbiAgfVxufVxuXG5leHBvcnQgeyBQbGlzdFNlcnZpY2VEZWNvZGVyIH07XG5leHBvcnQgZGVmYXVsdCBQbGlzdFNlcnZpY2VEZWNvZGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLGFBQWEsR0FBRyxDQUFDO0FBRXZCLE1BQU1DLG1CQUFtQixTQUFTQyxlQUFNLENBQUNDLFNBQVMsQ0FBQztFQUVqREMsV0FBVyxHQUFJO0lBQ2IsS0FBSyxDQUFDO01BQUVDLFVBQVUsRUFBRTtJQUFLLENBQUMsQ0FBQztFQUM3QjtFQUVBQyxVQUFVLENBQUVDLElBQUksRUFBRUMsUUFBUSxFQUFFQyxNQUFNLEVBQUU7SUFDbEMsSUFBSSxDQUFDQyxPQUFPLENBQUNILElBQUksQ0FBQztJQUNsQkUsTUFBTSxFQUFFO0VBQ1Y7RUFFQUMsT0FBTyxDQUFFSCxJQUFJLEVBQUU7SUFDYixNQUFNSSxPQUFPLEdBQUdKLElBQUksQ0FBQ0ssS0FBSyxDQUFDWixhQUFhLEVBQUVPLElBQUksQ0FBQ00sTUFBTSxDQUFDO0lBQ3RELElBQUlDLGVBQUMsQ0FBQ0MsT0FBTyxDQUFDSixPQUFPLENBQUMsRUFBRTtNQUN0QjtJQUNGO0lBQ0EsTUFBTUssTUFBTSxHQUFHQyxjQUFLLENBQUNDLFVBQVUsQ0FBQ1AsT0FBTyxDQUFDO0lBQ3hDLElBQUksQ0FBQ0ssTUFBTSxFQUFFO01BQ1g7SUFDRjtJQUNBLElBQUksQ0FBQ0csSUFBSSxDQUFDSCxNQUFNLENBQUM7RUFDbkI7QUFDRjtBQUFDO0FBQUEsZUFHY2YsbUJBQW1CO0FBQUEifQ==