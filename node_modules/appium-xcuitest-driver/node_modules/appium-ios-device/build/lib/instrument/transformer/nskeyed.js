"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.NSUUID = exports.NSURL = exports.NSDate = exports.BaseArchiveHandler = void 0;
exports.archive = archive;
exports.unarchive = unarchive;
exports.updateNSKeyedArchiveClass = updateNSKeyedArchiveClass;
require("source-map-support/register");
var _bplistParser = _interopRequireDefault(require("bplist-parser"));
var _bplistCreator = _interopRequireDefault(require("bplist-creator"));
var _uuid = require("uuid");
var _lodash = _interopRequireDefault(require("lodash"));
const NSKEYED_ARCHIVE_VERSION = 100_000;
const NULL_UID = new _bplistParser.default.UID(0);
const CYCLE_TOKEN = 'CycleToken';
const PRIMITIVE_TYPES = ['Number', 'String', 'Boolean', 'UID', 'Buffer'];
const NON_ENCODABLE_TYPES = ['number', 'boolean'];
const NSKEYEDARCHIVER = 'NSKeyedArchiver';
const UNIX2APPLE_TIMESTAMP_SECOND = 978307200;
class ArchivedObject {
  constructor(object, unarchiver) {
    this.object = object;
    this._unarchiver = unarchiver;
  }
  decodeIndex(index) {
    return this._unarchiver.decodeObject(index);
  }
  decode(key) {
    return this._unarchiver.decodeKey(this.object, key);
  }
}
class ArchivingObject {
  constructor(object, archiver) {
    this._archiveObj = object;
    this._archiver = archiver;
  }
  encode(key, val) {
    this._archiveObj[key] = this._archiver.encode(val);
  }
}
class BaseArchiveHandler {
  decodeArchive(archive) {
    throw new Error(`Did not know how to decode the object`);
  }
  encodeArchive(obj, archive) {
    throw new Error(`Did not know how to encode the object`);
  }
}
exports.BaseArchiveHandler = BaseArchiveHandler;
class DictArchive extends BaseArchiveHandler {
  decodeArchive(archive) {
    const keyUids = archive.decode('NS.keys');
    const valUids = archive.decode('NS.objects');
    const d = {};
    for (let i = 0; i < keyUids.length; i++) {
      const key = archive.decodeIndex(keyUids[i]);
      d[key] = archive.decodeIndex(valUids[i]);
    }
    return d;
  }
}
class ListArchive extends BaseArchiveHandler {
  decodeArchive(archive) {
    const uids = archive.decode('NS.objects');
    return uids.map(archive.decodeIndex.bind(archive));
  }
}
class DTTapMessagePlist extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('DTTapMessagePlist');
  }
}
class NSError extends BaseArchiveHandler {
  decodeArchive(archive) {
    return {
      '$class': 'NSError',
      'domain': archive.decode('NSDomain'),
      'userinfo': archive.decode('NSUserInfo'),
      'code': archive.decode('NSCode')
    };
  }
}
class NSException extends BaseArchiveHandler {
  decodeArchive(archive) {
    return {
      '$class': 'NSException',
      'reason': archive.decode('NS.reason'),
      'userinfo': archive.decode('userinfo'),
      'name': archive.decode('NS.name')
    };
  }
}
class NSURL extends BaseArchiveHandler {
  constructor(base, relative) {
    super();
    this._base = base;
    this._relative = relative;
  }
  decodeArchive(archive) {
    return {
      $class: 'NSURL',
      base: archive.decode('NS.base'),
      relative: archive.decode('NS.relative')
    };
  }
  encodeArchive(obj, archive) {
    archive.encode('NS.base', obj._base);
    archive.encode('NS.relative', obj._relative);
  }
}
exports.NSURL = NSURL;
class NSDate extends BaseArchiveHandler {
  constructor(data) {
    super();
    this._data = data;
  }
  decodeArchive(archive) {
    return UNIX2APPLE_TIMESTAMP_SECOND + archive.decode('NS.time');
  }
  encodeArchive(obj, archive) {
    archive.encode('NS.time', obj._data - UNIX2APPLE_TIMESTAMP_SECOND);
  }
}
exports.NSDate = NSDate;
class NSMutableString extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('NS.string');
  }
}
class NSMutableData extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('NS.data');
  }
}
class NSUUID extends BaseArchiveHandler {
  constructor(data) {
    super();
    this._data = data;
  }
  decodeArchive(archive) {
    return (0, _uuid.stringify)(archive.decode('NS.uuidbytes'));
  }
  encodeArchive(obj, archive) {
    archive._archiveObj['NS.uuidbytes'] = Buffer.from((0, _uuid.parse)(obj._data).buffer);
  }
}
exports.NSUUID = NSUUID;
class XCTCapabilities extends BaseArchiveHandler {
  decodeArchive(archive) {
    return archive.decode('capabilities-dictionary');
  }
}
class NSNull extends BaseArchiveHandler {
  decodeArchive() {
    return null;
  }
}
const UNARCHIVE_CLASS_MAP = {
  DTTapMessagePlist,
  DTSysmonTapMessage: DTTapMessagePlist,
  DTTapHeartbeatMessage: DTTapMessagePlist,
  DTTapMessageArchive: DTTapMessagePlist,
  DTKTraceTapMessage: DTTapMessagePlist,
  ErrorArchive: NSError,
  ExceptionArchive: NSException,
  NSDictionary: DictArchive,
  NSMutableDictionary: DictArchive,
  NSArray: ListArchive,
  NSMutableArray: ListArchive,
  NSMutableSet: ListArchive,
  NSSet: ListArchive,
  NSDate,
  NSError,
  NSException,
  NSMutableString,
  NSMutableData,
  NSNull,
  NSUUID,
  NSURL,
  XCTCapabilities
};
class Unarchive {
  constructor(inputBytes) {
    this.input = inputBytes;
    this.unpackedUids = {};
    this.topUID = NULL_UID;
    this.objects = [];
  }
  unpackArchiveHeader() {
    const plist = _bplistParser.default.parseBuffer(this.input)[0];
    if (plist.$archiver !== NSKEYEDARCHIVER) {
      throw new Error(`unsupported encoder: ${plist.$archiver}`);
    }
    if (plist.$version !== NSKEYED_ARCHIVE_VERSION) {
      throw new Error(`expected ${NSKEYED_ARCHIVE_VERSION}, got ${plist.$version}`);
    }
    const top = plist.$top;
    const topUID = top.root;
    if (!topUID) {
      throw new Error(`top object did not have a UID! dump: ${JSON.stringify(top)}`);
    }
    this.topUID = topUID;
    this.objects = plist.$objects;
  }
  classForUid(index) {
    const meta = this.objects[index.UID];
    const name = meta.$classname;
    const klass = UNARCHIVE_CLASS_MAP[name];
    if (!klass) {
      throw new Error(`no mapping for ${name} in UNARCHIVE_CLASS_MAP`);
    }
    return klass;
  }
  decodeKey(obj, key) {
    const val = obj[key];
    return _lodash.default.isNil(val === null || val === void 0 ? void 0 : val.UID) ? val : this.decodeObject(val);
  }
  decodeObject(index) {
    if (index === NULL_UID) {
      return null;
    }
    const obj = this.unpackedUids[index];
    if (obj === CYCLE_TOKEN) {
      throw new Error(`archive has a cycle with ${index}`);
    }
    if (!_lodash.default.isUndefined(obj)) {
      return obj;
    }
    const rawObj = this.objects[index.UID];
    this.unpackedUids[index.UID] = CYCLE_TOKEN;
    if (!(rawObj !== null && rawObj !== void 0 && rawObj.$class)) {
      this.unpackedUids[index.UID] = obj;
      return rawObj;
    }
    const klass = this.classForUid(rawObj.$class);
    const klassObj = new klass().decodeArchive(new ArchivedObject(rawObj, this));
    this.unpackedUids[index.UID] = klassObj;
    return klassObj;
  }
  toObject() {
    this.unpackArchiveHeader();
    return this.decodeObject(this.topUID);
  }
}
class Archive {
  constructor(inputObject) {
    this.input = inputObject;
    this.classMap = {};
    this.objects = ['$null'];
  }
  uidForArchiver(archiver) {
    let val = this.classMap[archiver];
    if (val) {
      return new _bplistParser.default.UID(val);
    }
    this.classMap[archiver] = this.objects.length;
    val = new _bplistParser.default.UID(this.objects.length);
    this.objects.push({
      '$classes': [archiver],
      '$classname': archiver
    });
    return val;
  }
  archive(obj) {
    if (_lodash.default.isUndefined(obj) || _lodash.default.isNull(obj)) {
      return NULL_UID;
    }
    const index = new _bplistParser.default.UID(this.objects.length);
    if (PRIMITIVE_TYPES.includes(obj.constructor.name)) {
      this.objects.push(obj);
      return index;
    }
    const archiveObj = {};
    this.objects.push(archiveObj);
    this.encodeTopLevel(obj, archiveObj);
    return index;
  }
  encode(val) {
    if (NON_ENCODABLE_TYPES.includes(typeof val)) {
      return val;
    }
    return this.archive(val);
  }
  encodeTopLevel(obj, archiveObj) {
    if (obj instanceof Array) {
      return this.encodeArray(obj, archiveObj);
    } else if (obj instanceof Set) {
      return this.encodeSet(obj, archiveObj);
    } else if (obj instanceof Object) {
      const objName = obj.constructor.name;
      if (objName in UNARCHIVE_CLASS_MAP) {
        archiveObj.$class = this.uidForArchiver(objName);
        obj.encodeArchive(obj, new ArchivingObject(archiveObj, this));
      } else {
        return this.encodeDict(obj, archiveObj);
      }
    } else {
      throw Error(`Unable to encode types: ${typeof obj}`);
    }
  }
  encodeArray(objs, archiveObj) {
    archiveObj.$class = this.uidForArchiver('NSArray');
    archiveObj['NS.objects'] = objs.map(this.archive.bind(this));
  }
  encodeSet(objs, archiveObj) {
    archiveObj.$class = this.uidForArchiver('NSSet');
    archiveObj['NS.objects'] = objs.map(this.archive.bind(this));
  }
  encodeDict(obj, archiveObj) {
    archiveObj.$class = this.uidForArchiver('NSDictionary');
    archiveObj['NS.keys'] = _lodash.default.keys(obj).map(this.archive.bind(this));
    archiveObj['NS.objects'] = _lodash.default.values(obj).map(this.archive.bind(this));
  }
  toBytes() {
    if (this.objects.length === 1) {
      this.archive(this.input);
    }
    const d = {
      '$version': NSKEYED_ARCHIVE_VERSION,
      '$archiver': NSKEYEDARCHIVER,
      '$top': {
        'root': new _bplistParser.default.UID(1)
      },
      '$objects': this.objects
    };
    return (0, _bplistCreator.default)(d);
  }
}
function archive(inputObject) {
  return new Archive(inputObject).toBytes();
}
function unarchive(inputBytes) {
  return new Unarchive(inputBytes).toObject();
}
function updateNSKeyedArchiveClass(name, subClass) {
  var _subClass$prototype, _subClass$prototype2;
  if (!_lodash.default.isFunction((_subClass$prototype = subClass.prototype) === null || _subClass$prototype === void 0 ? void 0 : _subClass$prototype.decodeArchive) && !_lodash.default.isFunction((_subClass$prototype2 = subClass.prototype) === null || _subClass$prototype2 === void 0 ? void 0 : _subClass$prototype2.encodeArchive)) {
    throw Error('subClass must have decodeArchive or encodeArchive methods');
  }
  if (!(name in UNARCHIVE_CLASS_MAP)) {
    UNARCHIVE_CLASS_MAP[name] = subClass;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTiIsIk5VTExfVUlEIiwicGxpc3RsaWIiLCJVSUQiLCJDWUNMRV9UT0tFTiIsIlBSSU1JVElWRV9UWVBFUyIsIk5PTl9FTkNPREFCTEVfVFlQRVMiLCJOU0tFWUVEQVJDSElWRVIiLCJVTklYMkFQUExFX1RJTUVTVEFNUF9TRUNPTkQiLCJBcmNoaXZlZE9iamVjdCIsImNvbnN0cnVjdG9yIiwib2JqZWN0IiwidW5hcmNoaXZlciIsIl91bmFyY2hpdmVyIiwiZGVjb2RlSW5kZXgiLCJpbmRleCIsImRlY29kZU9iamVjdCIsImRlY29kZSIsImtleSIsImRlY29kZUtleSIsIkFyY2hpdmluZ09iamVjdCIsImFyY2hpdmVyIiwiX2FyY2hpdmVPYmoiLCJfYXJjaGl2ZXIiLCJlbmNvZGUiLCJ2YWwiLCJCYXNlQXJjaGl2ZUhhbmRsZXIiLCJkZWNvZGVBcmNoaXZlIiwiYXJjaGl2ZSIsIkVycm9yIiwiZW5jb2RlQXJjaGl2ZSIsIm9iaiIsIkRpY3RBcmNoaXZlIiwia2V5VWlkcyIsInZhbFVpZHMiLCJkIiwiaSIsImxlbmd0aCIsIkxpc3RBcmNoaXZlIiwidWlkcyIsIm1hcCIsImJpbmQiLCJEVFRhcE1lc3NhZ2VQbGlzdCIsIk5TRXJyb3IiLCJOU0V4Y2VwdGlvbiIsIk5TVVJMIiwiYmFzZSIsInJlbGF0aXZlIiwiX2Jhc2UiLCJfcmVsYXRpdmUiLCIkY2xhc3MiLCJOU0RhdGUiLCJkYXRhIiwiX2RhdGEiLCJOU011dGFibGVTdHJpbmciLCJOU011dGFibGVEYXRhIiwiTlNVVUlEIiwidXVpZFN0cmluZ2lmeSIsIkJ1ZmZlciIsImZyb20iLCJ1dWlkUGFyc2UiLCJidWZmZXIiLCJYQ1RDYXBhYmlsaXRpZXMiLCJOU051bGwiLCJVTkFSQ0hJVkVfQ0xBU1NfTUFQIiwiRFRTeXNtb25UYXBNZXNzYWdlIiwiRFRUYXBIZWFydGJlYXRNZXNzYWdlIiwiRFRUYXBNZXNzYWdlQXJjaGl2ZSIsIkRUS1RyYWNlVGFwTWVzc2FnZSIsIkVycm9yQXJjaGl2ZSIsIkV4Y2VwdGlvbkFyY2hpdmUiLCJOU0RpY3Rpb25hcnkiLCJOU011dGFibGVEaWN0aW9uYXJ5IiwiTlNBcnJheSIsIk5TTXV0YWJsZUFycmF5IiwiTlNNdXRhYmxlU2V0IiwiTlNTZXQiLCJVbmFyY2hpdmUiLCJpbnB1dEJ5dGVzIiwiaW5wdXQiLCJ1bnBhY2tlZFVpZHMiLCJ0b3BVSUQiLCJvYmplY3RzIiwidW5wYWNrQXJjaGl2ZUhlYWRlciIsInBsaXN0IiwicGFyc2VCdWZmZXIiLCIkYXJjaGl2ZXIiLCIkdmVyc2lvbiIsInRvcCIsIiR0b3AiLCJyb290IiwiSlNPTiIsInN0cmluZ2lmeSIsIiRvYmplY3RzIiwiY2xhc3NGb3JVaWQiLCJtZXRhIiwibmFtZSIsIiRjbGFzc25hbWUiLCJrbGFzcyIsIl8iLCJpc05pbCIsImlzVW5kZWZpbmVkIiwicmF3T2JqIiwia2xhc3NPYmoiLCJ0b09iamVjdCIsIkFyY2hpdmUiLCJpbnB1dE9iamVjdCIsImNsYXNzTWFwIiwidWlkRm9yQXJjaGl2ZXIiLCJwdXNoIiwiaXNOdWxsIiwiaW5jbHVkZXMiLCJhcmNoaXZlT2JqIiwiZW5jb2RlVG9wTGV2ZWwiLCJBcnJheSIsImVuY29kZUFycmF5IiwiU2V0IiwiZW5jb2RlU2V0IiwiT2JqZWN0Iiwib2JqTmFtZSIsImVuY29kZURpY3QiLCJvYmpzIiwia2V5cyIsInZhbHVlcyIsInRvQnl0ZXMiLCJicGxpc3RDcmVhdGUiLCJ1bmFyY2hpdmUiLCJ1cGRhdGVOU0tleWVkQXJjaGl2ZUNsYXNzIiwic3ViQ2xhc3MiLCJpc0Z1bmN0aW9uIiwicHJvdG90eXBlIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vbGliL2luc3RydW1lbnQvdHJhbnNmb3JtZXIvbnNrZXllZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGxpc3RsaWIgZnJvbSAnYnBsaXN0LXBhcnNlcic7XG5pbXBvcnQgYnBsaXN0Q3JlYXRlIGZyb20gJ2JwbGlzdC1jcmVhdG9yJztcbmltcG9ydCB7cGFyc2UgYXMgdXVpZFBhcnNlLCBzdHJpbmdpZnkgYXMgdXVpZFN0cmluZ2lmeX0gZnJvbSAndXVpZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5jb25zdCBOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTiA9IDEwMF8wMDA7XG5jb25zdCBOVUxMX1VJRCA9IG5ldyBwbGlzdGxpYi5VSUQoMCk7XG5jb25zdCBDWUNMRV9UT0tFTiA9ICdDeWNsZVRva2VuJztcbmNvbnN0IFBSSU1JVElWRV9UWVBFUyA9IFsnTnVtYmVyJywgJ1N0cmluZycsICdCb29sZWFuJywgJ1VJRCcsICdCdWZmZXInXTtcbmNvbnN0IE5PTl9FTkNPREFCTEVfVFlQRVMgPSBbJ251bWJlcicsICdib29sZWFuJ107XG5jb25zdCBOU0tFWUVEQVJDSElWRVIgPSAnTlNLZXllZEFyY2hpdmVyJztcbmNvbnN0IFVOSVgyQVBQTEVfVElNRVNUQU1QX1NFQ09ORCA9IDk3ODMwNzIwMDtcblxuXG5jbGFzcyBBcmNoaXZlZE9iamVjdCB7XG4gIC8qKlxuICAgKiBTdGF0ZWZ1bCB3cmFwcGVyIGFyb3VuZCBBcmNoaXZlIGZvciBhbiBvYmplY3QgYmVpbmcgYXJjaGl2ZWQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3RcbiAgICogQHBhcmFtIHtVbmFyY2hpdmV9IHVuYXJjaGl2ZXJcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBjb25zdHJ1Y3RvciAob2JqZWN0LCB1bmFyY2hpdmVyKSB7XG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XG4gICAgdGhpcy5fdW5hcmNoaXZlciA9IHVuYXJjaGl2ZXI7XG4gIH1cblxuICBkZWNvZGVJbmRleCAoaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5fdW5hcmNoaXZlci5kZWNvZGVPYmplY3QoaW5kZXgpO1xuICB9XG5cbiAgZGVjb2RlIChrZXkpIHtcbiAgICByZXR1cm4gdGhpcy5fdW5hcmNoaXZlci5kZWNvZGVLZXkodGhpcy5vYmplY3QsIGtleSk7XG4gIH1cbn1cblxuY2xhc3MgQXJjaGl2aW5nT2JqZWN0IHtcbiAgLyoqXG4gICAqIFN0YXRlZnVsIHdyYXBwZXIgYXJvdW5kIFVuYXJjaGl2ZSBmb3IgYW4gYXJjaGl2ZWQgb2JqZWN0XG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3RcbiAgICogQHBhcmFtIHtBcmNoaXZlfSBhcmNoaXZlclxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yIChvYmplY3QsIGFyY2hpdmVyKSB7XG4gICAgdGhpcy5fYXJjaGl2ZU9iaiA9IG9iamVjdDtcbiAgICB0aGlzLl9hcmNoaXZlciA9IGFyY2hpdmVyO1xuICB9XG5cbiAgZW5jb2RlIChrZXksIHZhbCkge1xuICAgIHRoaXMuX2FyY2hpdmVPYmpba2V5XSA9IHRoaXMuX2FyY2hpdmVyLmVuY29kZSh2YWwpO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyBtdXN0IGJlIGluaGVyaXRlZCB3aGVuIGNyZWF0aW5nIGFuIGFyY2hpdmUvdW5hcmNoaXZlIHN1YmNsYXNzXG4gKiBBbmQgeW91IG5lZWQgdG8gY2FsbCBgdXBkYXRlTlNLZXllZEFyY2hpdmVDbGFzc2AgYWRkIHN1YmNsYXNzIHRvIGFyY2hpdmUvdW5hcmNoaXZlIG9iamVjdFxuICovXG5jbGFzcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICAvKipcbiAgICogQHBhcmFtIHtBcmNoaXZlZE9iamVjdH0gYXJjaGl2ZVxuICAgKi9cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIGRlY29kZUFyY2hpdmUgKGFyY2hpdmUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYERpZCBub3Qga25vdyBob3cgdG8gZGVjb2RlIHRoZSBvYmplY3RgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqICBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzXG4gICAqIEBwYXJhbSB7QXJjaGl2aW5nT2JqZWN0fSBhcmNoaXZlXG4gICAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZW5jb2RlQXJjaGl2ZSAob2JqLCBhcmNoaXZlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBEaWQgbm90IGtub3cgaG93IHRvIGVuY29kZSB0aGUgb2JqZWN0YCk7XG4gIH1cbn1cblxuLyoqXG4gKiBcIkRlbGVnYXRlIGZvciBwYWNraW5nL3VucGFja2luZyBOUyhNdXRhYmxlKURpY3Rpb25hcnkgb2JqZWN0c1wiXG4gKi9cbmNsYXNzIERpY3RBcmNoaXZlIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSAoYXJjaGl2ZSkge1xuICAgIGNvbnN0IGtleVVpZHMgPSBhcmNoaXZlLmRlY29kZSgnTlMua2V5cycpO1xuICAgIGNvbnN0IHZhbFVpZHMgPSBhcmNoaXZlLmRlY29kZSgnTlMub2JqZWN0cycpO1xuICAgIGNvbnN0IGQgPSB7fTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleVVpZHMubGVuZ3RoIDsgaSsrKSB7XG4gICAgICBjb25zdCBrZXkgPSBhcmNoaXZlLmRlY29kZUluZGV4KGtleVVpZHNbaV0pO1xuICAgICAgZFtrZXldID0gYXJjaGl2ZS5kZWNvZGVJbmRleCh2YWxVaWRzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGQ7XG4gIH1cbn1cblxuLyoqXG4gKiBEZWxlZ2F0ZSBmb3IgcGFja2luZy91bnBhY2tpbmcgTlMoTXV0YWJsZSlBcnJheSBvYmplY3RzXG4gKi9cbmNsYXNzIExpc3RBcmNoaXZlIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSAoYXJjaGl2ZSkge1xuICAgIGNvbnN0IHVpZHMgPSBhcmNoaXZlLmRlY29kZSgnTlMub2JqZWN0cycpO1xuICAgIHJldHVybiB1aWRzLm1hcChhcmNoaXZlLmRlY29kZUluZGV4LmJpbmQoYXJjaGl2ZSkpO1xuICB9XG59XG5cbmNsYXNzIERUVGFwTWVzc2FnZVBsaXN0IGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSAoYXJjaGl2ZSkge1xuICAgIHJldHVybiBhcmNoaXZlLmRlY29kZSgnRFRUYXBNZXNzYWdlUGxpc3QnKTtcbiAgfVxufVxuXG5jbGFzcyBOU0Vycm9yIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSAoYXJjaGl2ZSkge1xuICAgIHJldHVybiB7XG4gICAgICAnJGNsYXNzJzogJ05TRXJyb3InLFxuICAgICAgJ2RvbWFpbic6IGFyY2hpdmUuZGVjb2RlKCdOU0RvbWFpbicpLFxuICAgICAgJ3VzZXJpbmZvJzogYXJjaGl2ZS5kZWNvZGUoJ05TVXNlckluZm8nKSxcbiAgICAgICdjb2RlJzogYXJjaGl2ZS5kZWNvZGUoJ05TQ29kZScpXG4gICAgfTtcbiAgfVxufVxuXG5jbGFzcyBOU0V4Y2VwdGlvbiBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUgKGFyY2hpdmUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJyRjbGFzcyc6ICdOU0V4Y2VwdGlvbicsXG4gICAgICAncmVhc29uJzogYXJjaGl2ZS5kZWNvZGUoJ05TLnJlYXNvbicpLFxuICAgICAgJ3VzZXJpbmZvJzogYXJjaGl2ZS5kZWNvZGUoJ3VzZXJpbmZvJyksXG4gICAgICAnbmFtZSc6IGFyY2hpdmUuZGVjb2RlKCdOUy5uYW1lJylcbiAgICB9O1xuICB9XG59XG5cbmNsYXNzIE5TVVJMIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7Kn0gYmFzZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmUgdXN1YWxseSBpb3MgZGV2aWNlIHJlbGF0aXZlIHBhdGggZS5nOiBmaWxlOi8veHgvXG4gICAqL1xuICBjb25zdHJ1Y3RvciAoYmFzZSwgcmVsYXRpdmUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX2Jhc2UgPSBiYXNlO1xuICAgIHRoaXMuX3JlbGF0aXZlID0gcmVsYXRpdmU7XG4gIH1cblxuICBkZWNvZGVBcmNoaXZlIChhcmNoaXZlKSB7XG4gICAgcmV0dXJuIHskY2xhc3M6ICdOU1VSTCcsIGJhc2U6IGFyY2hpdmUuZGVjb2RlKCdOUy5iYXNlJyksIHJlbGF0aXZlOiBhcmNoaXZlLmRlY29kZSgnTlMucmVsYXRpdmUnKX07XG4gIH1cblxuICBlbmNvZGVBcmNoaXZlIChvYmosIGFyY2hpdmUpIHtcbiAgICBhcmNoaXZlLmVuY29kZSgnTlMuYmFzZScsIG9iai5fYmFzZSk7XG4gICAgYXJjaGl2ZS5lbmNvZGUoJ05TLnJlbGF0aXZlJywgb2JqLl9yZWxhdGl2ZSk7XG4gIH1cbn1cblxuY2xhc3MgTlNEYXRlIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRhIHRpbWVzdGFtcCBpbiBzZWNvbmRzXG4gICAqL1xuICBjb25zdHJ1Y3RvciAoZGF0YSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gIH1cblxuICBkZWNvZGVBcmNoaXZlIChhcmNoaXZlKSB7XG4gICAgcmV0dXJuIFVOSVgyQVBQTEVfVElNRVNUQU1QX1NFQ09ORCArIGFyY2hpdmUuZGVjb2RlKCdOUy50aW1lJyk7XG4gIH1cblxuICBlbmNvZGVBcmNoaXZlIChvYmosIGFyY2hpdmUpIHtcbiAgICBhcmNoaXZlLmVuY29kZSgnTlMudGltZScsIG9iai5fZGF0YSAtIFVOSVgyQVBQTEVfVElNRVNUQU1QX1NFQ09ORCk7XG4gIH1cbn1cblxuY2xhc3MgTlNNdXRhYmxlU3RyaW5nIGV4dGVuZHMgQmFzZUFyY2hpdmVIYW5kbGVyIHtcbiAgZGVjb2RlQXJjaGl2ZSAoYXJjaGl2ZSkge1xuICAgIHJldHVybiBhcmNoaXZlLmRlY29kZSgnTlMuc3RyaW5nJyk7XG4gIH1cbn1cblxuY2xhc3MgTlNNdXRhYmxlRGF0YSBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUgKGFyY2hpdmUpIHtcbiAgICByZXR1cm4gYXJjaGl2ZS5kZWNvZGUoJ05TLmRhdGEnKTtcbiAgfVxufVxuXG5jbGFzcyBOU1VVSUQgZXh0ZW5kcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGEgdXVpZCBmb3JtYXQgZGF0YSBlLmc6MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwXG4gICAqL1xuICBjb25zdHJ1Y3RvciAoZGF0YSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gIH1cblxuICBkZWNvZGVBcmNoaXZlIChhcmNoaXZlKSB7XG4gICAgcmV0dXJuIHV1aWRTdHJpbmdpZnkoYXJjaGl2ZS5kZWNvZGUoJ05TLnV1aWRieXRlcycpKTtcbiAgfVxuXG4gIGVuY29kZUFyY2hpdmUgKG9iaiwgYXJjaGl2ZSkge1xuICAgIGFyY2hpdmUuX2FyY2hpdmVPYmpbJ05TLnV1aWRieXRlcyddID0gQnVmZmVyLmZyb20odXVpZFBhcnNlKG9iai5fZGF0YSkuYnVmZmVyKTtcbiAgfVxufVxuXG5jbGFzcyBYQ1RDYXBhYmlsaXRpZXMgZXh0ZW5kcyBCYXNlQXJjaGl2ZUhhbmRsZXIge1xuICBkZWNvZGVBcmNoaXZlIChhcmNoaXZlKSB7XG4gICAgcmV0dXJuIGFyY2hpdmUuZGVjb2RlKCdjYXBhYmlsaXRpZXMtZGljdGlvbmFyeScpO1xuICB9XG59XG5cbmNsYXNzIE5TTnVsbCBleHRlbmRzIEJhc2VBcmNoaXZlSGFuZGxlciB7XG4gIGRlY29kZUFyY2hpdmUgKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogZGVjb2RlIGFuZCBlbmNvZGUgQXJjaGl2ZSBvZiBjdXJyZW50bHkga25vd24gZGF0YSBmb3JtYXRzXG4gKi9cbmNvbnN0IFVOQVJDSElWRV9DTEFTU19NQVAgPSB7XG4gIERUVGFwTWVzc2FnZVBsaXN0LFxuICBEVFN5c21vblRhcE1lc3NhZ2U6IERUVGFwTWVzc2FnZVBsaXN0LFxuICBEVFRhcEhlYXJ0YmVhdE1lc3NhZ2U6IERUVGFwTWVzc2FnZVBsaXN0LFxuICBEVFRhcE1lc3NhZ2VBcmNoaXZlOiBEVFRhcE1lc3NhZ2VQbGlzdCxcbiAgRFRLVHJhY2VUYXBNZXNzYWdlOiBEVFRhcE1lc3NhZ2VQbGlzdCxcbiAgRXJyb3JBcmNoaXZlOiBOU0Vycm9yLFxuICBFeGNlcHRpb25BcmNoaXZlOiBOU0V4Y2VwdGlvbixcbiAgTlNEaWN0aW9uYXJ5OiBEaWN0QXJjaGl2ZSxcbiAgTlNNdXRhYmxlRGljdGlvbmFyeTogRGljdEFyY2hpdmUsXG4gIE5TQXJyYXk6IExpc3RBcmNoaXZlLFxuICBOU011dGFibGVBcnJheTogTGlzdEFyY2hpdmUsXG4gIE5TTXV0YWJsZVNldDogTGlzdEFyY2hpdmUsXG4gIE5TU2V0OiBMaXN0QXJjaGl2ZSxcbiAgTlNEYXRlLFxuICBOU0Vycm9yLFxuICBOU0V4Y2VwdGlvbixcbiAgTlNNdXRhYmxlU3RyaW5nLFxuICBOU011dGFibGVEYXRhLFxuICBOU051bGwsXG4gIE5TVVVJRCxcbiAgTlNVUkwsXG4gIFhDVENhcGFiaWxpdGllc1xufTtcblxuLyoqXG4gKiBDYXBhYmxlIG9mIHVucGFja2luZyBhbiBhcmNoaXZlZCBvYmplY3QgdHJlZSBpbiB0aGUgTlNLZXllZEFyY2hpdmUgZm9ybWF0LlxuICogQXBwbGUncyBpbXBsZW1lbnRhdGlvbiBjYW4gYmUgZm91bmQgaGVyZTpcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBsZS9zd2lmdC1jb3JlbGlicy1mb3VuZGF0aW9uL2Jsb2IvbWFpbi9Tb3VyY2VzL0ZvdW5kYXRpb24vTlNLZXllZFVuYXJjaGl2ZXIuc3dpZnRcbiAqL1xuY2xhc3MgVW5hcmNoaXZlIHtcbiAgY29uc3RydWN0b3IgKGlucHV0Qnl0ZXMpIHtcbiAgICB0aGlzLmlucHV0ID0gaW5wdXRCeXRlcztcbiAgICB0aGlzLnVucGFja2VkVWlkcyA9IHt9O1xuICAgIHRoaXMudG9wVUlEID0gTlVMTF9VSUQ7XG4gICAgdGhpcy5vYmplY3RzID0gW107XG4gIH1cblxuICB1bnBhY2tBcmNoaXZlSGVhZGVyICgpIHtcbiAgICBjb25zdCBwbGlzdCA9IHBsaXN0bGliLnBhcnNlQnVmZmVyKHRoaXMuaW5wdXQpWzBdO1xuICAgIGlmIChwbGlzdC4kYXJjaGl2ZXIgIT09IE5TS0VZRURBUkNISVZFUikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bnN1cHBvcnRlZCBlbmNvZGVyOiAke3BsaXN0LiRhcmNoaXZlcn1gKTtcbiAgICB9XG4gICAgaWYgKHBsaXN0LiR2ZXJzaW9uICE9PSBOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBleHBlY3RlZCAke05TS0VZRURfQVJDSElWRV9WRVJTSU9OfSwgZ290ICR7cGxpc3QuJHZlcnNpb24gfWApO1xuICAgIH1cbiAgICBjb25zdCB0b3AgPSBwbGlzdC4kdG9wO1xuICAgIGNvbnN0IHRvcFVJRCA9IHRvcC5yb290O1xuICAgIGlmICghdG9wVUlEKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYHRvcCBvYmplY3QgZGlkIG5vdCBoYXZlIGEgVUlEISBkdW1wOiAke0pTT04uc3RyaW5naWZ5KHRvcCl9YCk7XG4gICAgfVxuICAgIHRoaXMudG9wVUlEID0gdG9wVUlEO1xuICAgIHRoaXMub2JqZWN0cyA9IHBsaXN0LiRvYmplY3RzO1xuICB9XG5cbiAgLyoqXG4gICAqIHVzZSB0aGUgVU5BUkNISVZFX0NMQVNTX01BUCB0byBmaW5kIHRoZSB1bmFyY2hpdmluZyBkZWxlZ2F0ZSBvZiBhIHVpZFxuICAgKi9cbiAgY2xhc3NGb3JVaWQgKGluZGV4KSB7XG4gICAgY29uc3QgbWV0YSA9IHRoaXMub2JqZWN0c1tpbmRleC5VSURdO1xuICAgIGNvbnN0IG5hbWUgPSBtZXRhLiRjbGFzc25hbWU7XG4gICAgY29uc3Qga2xhc3MgPSBVTkFSQ0hJVkVfQ0xBU1NfTUFQW25hbWVdO1xuICAgIGlmICgha2xhc3MpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgbm8gbWFwcGluZyBmb3IgJHtuYW1lfSBpbiBVTkFSQ0hJVkVfQ0xBU1NfTUFQYCk7XG4gICAgfVxuICAgIHJldHVybiBrbGFzcztcbiAgfVxuXG4gIGRlY29kZUtleSAob2JqLCBrZXkpIHtcbiAgICBjb25zdCB2YWwgPSBvYmpba2V5XTtcbiAgICByZXR1cm4gXy5pc05pbCh2YWw/LlVJRCkgPyB2YWwgOiB0aGlzLmRlY29kZU9iamVjdCh2YWwpO1xuICB9XG5cbiAgZGVjb2RlT2JqZWN0IChpbmRleCkge1xuICAgIGlmIChpbmRleCA9PT0gTlVMTF9VSUQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBvYmogPSB0aGlzLnVucGFja2VkVWlkc1tpbmRleF07XG4gICAgaWYgKG9iaiA9PT0gQ1lDTEVfVE9LRU4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgYXJjaGl2ZSBoYXMgYSBjeWNsZSB3aXRoICR7aW5kZXh9YCk7XG4gICAgfVxuICAgIGlmICghXy5pc1VuZGVmaW5lZChvYmopKSB7XG4gICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgICBjb25zdCByYXdPYmogPSB0aGlzLm9iamVjdHNbaW5kZXguVUlEXTtcbiAgICB0aGlzLnVucGFja2VkVWlkc1tpbmRleC5VSURdID0gQ1lDTEVfVE9LRU47XG5cbiAgICBpZiAoIXJhd09iaj8uJGNsYXNzKSB7XG4gICAgICB0aGlzLnVucGFja2VkVWlkc1tpbmRleC5VSURdID0gb2JqO1xuICAgICAgcmV0dXJuIHJhd09iajtcbiAgICB9XG4gICAgY29uc3Qga2xhc3MgPSB0aGlzLmNsYXNzRm9yVWlkKHJhd09iai4kY2xhc3MpO1xuICAgIGNvbnN0IGtsYXNzT2JqID0gbmV3IGtsYXNzKCkuZGVjb2RlQXJjaGl2ZShuZXcgQXJjaGl2ZWRPYmplY3QocmF3T2JqLCB0aGlzKSk7XG4gICAgdGhpcy51bnBhY2tlZFVpZHNbaW5kZXguVUlEXSA9IGtsYXNzT2JqO1xuICAgIHJldHVybiBrbGFzc09iajtcbiAgfVxuXG4gIHRvT2JqZWN0ICgpIHtcbiAgICB0aGlzLnVucGFja0FyY2hpdmVIZWFkZXIoKTtcbiAgICByZXR1cm4gdGhpcy5kZWNvZGVPYmplY3QodGhpcy50b3BVSUQpO1xuICB9XG59XG5cbi8qKlxuICogQ2FwYWJsZSBvZiBwYWNraW5nIGFuIG9iamVjdCB0cmVlIGludG8gdGhlIE5TS2V5ZWRBcmNoaXZlIGZvcm1hdC5cbiAqIEFwcGxlJ3MgaW1wbGVtZW50YXRpb24gY2FuIGJlIGZvdW5kIGhlcmU6XG4gKiBodHRwczovL2dpdGh1Yi5jb20vYXBwbGUvc3dpZnQtY29yZWxpYnMtZm91bmRhdGlvbi9ibG9iL21haW4vU291cmNlcy9Gb3VuZGF0aW9uL05TS2V5ZWRBcmNoaXZlci5zd2lmdFxuICovXG5jbGFzcyBBcmNoaXZlIHtcbiAgY29uc3RydWN0b3IgKGlucHV0T2JqZWN0KSB7XG4gICAgdGhpcy5pbnB1dCA9IGlucHV0T2JqZWN0O1xuICAgIHRoaXMuY2xhc3NNYXAgPSB7fTtcbiAgICB0aGlzLm9iamVjdHMgPSBbJyRudWxsJ107IC8vIG9iamVjdHMgdGhhdCBnbyBkaXJlY3RseSBpbnRvIHRoZSBhcmNoaXZlLCBhbHdheXMgc3RhcnQgd2l0aCAkbnVsbFxuICB9XG5cbiAgdWlkRm9yQXJjaGl2ZXIgKGFyY2hpdmVyKSB7XG4gICAgbGV0IHZhbCA9IHRoaXMuY2xhc3NNYXBbYXJjaGl2ZXJdO1xuICAgIGlmICh2YWwpIHtcbiAgICAgIHJldHVybiBuZXcgcGxpc3RsaWIuVUlEKHZhbCk7XG4gICAgfVxuICAgIHRoaXMuY2xhc3NNYXBbYXJjaGl2ZXJdID0gdGhpcy5vYmplY3RzLmxlbmd0aDtcbiAgICB2YWwgPSBuZXcgcGxpc3RsaWIuVUlEKHRoaXMub2JqZWN0cy5sZW5ndGgpO1xuICAgIHRoaXMub2JqZWN0cy5wdXNoKHtcbiAgICAgICckY2xhc3Nlcyc6IFthcmNoaXZlcl0sXG4gICAgICAnJGNsYXNzbmFtZSc6IGFyY2hpdmVyXG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbDtcbiAgfVxuXG4gIGFyY2hpdmUgKG9iaikge1xuICAgIGlmIChfLmlzVW5kZWZpbmVkKG9iaikgfHwgXy5pc051bGwob2JqKSkge1xuICAgICAgcmV0dXJuIE5VTExfVUlEO1xuICAgIH1cbiAgICBjb25zdCBpbmRleCA9IG5ldyBwbGlzdGxpYi5VSUQodGhpcy5vYmplY3RzLmxlbmd0aCk7XG4gICAgaWYgKFBSSU1JVElWRV9UWVBFUy5pbmNsdWRlcyhvYmouY29uc3RydWN0b3IubmFtZSkpIHtcbiAgICAgIHRoaXMub2JqZWN0cy5wdXNoKG9iaik7XG4gICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuICAgIGNvbnN0IGFyY2hpdmVPYmogPSB7fTtcbiAgICB0aGlzLm9iamVjdHMucHVzaChhcmNoaXZlT2JqKTtcbiAgICB0aGlzLmVuY29kZVRvcExldmVsKG9iaiwgYXJjaGl2ZU9iaik7XG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgZW5jb2RlICh2YWwpIHtcbiAgICBpZiAoTk9OX0VOQ09EQUJMRV9UWVBFUy5pbmNsdWRlcyh0eXBlb2YgdmFsKSkge1xuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYXJjaGl2ZSh2YWwpO1xuICB9XG5cbiAgZW5jb2RlVG9wTGV2ZWwgKG9iaiwgYXJjaGl2ZU9iaikge1xuICAgIGlmIChvYmogaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQXJyYXkob2JqLCBhcmNoaXZlT2JqKTtcbiAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlU2V0KG9iaiwgYXJjaGl2ZU9iaik7XG4gICAgfSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgIGNvbnN0IG9iak5hbWUgPSBvYmouY29uc3RydWN0b3IubmFtZTtcbiAgICAgIC8vIE9ubHkgc3BlY2lhbCBjbGFzcyBpbnN0YW5jZSBhcmUgdXNlZnVsLCBzdWNoIGFzIE5TVVJMLCBOU1VVSUQsIE5TRGF0ZS5cbiAgICAgIC8vIEFuZCB0aGlzIGNsYXNzIG11c3QgYWxzbyBoYXZlIHRoZSBlbmNvZGVBcmNoaXZlIG1ldGhvZFxuICAgICAgaWYgKG9iak5hbWUgaW4gVU5BUkNISVZFX0NMQVNTX01BUCkge1xuICAgICAgICBhcmNoaXZlT2JqLiRjbGFzcyA9IHRoaXMudWlkRm9yQXJjaGl2ZXIob2JqTmFtZSk7XG4gICAgICAgIG9iai5lbmNvZGVBcmNoaXZlKG9iaiwgbmV3IEFyY2hpdmluZ09iamVjdChhcmNoaXZlT2JqLCB0aGlzKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVEaWN0KG9iaiwgYXJjaGl2ZU9iaik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IEVycm9yKGBVbmFibGUgdG8gZW5jb2RlIHR5cGVzOiAke3R5cGVvZiBvYmp9YCk7XG4gICAgfVxuICB9XG5cbiAgZW5jb2RlQXJyYXkgKG9ianMsIGFyY2hpdmVPYmopIHtcbiAgICBhcmNoaXZlT2JqLiRjbGFzcyA9IHRoaXMudWlkRm9yQXJjaGl2ZXIoJ05TQXJyYXknKTtcbiAgICBhcmNoaXZlT2JqWydOUy5vYmplY3RzJ10gPSBvYmpzLm1hcCh0aGlzLmFyY2hpdmUuYmluZCh0aGlzKSk7XG4gIH1cblxuICBlbmNvZGVTZXQgKG9ianMsIGFyY2hpdmVPYmopIHtcbiAgICBhcmNoaXZlT2JqLiRjbGFzcyA9IHRoaXMudWlkRm9yQXJjaGl2ZXIoJ05TU2V0Jyk7XG4gICAgYXJjaGl2ZU9ialsnTlMub2JqZWN0cyddID0gb2Jqcy5tYXAodGhpcy5hcmNoaXZlLmJpbmQodGhpcykpO1xuICB9XG5cbiAgZW5jb2RlRGljdCAob2JqLCBhcmNoaXZlT2JqKSB7XG4gICAgYXJjaGl2ZU9iai4kY2xhc3MgPSB0aGlzLnVpZEZvckFyY2hpdmVyKCdOU0RpY3Rpb25hcnknKTtcbiAgICBhcmNoaXZlT2JqWydOUy5rZXlzJ10gPSBfLmtleXMob2JqKS5tYXAodGhpcy5hcmNoaXZlLmJpbmQodGhpcykpO1xuICAgIGFyY2hpdmVPYmpbJ05TLm9iamVjdHMnXSA9IF8udmFsdWVzKG9iaikubWFwKHRoaXMuYXJjaGl2ZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHRvQnl0ZXMgKCkge1xuICAgIGlmICh0aGlzLm9iamVjdHMubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aGlzLmFyY2hpdmUodGhpcy5pbnB1dCk7XG4gICAgfVxuICAgIGNvbnN0IGQgPSB7XG4gICAgICAnJHZlcnNpb24nOiBOU0tFWUVEX0FSQ0hJVkVfVkVSU0lPTixcbiAgICAgICckYXJjaGl2ZXInOiBOU0tFWUVEQVJDSElWRVIsXG4gICAgICAnJHRvcCc6IHsncm9vdCc6IG5ldyBwbGlzdGxpYi5VSUQoMSl9LFxuICAgICAgJyRvYmplY3RzJzogdGhpcy5vYmplY3RzXG4gICAgfTtcbiAgICByZXR1cm4gYnBsaXN0Q3JlYXRlKGQpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBOU0tleWVkIEJ1ZmZlciBmcm9tIGFuIG9iamVjdFxuICogQHBhcmFtIHtPYmplY3R9IGlucHV0T2JqZWN0XG4gKiBAcmV0dXJucyB7QnVmZmVyfSBOU0tleWVkIEJ1ZmZlclxuICovXG5mdW5jdGlvbiBhcmNoaXZlIChpbnB1dE9iamVjdCkge1xuICByZXR1cm4gbmV3IEFyY2hpdmUoaW5wdXRPYmplY3QpLnRvQnl0ZXMoKTtcbn1cblxuLyoqXG4gKiBQYXJzZXMgTlNLZXllZCBCdWZmZXIgaW50byBKUyBPYmplY3RcbiAqIEBwYXJhbSB7QnVmZmVyfSBpbnB1dEJ5dGVzIE5TS2V5ZWQgQnVmZmVyXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBKUyBPYmplY3RcbiAqL1xuZnVuY3Rpb24gdW5hcmNoaXZlIChpbnB1dEJ5dGVzKSB7XG4gIHJldHVybiBuZXcgVW5hcmNoaXZlKGlucHV0Qnl0ZXMpLnRvT2JqZWN0KCk7XG59XG5cbi8qKlxuICogVXBkYXRlIHVua25vd24gTlNLZXllZEFyY2hpdmUgdHlwZXMgZm9yIHBhY2tpbmcvdW5wYWNraW5nXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBwYWNraW5nL3VucGFja2luZyBrZXkgbmFtZVxuICogQHBhcmFtIHtCYXNlQXJjaGl2ZUhhbmRsZXJ9IHN1YkNsYXNzIGluaGVyaXQgZnJvbSBCYXNlQXJjaGl2ZUhhbmRsZXIgY2xhc3NcbiAqL1xuZnVuY3Rpb24gdXBkYXRlTlNLZXllZEFyY2hpdmVDbGFzcyAobmFtZSwgc3ViQ2xhc3MpIHtcbiAgaWYgKCFfLmlzRnVuY3Rpb24oc3ViQ2xhc3MucHJvdG90eXBlPy5kZWNvZGVBcmNoaXZlKSAmJiAhXy5pc0Z1bmN0aW9uKHN1YkNsYXNzLnByb3RvdHlwZT8uZW5jb2RlQXJjaGl2ZSkpIHtcbiAgICB0aHJvdyBFcnJvcignc3ViQ2xhc3MgbXVzdCBoYXZlIGRlY29kZUFyY2hpdmUgb3IgZW5jb2RlQXJjaGl2ZSBtZXRob2RzJyk7XG4gIH1cbiAgaWYgKCEobmFtZSBpbiBVTkFSQ0hJVkVfQ0xBU1NfTUFQKSkge1xuICAgIFVOQVJDSElWRV9DTEFTU19NQVBbbmFtZV0gPSBzdWJDbGFzcztcbiAgfVxufVxuXG5leHBvcnQgeyB1cGRhdGVOU0tleWVkQXJjaGl2ZUNsYXNzLCBCYXNlQXJjaGl2ZUhhbmRsZXIsIE5TVVJMLCBOU1VVSUQsIE5TRGF0ZSwgdW5hcmNoaXZlLCBhcmNoaXZlfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLHVCQUF1QixHQUFHLE9BQU87QUFDdkMsTUFBTUMsUUFBUSxHQUFHLElBQUlDLHFCQUFRLENBQUNDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDcEMsTUFBTUMsV0FBVyxHQUFHLFlBQVk7QUFDaEMsTUFBTUMsZUFBZSxHQUFHLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQztBQUN4RSxNQUFNQyxtQkFBbUIsR0FBRyxDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUM7QUFDakQsTUFBTUMsZUFBZSxHQUFHLGlCQUFpQjtBQUN6QyxNQUFNQywyQkFBMkIsR0FBRyxTQUFTO0FBRzdDLE1BQU1DLGNBQWMsQ0FBQztFQU9uQkMsV0FBVyxDQUFFQyxNQUFNLEVBQUVDLFVBQVUsRUFBRTtJQUMvQixJQUFJLENBQUNELE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNFLFdBQVcsR0FBR0QsVUFBVTtFQUMvQjtFQUVBRSxXQUFXLENBQUVDLEtBQUssRUFBRTtJQUNsQixPQUFPLElBQUksQ0FBQ0YsV0FBVyxDQUFDRyxZQUFZLENBQUNELEtBQUssQ0FBQztFQUM3QztFQUVBRSxNQUFNLENBQUVDLEdBQUcsRUFBRTtJQUNYLE9BQU8sSUFBSSxDQUFDTCxXQUFXLENBQUNNLFNBQVMsQ0FBQyxJQUFJLENBQUNSLE1BQU0sRUFBRU8sR0FBRyxDQUFDO0VBQ3JEO0FBQ0Y7QUFFQSxNQUFNRSxlQUFlLENBQUM7RUFPcEJWLFdBQVcsQ0FBRUMsTUFBTSxFQUFFVSxRQUFRLEVBQUU7SUFDN0IsSUFBSSxDQUFDQyxXQUFXLEdBQUdYLE1BQU07SUFDekIsSUFBSSxDQUFDWSxTQUFTLEdBQUdGLFFBQVE7RUFDM0I7RUFFQUcsTUFBTSxDQUFFTixHQUFHLEVBQUVPLEdBQUcsRUFBRTtJQUNoQixJQUFJLENBQUNILFdBQVcsQ0FBQ0osR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDSyxTQUFTLENBQUNDLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDO0VBQ3BEO0FBQ0Y7QUFNQSxNQUFNQyxrQkFBa0IsQ0FBQztFQUt2QkMsYUFBYSxDQUFFQyxPQUFPLEVBQUU7SUFDdEIsTUFBTSxJQUFJQyxLQUFLLENBQUUsdUNBQXNDLENBQUM7RUFDMUQ7RUFPQUMsYUFBYSxDQUFFQyxHQUFHLEVBQUVILE9BQU8sRUFBRTtJQUMzQixNQUFNLElBQUlDLEtBQUssQ0FBRSx1Q0FBc0MsQ0FBQztFQUMxRDtBQUNGO0FBQUM7QUFLRCxNQUFNRyxXQUFXLFNBQVNOLGtCQUFrQixDQUFDO0VBQzNDQyxhQUFhLENBQUVDLE9BQU8sRUFBRTtJQUN0QixNQUFNSyxPQUFPLEdBQUdMLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFNBQVMsQ0FBQztJQUN6QyxNQUFNaUIsT0FBTyxHQUFHTixPQUFPLENBQUNYLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDNUMsTUFBTWtCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDWixLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0gsT0FBTyxDQUFDSSxNQUFNLEVBQUdELENBQUMsRUFBRSxFQUFFO01BQ3hDLE1BQU1sQixHQUFHLEdBQUdVLE9BQU8sQ0FBQ2QsV0FBVyxDQUFDbUIsT0FBTyxDQUFDRyxDQUFDLENBQUMsQ0FBQztNQUMzQ0QsQ0FBQyxDQUFDakIsR0FBRyxDQUFDLEdBQUdVLE9BQU8sQ0FBQ2QsV0FBVyxDQUFDb0IsT0FBTyxDQUFDRSxDQUFDLENBQUMsQ0FBQztJQUMxQztJQUNBLE9BQU9ELENBQUM7RUFDVjtBQUNGO0FBS0EsTUFBTUcsV0FBVyxTQUFTWixrQkFBa0IsQ0FBQztFQUMzQ0MsYUFBYSxDQUFFQyxPQUFPLEVBQUU7SUFDdEIsTUFBTVcsSUFBSSxHQUFHWCxPQUFPLENBQUNYLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDekMsT0FBT3NCLElBQUksQ0FBQ0MsR0FBRyxDQUFDWixPQUFPLENBQUNkLFdBQVcsQ0FBQzJCLElBQUksQ0FBQ2IsT0FBTyxDQUFDLENBQUM7RUFDcEQ7QUFDRjtBQUVBLE1BQU1jLGlCQUFpQixTQUFTaEIsa0JBQWtCLENBQUM7RUFDakRDLGFBQWEsQ0FBRUMsT0FBTyxFQUFFO0lBQ3RCLE9BQU9BLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLG1CQUFtQixDQUFDO0VBQzVDO0FBQ0Y7QUFFQSxNQUFNMEIsT0FBTyxTQUFTakIsa0JBQWtCLENBQUM7RUFDdkNDLGFBQWEsQ0FBRUMsT0FBTyxFQUFFO0lBQ3RCLE9BQU87TUFDTCxRQUFRLEVBQUUsU0FBUztNQUNuQixRQUFRLEVBQUVBLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFVBQVUsQ0FBQztNQUNwQyxVQUFVLEVBQUVXLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFlBQVksQ0FBQztNQUN4QyxNQUFNLEVBQUVXLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFFBQVE7SUFDakMsQ0FBQztFQUNIO0FBQ0Y7QUFFQSxNQUFNMkIsV0FBVyxTQUFTbEIsa0JBQWtCLENBQUM7RUFDM0NDLGFBQWEsQ0FBRUMsT0FBTyxFQUFFO0lBQ3RCLE9BQU87TUFDTCxRQUFRLEVBQUUsYUFBYTtNQUN2QixRQUFRLEVBQUVBLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFdBQVcsQ0FBQztNQUNyQyxVQUFVLEVBQUVXLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFVBQVUsQ0FBQztNQUN0QyxNQUFNLEVBQUVXLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFNBQVM7SUFDbEMsQ0FBQztFQUNIO0FBQ0Y7QUFFQSxNQUFNNEIsS0FBSyxTQUFTbkIsa0JBQWtCLENBQUM7RUFLckNoQixXQUFXLENBQUVvQyxJQUFJLEVBQUVDLFFBQVEsRUFBRTtJQUMzQixLQUFLLEVBQUU7SUFDUCxJQUFJLENBQUNDLEtBQUssR0FBR0YsSUFBSTtJQUNqQixJQUFJLENBQUNHLFNBQVMsR0FBR0YsUUFBUTtFQUMzQjtFQUVBcEIsYUFBYSxDQUFFQyxPQUFPLEVBQUU7SUFDdEIsT0FBTztNQUFDc0IsTUFBTSxFQUFFLE9BQU87TUFBRUosSUFBSSxFQUFFbEIsT0FBTyxDQUFDWCxNQUFNLENBQUMsU0FBUyxDQUFDO01BQUU4QixRQUFRLEVBQUVuQixPQUFPLENBQUNYLE1BQU0sQ0FBQyxhQUFhO0lBQUMsQ0FBQztFQUNwRztFQUVBYSxhQUFhLENBQUVDLEdBQUcsRUFBRUgsT0FBTyxFQUFFO0lBQzNCQSxPQUFPLENBQUNKLE1BQU0sQ0FBQyxTQUFTLEVBQUVPLEdBQUcsQ0FBQ2lCLEtBQUssQ0FBQztJQUNwQ3BCLE9BQU8sQ0FBQ0osTUFBTSxDQUFDLGFBQWEsRUFBRU8sR0FBRyxDQUFDa0IsU0FBUyxDQUFDO0VBQzlDO0FBQ0Y7QUFBQztBQUVELE1BQU1FLE1BQU0sU0FBU3pCLGtCQUFrQixDQUFDO0VBSXRDaEIsV0FBVyxDQUFFMEMsSUFBSSxFQUFFO0lBQ2pCLEtBQUssRUFBRTtJQUNQLElBQUksQ0FBQ0MsS0FBSyxHQUFHRCxJQUFJO0VBQ25CO0VBRUF6QixhQUFhLENBQUVDLE9BQU8sRUFBRTtJQUN0QixPQUFPcEIsMkJBQTJCLEdBQUdvQixPQUFPLENBQUNYLE1BQU0sQ0FBQyxTQUFTLENBQUM7RUFDaEU7RUFFQWEsYUFBYSxDQUFFQyxHQUFHLEVBQUVILE9BQU8sRUFBRTtJQUMzQkEsT0FBTyxDQUFDSixNQUFNLENBQUMsU0FBUyxFQUFFTyxHQUFHLENBQUNzQixLQUFLLEdBQUc3QywyQkFBMkIsQ0FBQztFQUNwRTtBQUNGO0FBQUM7QUFFRCxNQUFNOEMsZUFBZSxTQUFTNUIsa0JBQWtCLENBQUM7RUFDL0NDLGFBQWEsQ0FBRUMsT0FBTyxFQUFFO0lBQ3RCLE9BQU9BLE9BQU8sQ0FBQ1gsTUFBTSxDQUFDLFdBQVcsQ0FBQztFQUNwQztBQUNGO0FBRUEsTUFBTXNDLGFBQWEsU0FBUzdCLGtCQUFrQixDQUFDO0VBQzdDQyxhQUFhLENBQUVDLE9BQU8sRUFBRTtJQUN0QixPQUFPQSxPQUFPLENBQUNYLE1BQU0sQ0FBQyxTQUFTLENBQUM7RUFDbEM7QUFDRjtBQUVBLE1BQU11QyxNQUFNLFNBQVM5QixrQkFBa0IsQ0FBQztFQUl0Q2hCLFdBQVcsQ0FBRTBDLElBQUksRUFBRTtJQUNqQixLQUFLLEVBQUU7SUFDUCxJQUFJLENBQUNDLEtBQUssR0FBR0QsSUFBSTtFQUNuQjtFQUVBekIsYUFBYSxDQUFFQyxPQUFPLEVBQUU7SUFDdEIsT0FBTyxJQUFBNkIsZUFBYSxFQUFDN0IsT0FBTyxDQUFDWCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7RUFDdEQ7RUFFQWEsYUFBYSxDQUFFQyxHQUFHLEVBQUVILE9BQU8sRUFBRTtJQUMzQkEsT0FBTyxDQUFDTixXQUFXLENBQUMsY0FBYyxDQUFDLEdBQUdvQyxNQUFNLENBQUNDLElBQUksQ0FBQyxJQUFBQyxXQUFTLEVBQUM3QixHQUFHLENBQUNzQixLQUFLLENBQUMsQ0FBQ1EsTUFBTSxDQUFDO0VBQ2hGO0FBQ0Y7QUFBQztBQUVELE1BQU1DLGVBQWUsU0FBU3BDLGtCQUFrQixDQUFDO0VBQy9DQyxhQUFhLENBQUVDLE9BQU8sRUFBRTtJQUN0QixPQUFPQSxPQUFPLENBQUNYLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQztFQUNsRDtBQUNGO0FBRUEsTUFBTThDLE1BQU0sU0FBU3JDLGtCQUFrQixDQUFDO0VBQ3RDQyxhQUFhLEdBQUk7SUFDZixPQUFPLElBQUk7RUFDYjtBQUNGO0FBS0EsTUFBTXFDLG1CQUFtQixHQUFHO0VBQzFCdEIsaUJBQWlCO0VBQ2pCdUIsa0JBQWtCLEVBQUV2QixpQkFBaUI7RUFDckN3QixxQkFBcUIsRUFBRXhCLGlCQUFpQjtFQUN4Q3lCLG1CQUFtQixFQUFFekIsaUJBQWlCO0VBQ3RDMEIsa0JBQWtCLEVBQUUxQixpQkFBaUI7RUFDckMyQixZQUFZLEVBQUUxQixPQUFPO0VBQ3JCMkIsZ0JBQWdCLEVBQUUxQixXQUFXO0VBQzdCMkIsWUFBWSxFQUFFdkMsV0FBVztFQUN6QndDLG1CQUFtQixFQUFFeEMsV0FBVztFQUNoQ3lDLE9BQU8sRUFBRW5DLFdBQVc7RUFDcEJvQyxjQUFjLEVBQUVwQyxXQUFXO0VBQzNCcUMsWUFBWSxFQUFFckMsV0FBVztFQUN6QnNDLEtBQUssRUFBRXRDLFdBQVc7RUFDbEJhLE1BQU07RUFDTlIsT0FBTztFQUNQQyxXQUFXO0VBQ1hVLGVBQWU7RUFDZkMsYUFBYTtFQUNiUSxNQUFNO0VBQ05QLE1BQU07RUFDTlgsS0FBSztFQUNMaUI7QUFDRixDQUFDO0FBT0QsTUFBTWUsU0FBUyxDQUFDO0VBQ2RuRSxXQUFXLENBQUVvRSxVQUFVLEVBQUU7SUFDdkIsSUFBSSxDQUFDQyxLQUFLLEdBQUdELFVBQVU7SUFDdkIsSUFBSSxDQUFDRSxZQUFZLEdBQUcsQ0FBQyxDQUFDO0lBQ3RCLElBQUksQ0FBQ0MsTUFBTSxHQUFHaEYsUUFBUTtJQUN0QixJQUFJLENBQUNpRixPQUFPLEdBQUcsRUFBRTtFQUNuQjtFQUVBQyxtQkFBbUIsR0FBSTtJQUNyQixNQUFNQyxLQUFLLEdBQUdsRixxQkFBUSxDQUFDbUYsV0FBVyxDQUFDLElBQUksQ0FBQ04sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pELElBQUlLLEtBQUssQ0FBQ0UsU0FBUyxLQUFLL0UsZUFBZSxFQUFFO01BQ3ZDLE1BQU0sSUFBSXNCLEtBQUssQ0FBRSx3QkFBdUJ1RCxLQUFLLENBQUNFLFNBQVUsRUFBQyxDQUFDO0lBQzVEO0lBQ0EsSUFBSUYsS0FBSyxDQUFDRyxRQUFRLEtBQUt2Rix1QkFBdUIsRUFBRTtNQUM5QyxNQUFNLElBQUk2QixLQUFLLENBQUUsWUFBVzdCLHVCQUF3QixTQUFRb0YsS0FBSyxDQUFDRyxRQUFVLEVBQUMsQ0FBQztJQUNoRjtJQUNBLE1BQU1DLEdBQUcsR0FBR0osS0FBSyxDQUFDSyxJQUFJO0lBQ3RCLE1BQU1SLE1BQU0sR0FBR08sR0FBRyxDQUFDRSxJQUFJO0lBQ3ZCLElBQUksQ0FBQ1QsTUFBTSxFQUFFO01BQ1gsTUFBTSxJQUFJcEQsS0FBSyxDQUFFLHdDQUF1QzhELElBQUksQ0FBQ0MsU0FBUyxDQUFDSixHQUFHLENBQUUsRUFBQyxDQUFDO0lBQ2hGO0lBQ0EsSUFBSSxDQUFDUCxNQUFNLEdBQUdBLE1BQU07SUFDcEIsSUFBSSxDQUFDQyxPQUFPLEdBQUdFLEtBQUssQ0FBQ1MsUUFBUTtFQUMvQjtFQUtBQyxXQUFXLENBQUUvRSxLQUFLLEVBQUU7SUFDbEIsTUFBTWdGLElBQUksR0FBRyxJQUFJLENBQUNiLE9BQU8sQ0FBQ25FLEtBQUssQ0FBQ1osR0FBRyxDQUFDO0lBQ3BDLE1BQU02RixJQUFJLEdBQUdELElBQUksQ0FBQ0UsVUFBVTtJQUM1QixNQUFNQyxLQUFLLEdBQUdsQyxtQkFBbUIsQ0FBQ2dDLElBQUksQ0FBQztJQUN2QyxJQUFJLENBQUNFLEtBQUssRUFBRTtNQUNWLE1BQU0sSUFBSXJFLEtBQUssQ0FBRSxrQkFBaUJtRSxJQUFLLHlCQUF3QixDQUFDO0lBQ2xFO0lBQ0EsT0FBT0UsS0FBSztFQUNkO0VBRUEvRSxTQUFTLENBQUVZLEdBQUcsRUFBRWIsR0FBRyxFQUFFO0lBQ25CLE1BQU1PLEdBQUcsR0FBR00sR0FBRyxDQUFDYixHQUFHLENBQUM7SUFDcEIsT0FBT2lGLGVBQUMsQ0FBQ0MsS0FBSyxDQUFDM0UsR0FBRyxhQUFIQSxHQUFHLHVCQUFIQSxHQUFHLENBQUV0QixHQUFHLENBQUMsR0FBR3NCLEdBQUcsR0FBRyxJQUFJLENBQUNULFlBQVksQ0FBQ1MsR0FBRyxDQUFDO0VBQ3pEO0VBRUFULFlBQVksQ0FBRUQsS0FBSyxFQUFFO0lBQ25CLElBQUlBLEtBQUssS0FBS2QsUUFBUSxFQUFFO01BQ3RCLE9BQU8sSUFBSTtJQUNiO0lBQ0EsTUFBTThCLEdBQUcsR0FBRyxJQUFJLENBQUNpRCxZQUFZLENBQUNqRSxLQUFLLENBQUM7SUFDcEMsSUFBSWdCLEdBQUcsS0FBSzNCLFdBQVcsRUFBRTtNQUN2QixNQUFNLElBQUl5QixLQUFLLENBQUUsNEJBQTJCZCxLQUFNLEVBQUMsQ0FBQztJQUN0RDtJQUNBLElBQUksQ0FBQ29GLGVBQUMsQ0FBQ0UsV0FBVyxDQUFDdEUsR0FBRyxDQUFDLEVBQUU7TUFDdkIsT0FBT0EsR0FBRztJQUNaO0lBQ0EsTUFBTXVFLE1BQU0sR0FBRyxJQUFJLENBQUNwQixPQUFPLENBQUNuRSxLQUFLLENBQUNaLEdBQUcsQ0FBQztJQUN0QyxJQUFJLENBQUM2RSxZQUFZLENBQUNqRSxLQUFLLENBQUNaLEdBQUcsQ0FBQyxHQUFHQyxXQUFXO0lBRTFDLElBQUksRUFBQ2tHLE1BQU0sYUFBTkEsTUFBTSxlQUFOQSxNQUFNLENBQUVwRCxNQUFNLEdBQUU7TUFDbkIsSUFBSSxDQUFDOEIsWUFBWSxDQUFDakUsS0FBSyxDQUFDWixHQUFHLENBQUMsR0FBRzRCLEdBQUc7TUFDbEMsT0FBT3VFLE1BQU07SUFDZjtJQUNBLE1BQU1KLEtBQUssR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQ1EsTUFBTSxDQUFDcEQsTUFBTSxDQUFDO0lBQzdDLE1BQU1xRCxRQUFRLEdBQUcsSUFBSUwsS0FBSyxFQUFFLENBQUN2RSxhQUFhLENBQUMsSUFBSWxCLGNBQWMsQ0FBQzZGLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUM1RSxJQUFJLENBQUN0QixZQUFZLENBQUNqRSxLQUFLLENBQUNaLEdBQUcsQ0FBQyxHQUFHb0csUUFBUTtJQUN2QyxPQUFPQSxRQUFRO0VBQ2pCO0VBRUFDLFFBQVEsR0FBSTtJQUNWLElBQUksQ0FBQ3JCLG1CQUFtQixFQUFFO0lBQzFCLE9BQU8sSUFBSSxDQUFDbkUsWUFBWSxDQUFDLElBQUksQ0FBQ2lFLE1BQU0sQ0FBQztFQUN2QztBQUNGO0FBT0EsTUFBTXdCLE9BQU8sQ0FBQztFQUNaL0YsV0FBVyxDQUFFZ0csV0FBVyxFQUFFO0lBQ3hCLElBQUksQ0FBQzNCLEtBQUssR0FBRzJCLFdBQVc7SUFDeEIsSUFBSSxDQUFDQyxRQUFRLEdBQUcsQ0FBQyxDQUFDO0lBQ2xCLElBQUksQ0FBQ3pCLE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQztFQUMxQjtFQUVBMEIsY0FBYyxDQUFFdkYsUUFBUSxFQUFFO0lBQ3hCLElBQUlJLEdBQUcsR0FBRyxJQUFJLENBQUNrRixRQUFRLENBQUN0RixRQUFRLENBQUM7SUFDakMsSUFBSUksR0FBRyxFQUFFO01BQ1AsT0FBTyxJQUFJdkIscUJBQVEsQ0FBQ0MsR0FBRyxDQUFDc0IsR0FBRyxDQUFDO0lBQzlCO0lBQ0EsSUFBSSxDQUFDa0YsUUFBUSxDQUFDdEYsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDNkQsT0FBTyxDQUFDN0MsTUFBTTtJQUM3Q1osR0FBRyxHQUFHLElBQUl2QixxQkFBUSxDQUFDQyxHQUFHLENBQUMsSUFBSSxDQUFDK0UsT0FBTyxDQUFDN0MsTUFBTSxDQUFDO0lBQzNDLElBQUksQ0FBQzZDLE9BQU8sQ0FBQzJCLElBQUksQ0FBQztNQUNoQixVQUFVLEVBQUUsQ0FBQ3hGLFFBQVEsQ0FBQztNQUN0QixZQUFZLEVBQUVBO0lBQ2hCLENBQUMsQ0FBQztJQUNGLE9BQU9JLEdBQUc7RUFDWjtFQUVBRyxPQUFPLENBQUVHLEdBQUcsRUFBRTtJQUNaLElBQUlvRSxlQUFDLENBQUNFLFdBQVcsQ0FBQ3RFLEdBQUcsQ0FBQyxJQUFJb0UsZUFBQyxDQUFDVyxNQUFNLENBQUMvRSxHQUFHLENBQUMsRUFBRTtNQUN2QyxPQUFPOUIsUUFBUTtJQUNqQjtJQUNBLE1BQU1jLEtBQUssR0FBRyxJQUFJYixxQkFBUSxDQUFDQyxHQUFHLENBQUMsSUFBSSxDQUFDK0UsT0FBTyxDQUFDN0MsTUFBTSxDQUFDO0lBQ25ELElBQUloQyxlQUFlLENBQUMwRyxRQUFRLENBQUNoRixHQUFHLENBQUNyQixXQUFXLENBQUNzRixJQUFJLENBQUMsRUFBRTtNQUNsRCxJQUFJLENBQUNkLE9BQU8sQ0FBQzJCLElBQUksQ0FBQzlFLEdBQUcsQ0FBQztNQUN0QixPQUFPaEIsS0FBSztJQUNkO0lBQ0EsTUFBTWlHLFVBQVUsR0FBRyxDQUFDLENBQUM7SUFDckIsSUFBSSxDQUFDOUIsT0FBTyxDQUFDMkIsSUFBSSxDQUFDRyxVQUFVLENBQUM7SUFDN0IsSUFBSSxDQUFDQyxjQUFjLENBQUNsRixHQUFHLEVBQUVpRixVQUFVLENBQUM7SUFDcEMsT0FBT2pHLEtBQUs7RUFDZDtFQUVBUyxNQUFNLENBQUVDLEdBQUcsRUFBRTtJQUNYLElBQUluQixtQkFBbUIsQ0FBQ3lHLFFBQVEsQ0FBQyxPQUFPdEYsR0FBRyxDQUFDLEVBQUU7TUFDNUMsT0FBT0EsR0FBRztJQUNaO0lBQ0EsT0FBTyxJQUFJLENBQUNHLE9BQU8sQ0FBQ0gsR0FBRyxDQUFDO0VBQzFCO0VBRUF3RixjQUFjLENBQUVsRixHQUFHLEVBQUVpRixVQUFVLEVBQUU7SUFDL0IsSUFBSWpGLEdBQUcsWUFBWW1GLEtBQUssRUFBRTtNQUN4QixPQUFPLElBQUksQ0FBQ0MsV0FBVyxDQUFDcEYsR0FBRyxFQUFFaUYsVUFBVSxDQUFDO0lBQzFDLENBQUMsTUFBTSxJQUFJakYsR0FBRyxZQUFZcUYsR0FBRyxFQUFFO01BQzdCLE9BQU8sSUFBSSxDQUFDQyxTQUFTLENBQUN0RixHQUFHLEVBQUVpRixVQUFVLENBQUM7SUFDeEMsQ0FBQyxNQUFNLElBQUlqRixHQUFHLFlBQVl1RixNQUFNLEVBQUU7TUFDaEMsTUFBTUMsT0FBTyxHQUFHeEYsR0FBRyxDQUFDckIsV0FBVyxDQUFDc0YsSUFBSTtNQUdwQyxJQUFJdUIsT0FBTyxJQUFJdkQsbUJBQW1CLEVBQUU7UUFDbENnRCxVQUFVLENBQUM5RCxNQUFNLEdBQUcsSUFBSSxDQUFDMEQsY0FBYyxDQUFDVyxPQUFPLENBQUM7UUFDaER4RixHQUFHLENBQUNELGFBQWEsQ0FBQ0MsR0FBRyxFQUFFLElBQUlYLGVBQWUsQ0FBQzRGLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztNQUMvRCxDQUFDLE1BQU07UUFDTCxPQUFPLElBQUksQ0FBQ1EsVUFBVSxDQUFDekYsR0FBRyxFQUFFaUYsVUFBVSxDQUFDO01BQ3pDO0lBQ0YsQ0FBQyxNQUFNO01BQ0wsTUFBTW5GLEtBQUssQ0FBRSwyQkFBMEIsT0FBT0UsR0FBSSxFQUFDLENBQUM7SUFDdEQ7RUFDRjtFQUVBb0YsV0FBVyxDQUFFTSxJQUFJLEVBQUVULFVBQVUsRUFBRTtJQUM3QkEsVUFBVSxDQUFDOUQsTUFBTSxHQUFHLElBQUksQ0FBQzBELGNBQWMsQ0FBQyxTQUFTLENBQUM7SUFDbERJLFVBQVUsQ0FBQyxZQUFZLENBQUMsR0FBR1MsSUFBSSxDQUFDakYsR0FBRyxDQUFDLElBQUksQ0FBQ1osT0FBTyxDQUFDYSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7RUFDOUQ7RUFFQTRFLFNBQVMsQ0FBRUksSUFBSSxFQUFFVCxVQUFVLEVBQUU7SUFDM0JBLFVBQVUsQ0FBQzlELE1BQU0sR0FBRyxJQUFJLENBQUMwRCxjQUFjLENBQUMsT0FBTyxDQUFDO0lBQ2hESSxVQUFVLENBQUMsWUFBWSxDQUFDLEdBQUdTLElBQUksQ0FBQ2pGLEdBQUcsQ0FBQyxJQUFJLENBQUNaLE9BQU8sQ0FBQ2EsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQzlEO0VBRUErRSxVQUFVLENBQUV6RixHQUFHLEVBQUVpRixVQUFVLEVBQUU7SUFDM0JBLFVBQVUsQ0FBQzlELE1BQU0sR0FBRyxJQUFJLENBQUMwRCxjQUFjLENBQUMsY0FBYyxDQUFDO0lBQ3ZESSxVQUFVLENBQUMsU0FBUyxDQUFDLEdBQUdiLGVBQUMsQ0FBQ3VCLElBQUksQ0FBQzNGLEdBQUcsQ0FBQyxDQUFDUyxHQUFHLENBQUMsSUFBSSxDQUFDWixPQUFPLENBQUNhLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNoRXVFLFVBQVUsQ0FBQyxZQUFZLENBQUMsR0FBR2IsZUFBQyxDQUFDd0IsTUFBTSxDQUFDNUYsR0FBRyxDQUFDLENBQUNTLEdBQUcsQ0FBQyxJQUFJLENBQUNaLE9BQU8sQ0FBQ2EsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQ3ZFO0VBRUFtRixPQUFPLEdBQUk7SUFDVCxJQUFJLElBQUksQ0FBQzFDLE9BQU8sQ0FBQzdDLE1BQU0sS0FBSyxDQUFDLEVBQUU7TUFDN0IsSUFBSSxDQUFDVCxPQUFPLENBQUMsSUFBSSxDQUFDbUQsS0FBSyxDQUFDO0lBQzFCO0lBQ0EsTUFBTTVDLENBQUMsR0FBRztNQUNSLFVBQVUsRUFBRW5DLHVCQUF1QjtNQUNuQyxXQUFXLEVBQUVPLGVBQWU7TUFDNUIsTUFBTSxFQUFFO1FBQUMsTUFBTSxFQUFFLElBQUlMLHFCQUFRLENBQUNDLEdBQUcsQ0FBQyxDQUFDO01BQUMsQ0FBQztNQUNyQyxVQUFVLEVBQUUsSUFBSSxDQUFDK0U7SUFDbkIsQ0FBQztJQUNELE9BQU8sSUFBQTJDLHNCQUFZLEVBQUMxRixDQUFDLENBQUM7RUFDeEI7QUFDRjtBQU9BLFNBQVNQLE9BQU8sQ0FBRThFLFdBQVcsRUFBRTtFQUM3QixPQUFPLElBQUlELE9BQU8sQ0FBQ0MsV0FBVyxDQUFDLENBQUNrQixPQUFPLEVBQUU7QUFDM0M7QUFPQSxTQUFTRSxTQUFTLENBQUVoRCxVQUFVLEVBQUU7RUFDOUIsT0FBTyxJQUFJRCxTQUFTLENBQUNDLFVBQVUsQ0FBQyxDQUFDMEIsUUFBUSxFQUFFO0FBQzdDO0FBT0EsU0FBU3VCLHlCQUF5QixDQUFFL0IsSUFBSSxFQUFFZ0MsUUFBUSxFQUFFO0VBQUE7RUFDbEQsSUFBSSxDQUFDN0IsZUFBQyxDQUFDOEIsVUFBVSx3QkFBQ0QsUUFBUSxDQUFDRSxTQUFTLHdEQUFsQixvQkFBb0J2RyxhQUFhLENBQUMsSUFBSSxDQUFDd0UsZUFBQyxDQUFDOEIsVUFBVSx5QkFBQ0QsUUFBUSxDQUFDRSxTQUFTLHlEQUFsQixxQkFBb0JwRyxhQUFhLENBQUMsRUFBRTtJQUN4RyxNQUFNRCxLQUFLLENBQUMsMkRBQTJELENBQUM7RUFDMUU7RUFDQSxJQUFJLEVBQUVtRSxJQUFJLElBQUloQyxtQkFBbUIsQ0FBQyxFQUFFO0lBQ2xDQSxtQkFBbUIsQ0FBQ2dDLElBQUksQ0FBQyxHQUFHZ0MsUUFBUTtFQUN0QztBQUNGIn0=