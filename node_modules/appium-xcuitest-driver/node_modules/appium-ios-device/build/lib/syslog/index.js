"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SyslogService = exports.SYSLOG_SERVICE_NAME = void 0;
require("source-map-support/register");
var _syslogDecoder = _interopRequireDefault(require("./transformer/syslog-decoder"));
var _constants = require("../constants");
var _baseService = require("../base-service");
const SYSLOG_SERVICE_NAME = 'com.apple.syslog_relay';
exports.SYSLOG_SERVICE_NAME = SYSLOG_SERVICE_NAME;
const START_MESSAGE = 'start';
class SyslogService extends _baseService.BaseServiceSocket {
  constructor(socketClient) {
    super(socketClient);
    this._decoder = new _syslogDecoder.default(5 * _constants.KB);
    this._socketClient.pipe(this._decoder);
    this._assignClientFailureHandlers(this._decoder);
  }
  start(onData) {
    this._decoder.on('data', onData);
    this._socketClient.write(START_MESSAGE);
  }
}
exports.SyslogService = SyslogService;
var _default = SyslogService;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTWVNMT0dfU0VSVklDRV9OQU1FIiwiU1RBUlRfTUVTU0FHRSIsIlN5c2xvZ1NlcnZpY2UiLCJCYXNlU2VydmljZVNvY2tldCIsImNvbnN0cnVjdG9yIiwic29ja2V0Q2xpZW50IiwiX2RlY29kZXIiLCJTeXNsb2dEZWNvZGVyIiwiS0IiLCJfc29ja2V0Q2xpZW50IiwicGlwZSIsIl9hc3NpZ25DbGllbnRGYWlsdXJlSGFuZGxlcnMiLCJzdGFydCIsIm9uRGF0YSIsIm9uIiwid3JpdGUiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvc3lzbG9nL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTeXNsb2dEZWNvZGVyIGZyb20gJy4vdHJhbnNmb3JtZXIvc3lzbG9nLWRlY29kZXInO1xuaW1wb3J0IHsgS0IgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgQmFzZVNlcnZpY2VTb2NrZXQgfSBmcm9tICcuLi9iYXNlLXNlcnZpY2UnO1xuXG5cbi8vV2UganVzdCBuZWVkIHRvIHdyaXRlIGFueSBkYXRhIHRvIHRoZSBjbGllbnQuIEl0IGRvZXNuJ3QgbWF0dGVyIHdoYXQgd2Ugc2VuZFxuY29uc3QgU1lTTE9HX1NFUlZJQ0VfTkFNRSA9ICdjb20uYXBwbGUuc3lzbG9nX3JlbGF5JztcbmNvbnN0IFNUQVJUX01FU1NBR0UgPSAnc3RhcnQnO1xuXG5jbGFzcyBTeXNsb2dTZXJ2aWNlIGV4dGVuZHMgQmFzZVNlcnZpY2VTb2NrZXQge1xuICBjb25zdHJ1Y3RvciAoc29ja2V0Q2xpZW50KSB7XG4gICAgc3VwZXIoc29ja2V0Q2xpZW50KTtcblxuICAgIHRoaXMuX2RlY29kZXIgPSBuZXcgU3lzbG9nRGVjb2Rlcig1ICogS0IpO1xuICAgIHRoaXMuX3NvY2tldENsaWVudC5waXBlKHRoaXMuX2RlY29kZXIpO1xuICAgIHRoaXMuX2Fzc2lnbkNsaWVudEZhaWx1cmVIYW5kbGVycyh0aGlzLl9kZWNvZGVyKTtcbiAgfVxuICAvKiogVGhlIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIHdpbGwgYmUgY2FsbGVkIGR1cmluZyBsb2cgbGlzdGVuaW5nXG4gICAqIEBuYW1lIExvZ0NhbGxiYWNrXG4gICAqIEBmdW5jdGlvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gbG9nIFRoZSBsb2cgdGhhdCBpcyBzZW50IGZyb20gdGhlIHBob25lXG4gICovXG5cbiAgLyoqXG4gICAqIFN0YXJ0IHJlY2lldmluZyBsb2dzIGZyb20gdGhlIHBob25lLiBUaGUgY2FsbGJhY2sgd2hlbiBhIGxvZyBpcyByZWNpZXZlZFxuICAgKiBAcGFyYW0ge0xvZ0NhbGxiYWNrfSBvbkRhdGFcbiAgICovXG4gIHN0YXJ0IChvbkRhdGEpIHtcbiAgICB0aGlzLl9kZWNvZGVyLm9uKCdkYXRhJywgb25EYXRhKTtcbiAgICB0aGlzLl9zb2NrZXRDbGllbnQud3JpdGUoU1RBUlRfTUVTU0FHRSk7XG4gIH1cbn1cblxuZXhwb3J0IHsgU3lzbG9nU2VydmljZSwgU1lTTE9HX1NFUlZJQ0VfTkFNRSB9O1xuZXhwb3J0IGRlZmF1bHQgU3lzbG9nU2VydmljZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFJQSxNQUFNQSxtQkFBbUIsR0FBRyx3QkFBd0I7QUFBQztBQUNyRCxNQUFNQyxhQUFhLEdBQUcsT0FBTztBQUU3QixNQUFNQyxhQUFhLFNBQVNDLDhCQUFpQixDQUFDO0VBQzVDQyxXQUFXLENBQUVDLFlBQVksRUFBRTtJQUN6QixLQUFLLENBQUNBLFlBQVksQ0FBQztJQUVuQixJQUFJLENBQUNDLFFBQVEsR0FBRyxJQUFJQyxzQkFBYSxDQUFDLENBQUMsR0FBR0MsYUFBRSxDQUFDO0lBQ3pDLElBQUksQ0FBQ0MsYUFBYSxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDSixRQUFRLENBQUM7SUFDdEMsSUFBSSxDQUFDSyw0QkFBNEIsQ0FBQyxJQUFJLENBQUNMLFFBQVEsQ0FBQztFQUNsRDtFQVdBTSxLQUFLLENBQUVDLE1BQU0sRUFBRTtJQUNiLElBQUksQ0FBQ1AsUUFBUSxDQUFDUSxFQUFFLENBQUMsTUFBTSxFQUFFRCxNQUFNLENBQUM7SUFDaEMsSUFBSSxDQUFDSixhQUFhLENBQUNNLEtBQUssQ0FBQ2QsYUFBYSxDQUFDO0VBQ3pDO0FBQ0Y7QUFBQztBQUFBLGVBR2NDLGFBQWE7QUFBQSJ9