"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _simulatorXcode = _interopRequireDefault(require("./simulator-xcode-8"));
var _lodash = _interopRequireDefault(require("lodash"));
var _path = _interopRequireDefault(require("path"));
var _support = require("@appium/support");
var _asyncLock = _interopRequireDefault(require("async-lock"));
var _logger = _interopRequireDefault(require("./logger"));
var _asyncbox = require("asyncbox");
var _utils = require("./utils.js");
var _defaultsUtils = require("./defaults-utils");
var _bluebird = _interopRequireDefault(require("bluebird"));
var _events = require("events");
var _appiumXcode = require("appium-xcode");
var _teen_process = require("teen_process");
var _settings = require("./settings");
const SIMULATOR_SHUTDOWN_TIMEOUT = 15 * 1000;
const startupLock = new _asyncLock.default();
const preferencesPlistGuard = new _asyncLock.default();
const ENROLLMENT_NOTIFICATION_RECEIVER = 'com.apple.BiometricKit.enrollmentChanged';
const DOMAIN_KEYBOARD_PREFERENCES = 'com.apple.keyboard.preferences';
function compileSimulatorPreferences(opts = {}) {
  const {
    connectHardwareKeyboard,
    tracePointer,
    pasteboardAutomaticSync,
    scaleFactor
  } = opts;
  const commonPreferences = {
    RotateWindowWhenSignaledByGuest: true,
    StartLastDeviceOnLaunch: false,
    DetachOnWindowClose: false,
    AttachBootedOnStart: true
  };
  const devicePreferences = opts.devicePreferences ? _lodash.default.cloneDeep(opts.devicePreferences) : {};
  if (scaleFactor) {
    devicePreferences.SimulatorWindowLastScale = parseFloat(scaleFactor);
  }
  if (_lodash.default.isBoolean(connectHardwareKeyboard) || _lodash.default.isNil(connectHardwareKeyboard)) {
    devicePreferences.ConnectHardwareKeyboard = connectHardwareKeyboard ?? false;
    commonPreferences.ConnectHardwareKeyboard = connectHardwareKeyboard ?? false;
  }
  if (_lodash.default.isBoolean(tracePointer)) {
    commonPreferences.ShowSingleTouches = tracePointer;
    commonPreferences.ShowPinches = tracePointer;
    commonPreferences.ShowPinchPivotPoint = tracePointer;
    commonPreferences.HighlightEdgeGestures = tracePointer;
  }
  switch (_lodash.default.lowerCase(pasteboardAutomaticSync)) {
    case 'on':
      commonPreferences.PasteboardAutomaticSync = true;
      break;
    case 'off':
      commonPreferences.PasteboardAutomaticSync = false;
      break;
    case 'system':
      break;
    default:
      _logger.default.info(`['on', 'off' or 'system'] are available as the pasteboard automatic sync option. Defaulting to 'off'`);
      commonPreferences.PasteboardAutomaticSync = false;
  }
  return [devicePreferences, commonPreferences];
}
class SimulatorXcode9 extends _simulatorXcode.default {
  constructor(udid, xcodeVersion) {
    super(udid, xcodeVersion);
  }
  async run(opts = {}) {
    opts = _lodash.default.cloneDeep(opts);
    _lodash.default.defaultsDeep(opts, {
      isHeadless: false,
      startupTimeout: this.startupTimeout
    });
    const [devicePreferences, commonPreferences] = compileSimulatorPreferences(opts);
    await this.updatePreferences(devicePreferences, commonPreferences);
    const timer = new _support.timing.Timer().start();
    const shouldWaitForBoot = await startupLock.acquire(this.uiClientBundleId, async () => {
      const isServerRunning = await this.isRunning();
      const uiClientPid = await this.getUIClientPid();
      if (opts.isHeadless) {
        if (isServerRunning && !uiClientPid) {
          _logger.default.info(`Simulator with UDID '${this.udid}' is already booted in headless mode.`);
          return false;
        }
        if (await this.killUIClient({
          pid: uiClientPid
        })) {
          _logger.default.info(`Detected the Simulator UI client was running and killed it. Verifying the current Simulator state`);
        }
        try {
          await (0, _asyncbox.waitForCondition)(async () => await this.isShutdown(), {
            waitMs: 5000,
            intervalMs: 100
          });
        } catch (e) {
          if (!(await this.isRunning())) {
            throw new Error(`Simulator with UDID '${this.udid}' cannot be transitioned to headless mode`);
          }
          return false;
        }
        _logger.default.info(`Booting Simulator with UDID '${this.udid}' in headless mode. ` + `All UI-related capabilities are going to be ignored`);
        await this.boot();
      } else {
        if (isServerRunning && uiClientPid) {
          _logger.default.info(`Both Simulator with UDID '${this.udid}' and the UI client are currently running`);
          return false;
        }
        if (isServerRunning) {
          _logger.default.info(`Simulator '${this.udid}' is booted while its UI is not visible. ` + `Trying to restart it with the Simulator window visible`);
          await this.shutdown({
            timeout: SIMULATOR_SHUTDOWN_TIMEOUT
          });
        }
        await this.launchWindow(uiClientPid, opts);
      }
      return true;
    });
    if (shouldWaitForBoot) {
      await this.waitForBoot(opts.startupTimeout);
      _logger.default.info(`Simulator with UDID ${this.udid} booted in ${timer.getDuration().asSeconds.toFixed(3)}s`);
    }
    (async () => {
      try {
        await this.disableKeyboardIntroduction();
      } catch (e) {
        _logger.default.info(`Cannot disable Simulator keyboard introduction. Original error: ${e.message}`);
      }
    })();
  }
  async startUIClient(opts = {}) {
    opts = _lodash.default.cloneDeep(opts);
    _lodash.default.defaultsDeep(opts, {
      startupTimeout: this.startupTimeout
    });
    const simulatorApp = _path.default.resolve(await (0, _appiumXcode.getPath)(), 'Applications', this.simulatorApp);
    const args = ['-Fn', simulatorApp];
    _logger.default.info(`Starting Simulator UI: ${_support.util.quote(['open', ...args])}`);
    try {
      await (0, _teen_process.exec)('open', args, {
        timeout: opts.startupTimeout
      });
    } catch (err) {
      throw new Error(`Got an unexpected error while opening Simulator UI: ` + err.stderr || err.stdout || err.message);
    }
  }
  async disableKeyboardIntroduction() {
    const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)({
      DidShowContinuousPathIntroduction: 1
    }, true);
    await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', DOMAIN_KEYBOARD_PREFERENCES, ...args])));
  }
  async launchWindow(isUiClientRunning, opts = {}) {
    await this.boot();
    if (!isUiClientRunning) {
      await this.startUIClient(opts);
    }
  }
  async boot() {
    const bootEventsEmitter = new _events.EventEmitter();
    await this.simctl.startBootMonitor({
      onError: err => bootEventsEmitter.emit('failure', err),
      onFinished: () => bootEventsEmitter.emit('finish'),
      shouldPreboot: true
    });
    try {
      await new _bluebird.default((resolve, reject) => {
        setTimeout(resolve, 3000);
        bootEventsEmitter.once('failure', err => {
          if (_lodash.default.includes(err === null || err === void 0 ? void 0 : err.message, 'state: Booted')) {
            resolve();
          } else {
            reject(err);
          }
        });
        bootEventsEmitter.once('finish', resolve);
      });
    } finally {
      bootEventsEmitter.removeAllListeners();
    }
  }
  verifyDevicePreferences(prefs = {}) {
    if (_lodash.default.isEmpty(prefs)) {
      return;
    }
    if (!_lodash.default.isUndefined(prefs.SimulatorWindowLastScale)) {
      if (!_lodash.default.isNumber(prefs.SimulatorWindowLastScale) || prefs.SimulatorWindowLastScale <= 0) {
        _logger.default.errorAndThrow(`SimulatorWindowLastScale is expected to be a positive float value. ` + `'${prefs.SimulatorWindowLastScale}' is assigned instead.`);
      }
    }
    if (!_lodash.default.isUndefined(prefs.SimulatorWindowCenter)) {
      const verificationPattern = /{-?\d+(\.\d+)?,-?\d+(\.\d+)?}/;
      if (!_lodash.default.isString(prefs.SimulatorWindowCenter) || !verificationPattern.test(prefs.SimulatorWindowCenter)) {
        _logger.default.errorAndThrow(`SimulatorWindowCenter is expected to match "{floatXPosition,floatYPosition}" format (without spaces). ` + `'${prefs.SimulatorWindowCenter}' is assigned instead.`);
      }
    }
    if (!_lodash.default.isUndefined(prefs.SimulatorWindowOrientation)) {
      const acceptableValues = ['Portrait', 'LandscapeLeft', 'PortraitUpsideDown', 'LandscapeRight'];
      if (acceptableValues.indexOf(prefs.SimulatorWindowOrientation) === -1) {
        _logger.default.errorAndThrow(`SimulatorWindowOrientation is expected to be one of ${acceptableValues}. ` + `'${prefs.SimulatorWindowOrientation}' is assigned instead.`);
      }
    }
    if (!_lodash.default.isUndefined(prefs.SimulatorWindowRotationAngle)) {
      if (!_lodash.default.isNumber(prefs.SimulatorWindowRotationAngle)) {
        _logger.default.errorAndThrow(`SimulatorWindowRotationAngle is expected to be a valid number. ` + `'${prefs.SimulatorWindowRotationAngle}' is assigned instead.`);
      }
    }
  }
  async updatePreferences(devicePrefs = {}, commonPrefs = {}) {
    if (!_lodash.default.isEmpty(devicePrefs)) {
      _logger.default.debug(`Setting preferences of ${this.udid} Simulator to ${JSON.stringify(devicePrefs)}`);
    }
    if (!_lodash.default.isEmpty(commonPrefs)) {
      _logger.default.debug(`Setting common Simulator preferences to ${JSON.stringify(commonPrefs)}`);
    }
    const homeFolderPath = process.env.HOME;
    if (!homeFolderPath) {
      _logger.default.warn(`Cannot get the path to HOME folder from the process environment. ` + `Ignoring Simulator preferences update.`);
      return false;
    }
    this.verifyDevicePreferences(devicePrefs);
    const plistPath = _path.default.resolve(homeFolderPath, 'Library', 'Preferences', 'com.apple.iphonesimulator.plist');
    return await preferencesPlistGuard.acquire(SimulatorXcode9.name, async () => {
      const defaults = new _defaultsUtils.NSUserDefaults(plistPath);
      const prefsToUpdate = _lodash.default.clone(commonPrefs);
      try {
        if (!_lodash.default.isEmpty(devicePrefs)) {
          let existingDevicePrefs;
          const udidKey = this.udid.toUpperCase();
          if (await _support.fs.exists(plistPath)) {
            const currentPlistContent = await defaults.asJson();
            if (_lodash.default.isPlainObject(currentPlistContent.DevicePreferences) && _lodash.default.isPlainObject(currentPlistContent.DevicePreferences[udidKey])) {
              existingDevicePrefs = currentPlistContent.DevicePreferences[udidKey];
            }
          }
          Object.assign(prefsToUpdate, {
            DevicePreferences: {
              [udidKey]: Object.assign({}, existingDevicePrefs || {}, devicePrefs)
            }
          });
        }
        await defaults.update(prefsToUpdate);
        _logger.default.debug(`Updated ${this.udid} Simulator preferences at '${plistPath}' with ` + JSON.stringify(prefsToUpdate));
        return true;
      } catch (e) {
        _logger.default.warn(`Cannot update ${this.udid} Simulator preferences at '${plistPath}'. ` + `Try to delete the file manually in order to reset it. Original error: ${e.message}`);
        return false;
      }
    });
  }
  async clean() {
    _logger.default.info(`Cleaning simulator ${this.udid}`);
    await this.simctl.eraseDevice(10000);
  }
  async _activateWindow() {
    let selfName;
    let selfSdk;
    let bootedDevicesCount = 0;
    for (const [sdk, deviceArr] of _lodash.default.toPairs(await this.simctl.getDevices())) {
      for (const {
        state,
        udid,
        name
      } of deviceArr) {
        if (state === 'Booted') {
          bootedDevicesCount++;
        }
        if (!selfName && udid === this.udid) {
          selfSdk = sdk;
          selfName = name;
        }
      }
    }
    if (bootedDevicesCount < 2) {
      return await super._activateWindow();
    }
    return `
      tell application "System Events"
        tell process "Simulator"
          set frontmost to false
          set frontmost to true
          click (menu item 1 where (its name contains "${selfName} " and its name contains "${selfSdk}")) of menu 1 of menu bar item "Window" of menu bar 1
        end tell
      end tell
    `;
  }
  async isBiometricEnrolled() {
    const {
      stdout
    } = await this.simctl.spawnProcess(['notifyutil', '-g', ENROLLMENT_NOTIFICATION_RECEIVER]);
    const match = new RegExp(`${_lodash.default.escapeRegExp(ENROLLMENT_NOTIFICATION_RECEIVER)}\\s+([01])`).exec(stdout);
    if (!match) {
      throw new Error(`Cannot parse biometric enrollment state from '${stdout}'`);
    }
    _logger.default.info(`Current biometric enrolled state for ${this.udid} Simulator: ${match[1]}`);
    return match[1] === '1';
  }
  async enrollBiometric(isEnabled = true) {
    _logger.default.debug(`Setting biometric enrolled state for ${this.udid} Simulator to '${isEnabled ? 'enabled' : 'disabled'}'`);
    await this.simctl.spawnProcess(['notifyutil', '-s', ENROLLMENT_NOTIFICATION_RECEIVER, isEnabled ? '1' : '0']);
    await this.simctl.spawnProcess(['notifyutil', '-p', ENROLLMENT_NOTIFICATION_RECEIVER]);
    if ((await this.isBiometricEnrolled()) !== isEnabled) {
      throw new Error(`Cannot set biometric enrolled state for ${this.udid} Simulator to '${isEnabled ? 'enabled' : 'disabled'}'`);
    }
  }
  async sendBiometricMatch(shouldMatch = true, biometricName = 'touchId') {
    const domainComponent = (0, _utils.toBiometricDomainComponent)(biometricName);
    const domain = `com.apple.BiometricKit_Sim.${domainComponent}.${shouldMatch ? '' : 'no'}match`;
    await this.simctl.spawnProcess(['notifyutil', '-p', domain]);
    _logger.default.info(`Sent notification ${domain} to ${shouldMatch ? 'match' : 'not match'} ${biometricName} biometric ` + `for ${this.udid} Simulator`);
  }
  async getLaunchDaemonsRoot() {
    const devRoot = await (0, _utils.getDeveloperRoot)();
    return _path.default.resolve(devRoot, 'Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/LaunchDaemons');
  }
  async configureLocalization(opts = {}) {
    if (_lodash.default.isEmpty(opts)) {
      return false;
    }
    const {
      language,
      locale,
      keyboard
    } = opts;
    const globalPrefs = {};
    let keyboardId = null;
    if (_lodash.default.isPlainObject(keyboard)) {
      const {
        name,
        layout,
        hardware
      } = keyboard;
      if (!name) {
        throw new Error(`The 'keyboard' field must have a valid name set`);
      }
      if (!layout) {
        throw new Error(`The 'keyboard' field must have a valid layout set`);
      }
      keyboardId = `${name}@sw=${layout}`;
      if (hardware) {
        keyboardId += `;@hw=${hardware}`;
      }
      globalPrefs.AppleKeyboards = [keyboardId];
    }
    if (_lodash.default.isPlainObject(language)) {
      const {
        name
      } = language;
      if (!name) {
        throw new Error(`The 'language' field must have a valid name set`);
      }
      globalPrefs.AppleLanguages = [name];
    }
    if (_lodash.default.isPlainObject(locale)) {
      const {
        name,
        calendar
      } = locale;
      if (!name) {
        throw new Error(`The 'locale' field must have a valid name set`);
      }
      let localeId = name;
      if (calendar) {
        localeId += `@calendar=${calendar}`;
      }
      globalPrefs.AppleLocale = localeId;
    }
    if (_lodash.default.isEmpty(globalPrefs)) {
      return false;
    }
    const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)(globalPrefs, true);
    await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', '.GlobalPreferences.plist', ...args])));
    if (keyboardId) {
      const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)({
        KeyboardsCurrentAndNext: [keyboardId],
        KeyboardLastUsed: keyboardId,
        KeyboardLastUsedForLanguage: {
          [keyboard.name]: keyboardId
        }
      }, true);
      await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', 'com.apple.Preferences', ...args])));
    }
    return true;
  }
  async updateSafariGlobalSettings(updates) {
    await this.updateSafariSettings(updates);
  }
  async updateSafariSettings(updates) {
    if (_lodash.default.isEmpty(updates)) {
      return false;
    }
    const containerRoot = await this.simctl.getAppContainer(_utils.MOBILE_SAFARI_BUNDLE_ID, 'data');
    const plistPath = _path.default.join(containerRoot, 'Library', 'Preferences', 'com.apple.mobilesafari.plist');
    return await this.updateSettings(plistPath, updates);
  }
  async setReduceMotion(reduceMotion = true) {
    return await this.updateSettings('com.apple.Accessibility', {
      ReduceMotionEnabled: Number(reduceMotion)
    });
  }
  async setReduceTransparency(reduceTransparency) {
    return await this.updateSettings('com.apple.Accessibility', {
      EnhancedBackgroundContrastEnabled: Number(reduceTransparency)
    });
  }
  async updateSettings(domain, updates) {
    if (_lodash.default.isEmpty(updates)) {
      return false;
    }
    if (_lodash.default.keys(_settings.PLIST_IDENTIFIER).includes(domain)) {
      return await super.updateSettings(domain, updates);
    }
    const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)(updates);
    await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', domain, ...args])));
    return true;
  }
}
var _default = SimulatorXcode9;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTSU1VTEFUT1JfU0hVVERPV05fVElNRU9VVCIsInN0YXJ0dXBMb2NrIiwiQXN5bmNMb2NrIiwicHJlZmVyZW5jZXNQbGlzdEd1YXJkIiwiRU5ST0xMTUVOVF9OT1RJRklDQVRJT05fUkVDRUlWRVIiLCJET01BSU5fS0VZQk9BUkRfUFJFRkVSRU5DRVMiLCJjb21waWxlU2ltdWxhdG9yUHJlZmVyZW5jZXMiLCJvcHRzIiwiY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQiLCJ0cmFjZVBvaW50ZXIiLCJwYXN0ZWJvYXJkQXV0b21hdGljU3luYyIsInNjYWxlRmFjdG9yIiwiY29tbW9uUHJlZmVyZW5jZXMiLCJSb3RhdGVXaW5kb3dXaGVuU2lnbmFsZWRCeUd1ZXN0IiwiU3RhcnRMYXN0RGV2aWNlT25MYXVuY2giLCJEZXRhY2hPbldpbmRvd0Nsb3NlIiwiQXR0YWNoQm9vdGVkT25TdGFydCIsImRldmljZVByZWZlcmVuY2VzIiwiXyIsImNsb25lRGVlcCIsIlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSIsInBhcnNlRmxvYXQiLCJpc0Jvb2xlYW4iLCJpc05pbCIsIkNvbm5lY3RIYXJkd2FyZUtleWJvYXJkIiwiU2hvd1NpbmdsZVRvdWNoZXMiLCJTaG93UGluY2hlcyIsIlNob3dQaW5jaFBpdm90UG9pbnQiLCJIaWdobGlnaHRFZGdlR2VzdHVyZXMiLCJsb3dlckNhc2UiLCJQYXN0ZWJvYXJkQXV0b21hdGljU3luYyIsImxvZyIsImluZm8iLCJTaW11bGF0b3JYY29kZTkiLCJTaW11bGF0b3JYY29kZTgiLCJjb25zdHJ1Y3RvciIsInVkaWQiLCJ4Y29kZVZlcnNpb24iLCJydW4iLCJkZWZhdWx0c0RlZXAiLCJpc0hlYWRsZXNzIiwic3RhcnR1cFRpbWVvdXQiLCJ1cGRhdGVQcmVmZXJlbmNlcyIsInRpbWVyIiwidGltaW5nIiwiVGltZXIiLCJzdGFydCIsInNob3VsZFdhaXRGb3JCb290IiwiYWNxdWlyZSIsInVpQ2xpZW50QnVuZGxlSWQiLCJpc1NlcnZlclJ1bm5pbmciLCJpc1J1bm5pbmciLCJ1aUNsaWVudFBpZCIsImdldFVJQ2xpZW50UGlkIiwia2lsbFVJQ2xpZW50IiwicGlkIiwid2FpdEZvckNvbmRpdGlvbiIsImlzU2h1dGRvd24iLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIiwiZSIsIkVycm9yIiwiYm9vdCIsInNodXRkb3duIiwidGltZW91dCIsImxhdW5jaFdpbmRvdyIsIndhaXRGb3JCb290IiwiZ2V0RHVyYXRpb24iLCJhc1NlY29uZHMiLCJ0b0ZpeGVkIiwiZGlzYWJsZUtleWJvYXJkSW50cm9kdWN0aW9uIiwibWVzc2FnZSIsInN0YXJ0VUlDbGllbnQiLCJzaW11bGF0b3JBcHAiLCJwYXRoIiwicmVzb2x2ZSIsImdldFhjb2RlUGF0aCIsImFyZ3MiLCJ1dGlsIiwicXVvdGUiLCJleGVjIiwiZXJyIiwic3RkZXJyIiwic3Rkb3V0IiwiYXJnQ2h1bmtzIiwiZ2VuZXJhdGVEZWZhdWx0c0NvbW1hbmRBcmdzIiwiRGlkU2hvd0NvbnRpbnVvdXNQYXRoSW50cm9kdWN0aW9uIiwiQiIsImFsbCIsIm1hcCIsInNpbWN0bCIsInNwYXduUHJvY2VzcyIsImlzVWlDbGllbnRSdW5uaW5nIiwiYm9vdEV2ZW50c0VtaXR0ZXIiLCJFdmVudEVtaXR0ZXIiLCJzdGFydEJvb3RNb25pdG9yIiwib25FcnJvciIsImVtaXQiLCJvbkZpbmlzaGVkIiwic2hvdWxkUHJlYm9vdCIsInJlamVjdCIsInNldFRpbWVvdXQiLCJvbmNlIiwiaW5jbHVkZXMiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJ2ZXJpZnlEZXZpY2VQcmVmZXJlbmNlcyIsInByZWZzIiwiaXNFbXB0eSIsImlzVW5kZWZpbmVkIiwiaXNOdW1iZXIiLCJlcnJvckFuZFRocm93IiwiU2ltdWxhdG9yV2luZG93Q2VudGVyIiwidmVyaWZpY2F0aW9uUGF0dGVybiIsImlzU3RyaW5nIiwidGVzdCIsIlNpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uIiwiYWNjZXB0YWJsZVZhbHVlcyIsImluZGV4T2YiLCJTaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlIiwiZGV2aWNlUHJlZnMiLCJjb21tb25QcmVmcyIsImRlYnVnIiwiSlNPTiIsInN0cmluZ2lmeSIsImhvbWVGb2xkZXJQYXRoIiwicHJvY2VzcyIsImVudiIsIkhPTUUiLCJ3YXJuIiwicGxpc3RQYXRoIiwibmFtZSIsImRlZmF1bHRzIiwiTlNVc2VyRGVmYXVsdHMiLCJwcmVmc1RvVXBkYXRlIiwiY2xvbmUiLCJleGlzdGluZ0RldmljZVByZWZzIiwidWRpZEtleSIsInRvVXBwZXJDYXNlIiwiZnMiLCJleGlzdHMiLCJjdXJyZW50UGxpc3RDb250ZW50IiwiYXNKc29uIiwiaXNQbGFpbk9iamVjdCIsIkRldmljZVByZWZlcmVuY2VzIiwiT2JqZWN0IiwiYXNzaWduIiwidXBkYXRlIiwiY2xlYW4iLCJlcmFzZURldmljZSIsIl9hY3RpdmF0ZVdpbmRvdyIsInNlbGZOYW1lIiwic2VsZlNkayIsImJvb3RlZERldmljZXNDb3VudCIsInNkayIsImRldmljZUFyciIsInRvUGFpcnMiLCJnZXREZXZpY2VzIiwic3RhdGUiLCJpc0Jpb21ldHJpY0Vucm9sbGVkIiwibWF0Y2giLCJSZWdFeHAiLCJlc2NhcGVSZWdFeHAiLCJlbnJvbGxCaW9tZXRyaWMiLCJpc0VuYWJsZWQiLCJzZW5kQmlvbWV0cmljTWF0Y2giLCJzaG91bGRNYXRjaCIsImJpb21ldHJpY05hbWUiLCJkb21haW5Db21wb25lbnQiLCJ0b0Jpb21ldHJpY0RvbWFpbkNvbXBvbmVudCIsImRvbWFpbiIsImdldExhdW5jaERhZW1vbnNSb290IiwiZGV2Um9vdCIsImdldERldmVsb3BlclJvb3QiLCJjb25maWd1cmVMb2NhbGl6YXRpb24iLCJsYW5ndWFnZSIsImxvY2FsZSIsImtleWJvYXJkIiwiZ2xvYmFsUHJlZnMiLCJrZXlib2FyZElkIiwibGF5b3V0IiwiaGFyZHdhcmUiLCJBcHBsZUtleWJvYXJkcyIsIkFwcGxlTGFuZ3VhZ2VzIiwiY2FsZW5kYXIiLCJsb2NhbGVJZCIsIkFwcGxlTG9jYWxlIiwiS2V5Ym9hcmRzQ3VycmVudEFuZE5leHQiLCJLZXlib2FyZExhc3RVc2VkIiwiS2V5Ym9hcmRMYXN0VXNlZEZvckxhbmd1YWdlIiwidXBkYXRlU2FmYXJpR2xvYmFsU2V0dGluZ3MiLCJ1cGRhdGVzIiwidXBkYXRlU2FmYXJpU2V0dGluZ3MiLCJjb250YWluZXJSb290IiwiZ2V0QXBwQ29udGFpbmVyIiwiTU9CSUxFX1NBRkFSSV9CVU5ETEVfSUQiLCJqb2luIiwidXBkYXRlU2V0dGluZ3MiLCJzZXRSZWR1Y2VNb3Rpb24iLCJyZWR1Y2VNb3Rpb24iLCJSZWR1Y2VNb3Rpb25FbmFibGVkIiwiTnVtYmVyIiwic2V0UmVkdWNlVHJhbnNwYXJlbmN5IiwicmVkdWNlVHJhbnNwYXJlbmN5IiwiRW5oYW5jZWRCYWNrZ3JvdW5kQ29udHJhc3RFbmFibGVkIiwia2V5cyIsIlBMSVNUX0lERU5USUZJRVIiXSwic291cmNlcyI6WyIuLi8uLi9saWIvc2ltdWxhdG9yLXhjb2RlLTkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNpbXVsYXRvclhjb2RlOCBmcm9tICcuL3NpbXVsYXRvci14Y29kZS04JztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IGZzLCB0aW1pbmcsIHV0aWwgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IEFzeW5jTG9jayBmcm9tICdhc3luYy1sb2NrJztcbmltcG9ydCBsb2cgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgd2FpdEZvckNvbmRpdGlvbiB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IHRvQmlvbWV0cmljRG9tYWluQ29tcG9uZW50LCBnZXREZXZlbG9wZXJSb290LCBNT0JJTEVfU0FGQVJJX0JVTkRMRV9JRCB9IGZyb20gJy4vdXRpbHMuanMnO1xuaW1wb3J0IHsgTlNVc2VyRGVmYXVsdHMsIGdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyB9IGZyb20gJy4vZGVmYXVsdHMtdXRpbHMnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IGdldFBhdGggYXMgZ2V0WGNvZGVQYXRoIH0gZnJvbSAnYXBwaXVtLXhjb2RlJztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IHsgUExJU1RfSURFTlRJRklFUiB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5jb25zdCBTSU1VTEFUT1JfU0hVVERPV05fVElNRU9VVCA9IDE1ICogMTAwMDtcbmNvbnN0IHN0YXJ0dXBMb2NrID0gbmV3IEFzeW5jTG9jaygpO1xuY29uc3QgcHJlZmVyZW5jZXNQbGlzdEd1YXJkID0gbmV3IEFzeW5jTG9jaygpO1xuY29uc3QgRU5ST0xMTUVOVF9OT1RJRklDQVRJT05fUkVDRUlWRVIgPSAnY29tLmFwcGxlLkJpb21ldHJpY0tpdC5lbnJvbGxtZW50Q2hhbmdlZCc7XG5jb25zdCBET01BSU5fS0VZQk9BUkRfUFJFRkVSRU5DRVMgPSAnY29tLmFwcGxlLmtleWJvYXJkLnByZWZlcmVuY2VzJztcblxuLyoqXG4gKiBDcmVhdGVzIGRldmljZSBhbmQgY29tbW9uIFNpbXVsYXRvciBwcmVmZXJlbmNlcywgd2hpY2ggY291bGRcbiAqIGJlIGxhdGVyIGFwcGxpZWQgdXNpbmcgYGRlZmF1bHRzYCBDTEkgdXRpbGl0eS5cbiAqXG4gKiBAcGFyYW0ge1J1bk9wdGlvbnN9IG9wdHNcbiAqIEByZXR1cm5zIHtvYmplY3RbXX0gVGhlIGZpcnN0IGFycmF5IGl0ZW0gaXMgdGhlIHJlc3VsdGluZyBkZXZpY2UgcHJlZmVyZW5jZXNcbiAqIG9iamVjdCBhbmQgdGhlIHNlY29uZCBvbmUgaXMgY29tbW9uIHByZWZlcmVuY2VzIG9iamVjdFxuICovXG5mdW5jdGlvbiBjb21waWxlU2ltdWxhdG9yUHJlZmVyZW5jZXMgKG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQsXG4gICAgdHJhY2VQb2ludGVyLFxuICAgIHBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jLFxuICAgIHNjYWxlRmFjdG9yLFxuICB9ID0gb3B0cztcbiAgY29uc3QgY29tbW9uUHJlZmVyZW5jZXMgPSB7XG4gICAgLy8gVGhpcyBvcHRpb24gaXMgbmVjZXNzYXJ5IHRvIG1ha2UgdGhlIFNpbXVsYXRvciB3aW5kb3cgZm9sbG93XG4gICAgLy8gdGhlIGFjdHVhbCBYQ1VJRGV2aWNlIG9yaWVudGF0aW9uXG4gICAgUm90YXRlV2luZG93V2hlblNpZ25hbGVkQnlHdWVzdDogdHJ1ZSxcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9pc3N1ZXMvMTY0MThcbiAgICBTdGFydExhc3REZXZpY2VPbkxhdW5jaDogZmFsc2UsXG4gICAgRGV0YWNoT25XaW5kb3dDbG9zZTogZmFsc2UsXG4gICAgQXR0YWNoQm9vdGVkT25TdGFydDogdHJ1ZSxcbiAgfTtcbiAgY29uc3QgZGV2aWNlUHJlZmVyZW5jZXMgPSBvcHRzLmRldmljZVByZWZlcmVuY2VzID8gXy5jbG9uZURlZXAob3B0cy5kZXZpY2VQcmVmZXJlbmNlcykgOiB7fTtcbiAgaWYgKHNjYWxlRmFjdG9yKSB7XG4gICAgZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93TGFzdFNjYWxlID0gcGFyc2VGbG9hdChzY2FsZUZhY3Rvcik7XG4gIH1cbiAgaWYgKF8uaXNCb29sZWFuKGNvbm5lY3RIYXJkd2FyZUtleWJvYXJkKSB8fCBfLmlzTmlsKGNvbm5lY3RIYXJkd2FyZUtleWJvYXJkKSkge1xuICAgIGRldmljZVByZWZlcmVuY2VzLkNvbm5lY3RIYXJkd2FyZUtleWJvYXJkID0gY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgPz8gZmFsc2U7XG4gICAgY29tbW9uUHJlZmVyZW5jZXMuQ29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgPSBjb25uZWN0SGFyZHdhcmVLZXlib2FyZCA/PyBmYWxzZTtcbiAgfVxuICBpZiAoXy5pc0Jvb2xlYW4odHJhY2VQb2ludGVyKSkge1xuICAgIGNvbW1vblByZWZlcmVuY2VzLlNob3dTaW5nbGVUb3VjaGVzID0gdHJhY2VQb2ludGVyO1xuICAgIGNvbW1vblByZWZlcmVuY2VzLlNob3dQaW5jaGVzID0gdHJhY2VQb2ludGVyO1xuICAgIGNvbW1vblByZWZlcmVuY2VzLlNob3dQaW5jaFBpdm90UG9pbnQgPSB0cmFjZVBvaW50ZXI7XG4gICAgY29tbW9uUHJlZmVyZW5jZXMuSGlnaGxpZ2h0RWRnZUdlc3R1cmVzID0gdHJhY2VQb2ludGVyO1xuICB9XG4gIHN3aXRjaCAoXy5sb3dlckNhc2UocGFzdGVib2FyZEF1dG9tYXRpY1N5bmMpKSB7XG4gICAgY2FzZSAnb24nOlxuICAgICAgY29tbW9uUHJlZmVyZW5jZXMuUGFzdGVib2FyZEF1dG9tYXRpY1N5bmMgPSB0cnVlO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnb2ZmJzpcbiAgICAgIC8vIEltcHJvdmUgbGF1bmNoaW5nIHNpbXVsYXRvciBwZXJmb3JtYW5jZVxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1dlYktpdC93ZWJraXQvYmxvYi9tYXN0ZXIvVG9vbHMvU2NyaXB0cy93ZWJraXRweS94Y29kZS9zaW11bGF0ZWRfZGV2aWNlLnB5I0w0MTNcbiAgICAgIGNvbW1vblByZWZlcmVuY2VzLlBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jID0gZmFsc2U7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdzeXN0ZW0nOlxuICAgICAgLy8gRG8gbm90IGFkZCAtUGFzdGVib2FyZEF1dG9tYXRpY1N5bmNcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBsb2cuaW5mbyhgWydvbicsICdvZmYnIG9yICdzeXN0ZW0nXSBhcmUgYXZhaWxhYmxlIGFzIHRoZSBwYXN0ZWJvYXJkIGF1dG9tYXRpYyBzeW5jIG9wdGlvbi4gRGVmYXVsdGluZyB0byAnb2ZmJ2ApO1xuICAgICAgY29tbW9uUHJlZmVyZW5jZXMuUGFzdGVib2FyZEF1dG9tYXRpY1N5bmMgPSBmYWxzZTtcbiAgfVxuICByZXR1cm4gW2RldmljZVByZWZlcmVuY2VzLCBjb21tb25QcmVmZXJlbmNlc107XG59XG5cbmNsYXNzIFNpbXVsYXRvclhjb2RlOSBleHRlbmRzIFNpbXVsYXRvclhjb2RlOCB7XG4gIGNvbnN0cnVjdG9yICh1ZGlkLCB4Y29kZVZlcnNpb24pIHtcbiAgICBzdXBlcih1ZGlkLCB4Y29kZVZlcnNpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IERldmljZVByZWZlcmVuY2VzXG4gICAqIEBwcm9wZXJ0eSB7P251bWJlcn0gU2ltdWxhdG9yRXh0ZXJuYWxEaXNwbGF5IC0gVEJELiBFeGFtcGxlIHZhbHVlOiAyLjExNFxuICAgKiBAcHJvcGVydHkgez9zdHJpbmd9IENocm9tZVRpbnQgLSBUQkQuIEV4YW1wbGUgdmFsdWU6ICcnXG4gICAqIEBwcm9wZXJ0eSB7P251bWJlcn0gU2ltdWxhdG9yV2luZG93TGFzdFNjYWxlIC0gU2NhbGUgdmFsdWUgZm9yIHRoZSBwYXJ0aWN1bGFyIFNpbXVsYXRvciB3aW5kb3cuXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMS4wIG1lYW5zIDEwMCUgc2NhbGUuXG4gICAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24gLSBTaW11bGF0b3Igd2luZG93IG9yaWVudGF0aW9uLiBQb3NzaWJsZSB2YWx1ZXMgYXJlOlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1BvcnRyYWl0JywgJ0xhbmRzY2FwZUxlZnQnLCAnUG9ydHJhaXRVcHNpZGVEb3duJyBhbmQgJ0xhbmRzY2FwZVJpZ2h0Jy5cbiAgICogQHByb3BlcnR5IHs/bnVtYmVyfSBTaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlIC0gV2luZG93IHJvdGF0aW9uIGFuZ2xlLiBUaGlzIHZhbHVlIGlzIGV4cGVjdGVkIHRvIGJlIGluIHN5bmNcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBfU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb25fLiBUaGUgY29ycmVzcG9uZGluZyB2YWx1ZXMgYXJlOlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLCA5MCwgMTgwIGFuZCAyNzAuXG4gICAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gU2ltdWxhdG9yV2luZG93Q2VudGVyIC0gVGhlIGNvb3JkaW5hdGVzIG9mIFNpbXVsYXRvcidzIHdpbmRvdyBjZW50ZXIgaW4gcGl4ZWxzLFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlICd7LTEyOTQuNSwgNzc1LjV9Jy5cbiAgICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gQ29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgLSBFcXVhbHMgdG8gMSBpZiBoYXJkd2FyZSBrZXlib2FyZCBzaG91bGQgYmUgY29ubmVjdGVkLlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE90aGVyd2lzZSAwLlxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gQ29tbW9uUHJlZmVyZW5jZXNcbiAgICogQHByb3BlcnR5IHtib29sZWFufSBDb25uZWN0SGFyZHdhcmVLZXlib2FyZCAtIFdoZXRoZXIgdG8gY29ubmVjdCBoYXJkd2FyZSBrZXlib2FyZFxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gUnVuT3B0aW9uc1xuICAgKiBAcHJvcGVydHkge3N0cmluZ30gc2NhbGVGYWN0b3I6IEFueSBwb3NpdGl2ZSBmbG9hdCB2YWx1ZS4gMS4wIG1lYW5zIDE6MSBzY2FsZS5cbiAgICogRGVmaW5lcyB0aGUgd2luZG93IHNjYWxlIHZhbHVlIGZvciB0aGUgVUkgY2xpZW50IHdpbmRvdyBmb3IgdGhlIGN1cnJlbnQgU2ltdWxhdG9yLlxuICAgKiBFcXVhbHMgdG8gYG51bGxgIGJ5IGRlZmF1bHQsIHdoaWNoIGtlZXBzIHRoZSBjdXJyZW50IHNjYWxlIHVuY2hhbmdlZC5cbiAgICogQHByb3BlcnR5IHtib29sZWFufSBjb25uZWN0SGFyZHdhcmVLZXlib2FyZDogd2hldGhlciB0byBjb25uZWN0IHRoZSBoYXJkd2FyZSBrZXlib2FyZCB0byB0aGVcbiAgICogU2ltdWxhdG9yIFVJIGNsaWVudC4gRXF1YWxzIHRvIGBmYWxzZWAgYnkgZGVmYXVsdC5cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IHN0YXJ0dXBUaW1lb3V0OiBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgU2ltdWxhdG9yIGJvb3RpbmdcbiAgICogcHJvY2VzcyBpcyBjb21wbGV0ZWQuIFRoZSBkZWZhdWx0IHRpbWVvdXQgd2lsbCBiZSB1c2VkIGlmIG5vdCBzZXQgZXhwbGljaXRseS5cbiAgICogQHByb3BlcnR5IHtib29sZWFufSBpc0hlYWRsZXNzOiB3aGV0aGVyIHRvIHN0YXJ0IHRoZSBTaW11bGF0b3IgaW4gaGVhZGxlc3MgbW9kZSAod2l0aCBVSVxuICAgKiBjbGllbnQgaW52aXNpYmxlKS4gYGZhbHNlYCBieSBkZWZhdWx0LlxuICAgKiBAcHJvcGVydHkgez9ib29sZWFufSB0cmFjZVBvaW50ZXIgW2ZhbHNlXSAtIFdoZXRoZXIgdG8gaGlnaGxpZ2h0IHRvdWNoZXMgb24gU2ltdWxhdG9yXG4gICAqIHNjcmVlbi4gVGhpcyBpcyBoZWxwZnVsIHdoaWxlIGRlYnVnZ2luZyBhdXRvbWF0ZWQgdGVzdHMgb3Igd2hpbGUgb2JzZXJ2aW5nIHRoZSBhdXRvbWF0aW9uXG4gICAqIHJlY29yZGluZ3MuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBwYXN0ZWJvYXJkQXV0b21hdGljU3luYyBbJ29mZiddIC0gV2hldGhlciB0byBkaXNhYmxlIHBhc3RlYm9hcmQgc3luYyB3aXRoIHRoZVxuICAgKiBTaW11bGF0b3IgVUkgY2xpZW50IG9yIHJlc3BlY3QgdGhlIHN5c3RlbSB3aWRlIHByZWZlcmVuY2UuICdvbicsICdvZmYnLCBvciAnc3lzdGVtJyBpcyBhdmFpbGFibGUuXG4gICAqIFRoZSBzeW5jIGluY3JlYXNlcyBsYXVuY2hpbmcgc2ltdWxhdG9yIHByb2Nlc3MgdGltZSwgYnV0IGl0IGFsbG93cyBzeXN0ZW0gdG8gc3luYyBwYXN0ZWJvYXJkXG4gICAqIHdpdGggc2ltdWxhdG9ycy4gRm9sbG93cyBzeXN0ZW0td2lkZSBwcmVmZXJlbmNlIGlmIHRoZSB2YWx1ZSBpcyAnc3lzdGVtJy5cbiAgICogRGVmYXVsdHMgdG8gJ29mZicuXG4gICAqIEBwcm9wZXJ0eSB7RGV2aWNlUHJlZmVyZW5jZXN9IGRldmljZVByZWZlcmVuY2VzOiBwcmVmZXJlbmNlcyBvZiB0aGUgbmV3bHkgY3JlYXRlZCBTaW11bGF0b3JcbiAgICogZGV2aWNlXG4gICAqL1xuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyBnaXZlbiBTaW11bGF0b3Igd2l0aCBvcHRpb25zLiBUaGUgU2ltdWxhdG9yIHdpbGwgbm90IGJlIHJlc3RhcnRlZCBpZlxuICAgKiBpdCBpcyBhbHJlYWR5IHJ1bm5pbmcgYW5kIHRoZSBjdXJyZW50IFVJIHN0YXRlIG1hdGNoZXMgdG8gYGlzSGVhZGxlc3NgIG9wdGlvbi5cbiAgICogQG92ZXJyaWRlXG4gICAqXG4gICAqIEBwYXJhbSB7UnVuT3B0aW9uc30gb3B0cyAtIE9uZSBvciBtb3JlIG9mIGF2YWlsYWJsZSBTaW11bGF0b3Igb3B0aW9uc1xuICAgKi9cbiAgYXN5bmMgcnVuIChvcHRzID0ge30pIHtcbiAgICBvcHRzID0gXy5jbG9uZURlZXAob3B0cyk7XG4gICAgXy5kZWZhdWx0c0RlZXAob3B0cywge1xuICAgICAgaXNIZWFkbGVzczogZmFsc2UsXG4gICAgICBzdGFydHVwVGltZW91dDogdGhpcy5zdGFydHVwVGltZW91dCxcbiAgICB9KTtcblxuICAgIGNvbnN0IFtkZXZpY2VQcmVmZXJlbmNlcywgY29tbW9uUHJlZmVyZW5jZXNdID0gY29tcGlsZVNpbXVsYXRvclByZWZlcmVuY2VzKG9wdHMpO1xuICAgIGF3YWl0IHRoaXMudXBkYXRlUHJlZmVyZW5jZXMoZGV2aWNlUHJlZmVyZW5jZXMsIGNvbW1vblByZWZlcmVuY2VzKTtcblxuICAgIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gICAgY29uc3Qgc2hvdWxkV2FpdEZvckJvb3QgPSBhd2FpdCBzdGFydHVwTG9jay5hY3F1aXJlKHRoaXMudWlDbGllbnRCdW5kbGVJZCwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaXNTZXJ2ZXJSdW5uaW5nID0gYXdhaXQgdGhpcy5pc1J1bm5pbmcoKTtcbiAgICAgIGNvbnN0IHVpQ2xpZW50UGlkID0gYXdhaXQgdGhpcy5nZXRVSUNsaWVudFBpZCgpO1xuICAgICAgaWYgKG9wdHMuaXNIZWFkbGVzcykge1xuICAgICAgICBpZiAoaXNTZXJ2ZXJSdW5uaW5nICYmICF1aUNsaWVudFBpZCkge1xuICAgICAgICAgIGxvZy5pbmZvKGBTaW11bGF0b3Igd2l0aCBVRElEICcke3RoaXMudWRpZH0nIGlzIGFscmVhZHkgYm9vdGVkIGluIGhlYWRsZXNzIG1vZGUuYCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhd2FpdCB0aGlzLmtpbGxVSUNsaWVudCh7cGlkOiB1aUNsaWVudFBpZH0pKSB7XG4gICAgICAgICAgbG9nLmluZm8oYERldGVjdGVkIHRoZSBTaW11bGF0b3IgVUkgY2xpZW50IHdhcyBydW5uaW5nIGFuZCBraWxsZWQgaXQuIFZlcmlmeWluZyB0aGUgY3VycmVudCBTaW11bGF0b3Igc3RhdGVgKTtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIFN0b3BwaW5nIHRoZSBVSSBjbGllbnQga2lsbHMgYWxsIHJ1bm5pbmcgc2VydmVycyBmb3Igc29tZSBlYXJseSBYQ29kZSB2ZXJzaW9ucy4gVGhpcyBpcyBhIGtub3duIGJ1Z1xuICAgICAgICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5pc1NodXRkb3duKCksIHtcbiAgICAgICAgICAgIHdhaXRNczogNTAwMCxcbiAgICAgICAgICAgIGludGVydmFsTXM6IDEwMCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlmICghYXdhaXQgdGhpcy5pc1J1bm5pbmcoKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTaW11bGF0b3Igd2l0aCBVRElEICcke3RoaXMudWRpZH0nIGNhbm5vdCBiZSB0cmFuc2l0aW9uZWQgdG8gaGVhZGxlc3MgbW9kZWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgbG9nLmluZm8oYEJvb3RpbmcgU2ltdWxhdG9yIHdpdGggVURJRCAnJHt0aGlzLnVkaWR9JyBpbiBoZWFkbGVzcyBtb2RlLiBgICtcbiAgICAgICAgICBgQWxsIFVJLXJlbGF0ZWQgY2FwYWJpbGl0aWVzIGFyZSBnb2luZyB0byBiZSBpZ25vcmVkYCk7XG4gICAgICAgIGF3YWl0IHRoaXMuYm9vdCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzU2VydmVyUnVubmluZyAmJiB1aUNsaWVudFBpZCkge1xuICAgICAgICAgIGxvZy5pbmZvKGBCb3RoIFNpbXVsYXRvciB3aXRoIFVESUQgJyR7dGhpcy51ZGlkfScgYW5kIHRoZSBVSSBjbGllbnQgYXJlIGN1cnJlbnRseSBydW5uaW5nYCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1NlcnZlclJ1bm5pbmcpIHtcbiAgICAgICAgICBsb2cuaW5mbyhgU2ltdWxhdG9yICcke3RoaXMudWRpZH0nIGlzIGJvb3RlZCB3aGlsZSBpdHMgVUkgaXMgbm90IHZpc2libGUuIGAgK1xuICAgICAgICAgICAgYFRyeWluZyB0byByZXN0YXJ0IGl0IHdpdGggdGhlIFNpbXVsYXRvciB3aW5kb3cgdmlzaWJsZWApO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc2h1dGRvd24oe3RpbWVvdXQ6IFNJTVVMQVRPUl9TSFVURE9XTl9USU1FT1VUfSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5sYXVuY2hXaW5kb3codWlDbGllbnRQaWQsIG9wdHMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG5cbiAgICBpZiAoc2hvdWxkV2FpdEZvckJvb3QpIHtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvckJvb3Qob3B0cy5zdGFydHVwVGltZW91dCk7XG4gICAgICBsb2cuaW5mbyhgU2ltdWxhdG9yIHdpdGggVURJRCAke3RoaXMudWRpZH0gYm9vdGVkIGluICR7dGltZXIuZ2V0RHVyYXRpb24oKS5hc1NlY29uZHMudG9GaXhlZCgzKX1zYCk7XG4gICAgfVxuXG4gICAgKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZGlzYWJsZUtleWJvYXJkSW50cm9kdWN0aW9uKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy5pbmZvKGBDYW5ub3QgZGlzYWJsZSBTaW11bGF0b3Iga2V5Ym9hcmQgaW50cm9kdWN0aW9uLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgfSkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIHN0YXJ0VUlDbGllbnQgKG9wdHMgPSB7fSkge1xuICAgIG9wdHMgPSBfLmNsb25lRGVlcChvcHRzKTtcbiAgICBfLmRlZmF1bHRzRGVlcChvcHRzLCB7XG4gICAgICBzdGFydHVwVGltZW91dDogdGhpcy5zdGFydHVwVGltZW91dCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHNpbXVsYXRvckFwcCA9IHBhdGgucmVzb2x2ZShhd2FpdCBnZXRYY29kZVBhdGgoKSwgJ0FwcGxpY2F0aW9ucycsIHRoaXMuc2ltdWxhdG9yQXBwKTtcbiAgICBjb25zdCBhcmdzID0gWyctRm4nLCBzaW11bGF0b3JBcHBdO1xuICAgIGxvZy5pbmZvKGBTdGFydGluZyBTaW11bGF0b3IgVUk6ICR7dXRpbC5xdW90ZShbJ29wZW4nLCAuLi5hcmdzXSl9YCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGV4ZWMoJ29wZW4nLCBhcmdzLCB7dGltZW91dDogb3B0cy5zdGFydHVwVGltZW91dH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBHb3QgYW4gdW5leHBlY3RlZCBlcnJvciB3aGlsZSBvcGVuaW5nIFNpbXVsYXRvciBVSTogYCArXG4gICAgICAgIGVyci5zdGRlcnIgfHwgZXJyLnN0ZG91dCB8fCBlcnIubWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERpc2FibGUga2V5Ym9hcmQgdHV0b3JpYWwgYXMgJ2NvbS5hcHBsZS5rZXlib2FyZC5wcmVmZXJlbmNlcycgZG9tYWluIHZpYSAnZGVmYXVsdHMnIGNvbW1hbmQuXG4gICAqL1xuICBhc3luYyBkaXNhYmxlS2V5Ym9hcmRJbnRyb2R1Y3Rpb24gKCkge1xuICAgIGNvbnN0IGFyZ0NodW5rcyA9IGdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyh7XG4gICAgLy8gVG8gZGlzYWJsZSAnRGlkU2hvd0NvbnRpbnVvdXNQYXRoSW50cm9kdWN0aW9uJyBmb3IgaU9TIDE1KyBzaW11bGF0b3JzIHNpbmNlIGNoYW5naW5nIHRoZSBwcmVmZXJlbmNlIHZpYSBXREFcbiAgICAvLyBkb2VzIG5vdCB3b3JrIG9uIHRoZW0uIExvd2VyIHRoYW4gdGhlIHZlcnNpb25zIGFsc28gY2FuIGhhdmUgdGhpcyBwcmVmZXJlbmNlLCBidXQgbm90aGluZyBoYXBwZW4uXG4gICAgICBEaWRTaG93Q29udGludW91c1BhdGhJbnRyb2R1Y3Rpb246IDFcbiAgICB9LCB0cnVlKTtcbiAgICBhd2FpdCBCLmFsbChhcmdDaHVua3MubWFwKChhcmdzKSA9PiB0aGlzLnNpbWN0bC5zcGF3blByb2Nlc3MoW1xuICAgICAgJ2RlZmF1bHRzJywgJ3dyaXRlJywgRE9NQUlOX0tFWUJPQVJEX1BSRUZFUkVOQ0VTLCAuLi5hcmdzXG4gICAgXSkpKTtcbiAgfVxuXG4gIC8qKipcbiAgICogQm9vdHMgc2ltdWxhdG9yIGFuZCBvcGVucyBzaW11bGF0b3JzIFVJIENsaWVudCBpZiBub3QgYWxyZWFkeSBvcGVuZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNVaUNsaWVudFJ1bm5pbmcgLSBwcm9jZXNzIGlkIG9mIHNpbXVsYXRvciBVSSBjbGllbnQuXG4gICAqIEBwYXJhbSB7UnVuT3B0aW9uc30gb3B0cyAtIGFyZ3VtZW50cyB0byBzdGFydCBzaW11bGF0b3IgVUkgY2xpZW50IHdpdGguXG4gICAqL1xuICBhc3luYyBsYXVuY2hXaW5kb3cgKGlzVWlDbGllbnRSdW5uaW5nLCBvcHRzID0ge30pIHtcbiAgICBhd2FpdCB0aGlzLmJvb3QoKTtcbiAgICBpZiAoIWlzVWlDbGllbnRSdW5uaW5nKSB7XG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0VUlDbGllbnQob3B0cyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEJvb3RzIFNpbXVsYXRvciBpZiBub3QgYWxyZWFkeSBib290ZWQuXG4gICAqIERvZXMgbm90aGluZyBpZiBpdCBpcyBhbHJlYWR5IHJ1bm5pbmcuXG4gICAqIFRoaXMgQVBJIGRvZXMgTk9UIHdhaXQgdW50aWwgU2ltdWxhdG9yIGlzIGZ1bGx5IGJvb3RlZC5cbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhIGZhaWx1cmUgd2hpbGUgYm9vdGluZyB0aGUgU2ltdWxhdG9yLlxuICAgKi9cbiAgYXN5bmMgYm9vdCAoKSB7XG4gICAgY29uc3QgYm9vdEV2ZW50c0VtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgYXdhaXQgdGhpcy5zaW1jdGwuc3RhcnRCb290TW9uaXRvcih7XG4gICAgICBvbkVycm9yOiAoZXJyKSA9PiBib290RXZlbnRzRW1pdHRlci5lbWl0KCdmYWlsdXJlJywgZXJyKSxcbiAgICAgIG9uRmluaXNoZWQ6ICgpID0+IGJvb3RFdmVudHNFbWl0dGVyLmVtaXQoJ2ZpbmlzaCcpLFxuICAgICAgc2hvdWxkUHJlYm9vdDogdHJ1ZSxcbiAgICB9KTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgbmV3IEIoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAvLyBIaXN0b3JpY2FsbHkgdGhpcyBjYWxsIHdhcyBhbHdheXMgYXN5bmNocm9ub3VzLFxuICAgICAgICAvLyBlLmcuIGl0IHdhcyBub3Qgd2FpdGluZyB1bnRpbCBTaW11bGF0b3IgaXMgZnVsbHkgYm9vdGVkLlxuICAgICAgICAvLyBTbyB3ZSBwcmVzZXJ2ZSB0aGF0IGJlaGF2aW9yLCBhbmQgaWYgbm8gZXJyb3JzIGFyZSByZWNlaXZlZCBmb3IgYSB3aGlsZVxuICAgICAgICAvLyB0aGVuIHdlIGFzc3VtZSB0aGUgU2ltdWxhdG9yIGJvb3RpbmcgaXMgc3RpbGwgaW4gcHJvZ3Jlc3MuXG4gICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgMzAwMCk7XG4gICAgICAgIGJvb3RFdmVudHNFbWl0dGVyLm9uY2UoJ2ZhaWx1cmUnLCAoZXJyKSA9PiB7XG4gICAgICAgICAgaWYgKF8uaW5jbHVkZXMoZXJyPy5tZXNzYWdlLCAnc3RhdGU6IEJvb3RlZCcpKSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJvb3RFdmVudHNFbWl0dGVyLm9uY2UoJ2ZpbmlzaCcsIHJlc29sdmUpO1xuICAgICAgfSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGJvb3RFdmVudHNFbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtIHZlcmlmaWNhdGlvbiBvZiBkZXZpY2UgcHJlZmVyZW5jZXMgY29ycmVjdG5lc3MuXG4gICAqXG4gICAqIEBwYXJhbSB7RGV2aWNlUHJlZmVyZW5jZXN9IHByZWZzIFt7fV0gLSBUaGUgcHJlZmVyZW5jZXMgdG8gYmUgdmVyaWZpZWRcbiAgICogQHRocm93cyB7RXJyb3J9IElmIGFueSBvZiB0aGUgZ2l2ZW4gcHJlZmVyZW5jZSB2YWx1ZXMgZG9lcyBub3QgbWF0Y2ggdGhlIGV4cGVjdGVkXG4gICAqIGZvcm1hdC5cbiAgICovXG4gIHZlcmlmeURldmljZVByZWZlcmVuY2VzIChwcmVmcyA9IHt9KSB7XG4gICAgaWYgKF8uaXNFbXB0eShwcmVmcykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIV8uaXNVbmRlZmluZWQocHJlZnMuU2ltdWxhdG9yV2luZG93TGFzdFNjYWxlKSkge1xuICAgICAgaWYgKCFfLmlzTnVtYmVyKHByZWZzLlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSkgfHwgcHJlZnMuU2ltdWxhdG9yV2luZG93TGFzdFNjYWxlIDw9IDApIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYFNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSBpcyBleHBlY3RlZCB0byBiZSBhIHBvc2l0aXZlIGZsb2F0IHZhbHVlLiBgICtcbiAgICAgICAgICBgJyR7cHJlZnMuU2ltdWxhdG9yV2luZG93TGFzdFNjYWxlfScgaXMgYXNzaWduZWQgaW5zdGVhZC5gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIV8uaXNVbmRlZmluZWQocHJlZnMuU2ltdWxhdG9yV2luZG93Q2VudGVyKSkge1xuICAgICAgLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci8yWlhPaWovMlxuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uUGF0dGVybiA9IC97LT9cXGQrKFxcLlxcZCspPywtP1xcZCsoXFwuXFxkKyk/fS87XG4gICAgICBpZiAoIV8uaXNTdHJpbmcocHJlZnMuU2ltdWxhdG9yV2luZG93Q2VudGVyKSB8fCAhdmVyaWZpY2F0aW9uUGF0dGVybi50ZXN0KHByZWZzLlNpbXVsYXRvcldpbmRvd0NlbnRlcikpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYFNpbXVsYXRvcldpbmRvd0NlbnRlciBpcyBleHBlY3RlZCB0byBtYXRjaCBcIntmbG9hdFhQb3NpdGlvbixmbG9hdFlQb3NpdGlvbn1cIiBmb3JtYXQgKHdpdGhvdXQgc3BhY2VzKS4gYCArXG4gICAgICAgICAgYCcke3ByZWZzLlNpbXVsYXRvcldpbmRvd0NlbnRlcn0nIGlzIGFzc2lnbmVkIGluc3RlYWQuYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHByZWZzLlNpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uKSkge1xuICAgICAgY29uc3QgYWNjZXB0YWJsZVZhbHVlcyA9IFsnUG9ydHJhaXQnLCAnTGFuZHNjYXBlTGVmdCcsICdQb3J0cmFpdFVwc2lkZURvd24nLCAnTGFuZHNjYXBlUmlnaHQnXTtcbiAgICAgIGlmIChhY2NlcHRhYmxlVmFsdWVzLmluZGV4T2YocHJlZnMuU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24pID09PSAtMSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24gaXMgZXhwZWN0ZWQgdG8gYmUgb25lIG9mICR7YWNjZXB0YWJsZVZhbHVlc30uIGAgK1xuICAgICAgICAgIGAnJHtwcmVmcy5TaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbn0nIGlzIGFzc2lnbmVkIGluc3RlYWQuYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHByZWZzLlNpbXVsYXRvcldpbmRvd1JvdGF0aW9uQW5nbGUpKSB7XG4gICAgICBpZiAoIV8uaXNOdW1iZXIocHJlZnMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSkpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYFNpbXVsYXRvcldpbmRvd1JvdGF0aW9uQW5nbGUgaXMgZXhwZWN0ZWQgdG8gYmUgYSB2YWxpZCBudW1iZXIuIGAgK1xuICAgICAgICAgIGAnJHtwcmVmcy5TaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlfScgaXMgYXNzaWduZWQgaW5zdGVhZC5gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBjb21tb24gaU9TIFNpbXVsYXRvciBwcmVmZXJlbmNlcyBmaWxlIHdpdGggbmV3IHZhbHVlcy5cbiAgICogSXQgaXMgbmVjZXNzYXJ5IHRvIHJlc3RhcnQgdGhlIGNvcnJlc3BvbmRpbmcgU2ltdWxhdG9yIGJlZm9yZVxuICAgKiB0aGVzZSBjaGFuZ2VzIGFyZSBhcHBsaWVkLlxuICAgKlxuICAgKiBAcGFyYW0ge0RldmljZVByZWZlcmVuY2VzfSBkZXZpY2VQcmVmcyBbe31dIC0gVGhlIG1hcHBpbmcsIHdoaWNoIHJlcHJlc2VudHMgbmV3IGRldmljZSBwcmVmZXJlbmNlIHZhbHVlc1xuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHRoZSBnaXZlbiBTaW11bGF0b3IuXG4gICAqIEBwYXJhbSB7Q29tbW9uUHJlZmVyZW5jZXN9IGNvbW1vblByZWZzIFt7fV0gLSBUaGUgbWFwcGluZywgd2hpY2ggcmVwcmVzZW50cyBuZXcgY29tbW9uIHByZWZlcmVuY2UgdmFsdWVzXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgYWxsIFNpbXVsYXRvcnMuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHByZWZlcmVuY2VzIHdlcmUgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuXG4gICAqL1xuICBhc3luYyB1cGRhdGVQcmVmZXJlbmNlcyAoZGV2aWNlUHJlZnMgPSB7fSwgY29tbW9uUHJlZnMgPSB7fSkge1xuICAgIGlmICghXy5pc0VtcHR5KGRldmljZVByZWZzKSkge1xuICAgICAgbG9nLmRlYnVnKGBTZXR0aW5nIHByZWZlcmVuY2VzIG9mICR7dGhpcy51ZGlkfSBTaW11bGF0b3IgdG8gJHtKU09OLnN0cmluZ2lmeShkZXZpY2VQcmVmcyl9YCk7XG4gICAgfVxuICAgIGlmICghXy5pc0VtcHR5KGNvbW1vblByZWZzKSkge1xuICAgICAgbG9nLmRlYnVnKGBTZXR0aW5nIGNvbW1vbiBTaW11bGF0b3IgcHJlZmVyZW5jZXMgdG8gJHtKU09OLnN0cmluZ2lmeShjb21tb25QcmVmcyl9YCk7XG4gICAgfVxuICAgIGNvbnN0IGhvbWVGb2xkZXJQYXRoID0gcHJvY2Vzcy5lbnYuSE9NRTtcbiAgICBpZiAoIWhvbWVGb2xkZXJQYXRoKSB7XG4gICAgICBsb2cud2FybihgQ2Fubm90IGdldCB0aGUgcGF0aCB0byBIT01FIGZvbGRlciBmcm9tIHRoZSBwcm9jZXNzIGVudmlyb25tZW50LiBgICtcbiAgICAgICAgYElnbm9yaW5nIFNpbXVsYXRvciBwcmVmZXJlbmNlcyB1cGRhdGUuYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMudmVyaWZ5RGV2aWNlUHJlZmVyZW5jZXMoZGV2aWNlUHJlZnMpO1xuICAgIGNvbnN0IHBsaXN0UGF0aCA9IHBhdGgucmVzb2x2ZShob21lRm9sZGVyUGF0aCwgJ0xpYnJhcnknLCAnUHJlZmVyZW5jZXMnLCAnY29tLmFwcGxlLmlwaG9uZXNpbXVsYXRvci5wbGlzdCcpO1xuICAgIHJldHVybiBhd2FpdCBwcmVmZXJlbmNlc1BsaXN0R3VhcmQuYWNxdWlyZShTaW11bGF0b3JYY29kZTkubmFtZSwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGVmYXVsdHMgPSBuZXcgTlNVc2VyRGVmYXVsdHMocGxpc3RQYXRoKTtcbiAgICAgIGNvbnN0IHByZWZzVG9VcGRhdGUgPSBfLmNsb25lKGNvbW1vblByZWZzKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghXy5pc0VtcHR5KGRldmljZVByZWZzKSkge1xuICAgICAgICAgIGxldCBleGlzdGluZ0RldmljZVByZWZzO1xuICAgICAgICAgIGNvbnN0IHVkaWRLZXkgPSB0aGlzLnVkaWQudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBpZiAoYXdhaXQgZnMuZXhpc3RzKHBsaXN0UGF0aCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQbGlzdENvbnRlbnQgPSBhd2FpdCBkZWZhdWx0cy5hc0pzb24oKTtcbiAgICAgICAgICAgIGlmIChfLmlzUGxhaW5PYmplY3QoY3VycmVudFBsaXN0Q29udGVudC5EZXZpY2VQcmVmZXJlbmNlcylcbiAgICAgICAgICAgICAgICAmJiBfLmlzUGxhaW5PYmplY3QoY3VycmVudFBsaXN0Q29udGVudC5EZXZpY2VQcmVmZXJlbmNlc1t1ZGlkS2V5XSkpIHtcbiAgICAgICAgICAgICAgZXhpc3RpbmdEZXZpY2VQcmVmcyA9IGN1cnJlbnRQbGlzdENvbnRlbnQuRGV2aWNlUHJlZmVyZW5jZXNbdWRpZEtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIE9iamVjdC5hc3NpZ24ocHJlZnNUb1VwZGF0ZSwge1xuICAgICAgICAgICAgRGV2aWNlUHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgICAgW3VkaWRLZXldOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZ0RldmljZVByZWZzIHx8IHt9LCBkZXZpY2VQcmVmcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBkZWZhdWx0cy51cGRhdGUocHJlZnNUb1VwZGF0ZSk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgVXBkYXRlZCAke3RoaXMudWRpZH0gU2ltdWxhdG9yIHByZWZlcmVuY2VzIGF0ICcke3BsaXN0UGF0aH0nIHdpdGggYCArXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkocHJlZnNUb1VwZGF0ZSkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLndhcm4oYENhbm5vdCB1cGRhdGUgJHt0aGlzLnVkaWR9IFNpbXVsYXRvciBwcmVmZXJlbmNlcyBhdCAnJHtwbGlzdFBhdGh9Jy4gYCArXG4gICAgICAgICAgYFRyeSB0byBkZWxldGUgdGhlIGZpbGUgbWFudWFsbHkgaW4gb3JkZXIgdG8gcmVzZXQgaXQuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IHRoZSBjdXJyZW50IFNpbXVsYXRvciB0byB0aGUgY2xlYW4gc3RhdGUuXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgYXN5bmMgY2xlYW4gKCkge1xuICAgIGxvZy5pbmZvKGBDbGVhbmluZyBzaW11bGF0b3IgJHt0aGlzLnVkaWR9YCk7XG4gICAgYXdhaXQgdGhpcy5zaW1jdGwuZXJhc2VEZXZpY2UoMTAwMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpbmhlcml0ZG9jXG4gICAqIEBvdmVycmlkZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYXN5bmMgX2FjdGl2YXRlV2luZG93ICgpIHtcbiAgICBsZXQgc2VsZk5hbWU7XG4gICAgbGV0IHNlbGZTZGs7XG4gICAgbGV0IGJvb3RlZERldmljZXNDb3VudCA9IDA7XG4gICAgZm9yIChjb25zdCBbc2RrLCBkZXZpY2VBcnJdIG9mIF8udG9QYWlycyhhd2FpdCB0aGlzLnNpbWN0bC5nZXREZXZpY2VzKCkpKSB7XG4gICAgICBmb3IgKGNvbnN0IHtzdGF0ZSwgdWRpZCwgbmFtZX0gb2YgZGV2aWNlQXJyKSB7XG4gICAgICAgIGlmIChzdGF0ZSA9PT0gJ0Jvb3RlZCcpIHtcbiAgICAgICAgICBib290ZWREZXZpY2VzQ291bnQrKztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGZOYW1lICYmIHVkaWQgPT09IHRoaXMudWRpZCkge1xuICAgICAgICAgIHNlbGZTZGsgPSBzZGs7XG4gICAgICAgICAgc2VsZk5hbWUgPSBuYW1lO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChib290ZWREZXZpY2VzQ291bnQgPCAyKSB7XG4gICAgICByZXR1cm4gYXdhaXQgc3VwZXIuX2FjdGl2YXRlV2luZG93KCk7XG4gICAgfVxuXG4gICAgLy8gVGhlcmUgYXJlIHBvdGVudGlhbGx5IG1vcmUgdGhhdCBvbmUgU2ltdWxhdG9yIHdpbmRvd1xuICAgIHJldHVybiBgXG4gICAgICB0ZWxsIGFwcGxpY2F0aW9uIFwiU3lzdGVtIEV2ZW50c1wiXG4gICAgICAgIHRlbGwgcHJvY2VzcyBcIlNpbXVsYXRvclwiXG4gICAgICAgICAgc2V0IGZyb250bW9zdCB0byBmYWxzZVxuICAgICAgICAgIHNldCBmcm9udG1vc3QgdG8gdHJ1ZVxuICAgICAgICAgIGNsaWNrIChtZW51IGl0ZW0gMSB3aGVyZSAoaXRzIG5hbWUgY29udGFpbnMgXCIke3NlbGZOYW1lfSBcIiBhbmQgaXRzIG5hbWUgY29udGFpbnMgXCIke3NlbGZTZGt9XCIpKSBvZiBtZW51IDEgb2YgbWVudSBiYXIgaXRlbSBcIldpbmRvd1wiIG9mIG1lbnUgYmFyIDFcbiAgICAgICAgZW5kIHRlbGxcbiAgICAgIGVuZCB0ZWxsXG4gICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaW5oZXJpdGRvY1xuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIGlzQmlvbWV0cmljRW5yb2xsZWQgKCkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICdub3RpZnl1dGlsJyxcbiAgICAgICctZycsIEVOUk9MTE1FTlRfTk9USUZJQ0FUSU9OX1JFQ0VJVkVSXG4gICAgXSk7XG4gICAgY29uc3QgbWF0Y2ggPSAobmV3IFJlZ0V4cChgJHtfLmVzY2FwZVJlZ0V4cChFTlJPTExNRU5UX05PVElGSUNBVElPTl9SRUNFSVZFUil9XFxcXHMrKFswMV0pYCkpXG4gICAgICAuZXhlYyhzdGRvdXQpO1xuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHBhcnNlIGJpb21ldHJpYyBlbnJvbGxtZW50IHN0YXRlIGZyb20gJyR7c3Rkb3V0fSdgKTtcbiAgICB9XG4gICAgbG9nLmluZm8oYEN1cnJlbnQgYmlvbWV0cmljIGVucm9sbGVkIHN0YXRlIGZvciAke3RoaXMudWRpZH0gU2ltdWxhdG9yOiAke21hdGNoWzFdfWApO1xuICAgIHJldHVybiBtYXRjaFsxXSA9PT0gJzEnO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpbmhlcml0ZG9jXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgYXN5bmMgZW5yb2xsQmlvbWV0cmljIChpc0VuYWJsZWQgPSB0cnVlKSB7XG4gICAgbG9nLmRlYnVnKGBTZXR0aW5nIGJpb21ldHJpYyBlbnJvbGxlZCBzdGF0ZSBmb3IgJHt0aGlzLnVkaWR9IFNpbXVsYXRvciB0byAnJHtpc0VuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfSdgKTtcbiAgICBhd2FpdCB0aGlzLnNpbWN0bC5zcGF3blByb2Nlc3MoW1xuICAgICAgJ25vdGlmeXV0aWwnLFxuICAgICAgJy1zJywgRU5ST0xMTUVOVF9OT1RJRklDQVRJT05fUkVDRUlWRVIsIGlzRW5hYmxlZCA/ICcxJyA6ICcwJ1xuICAgIF0pO1xuICAgIGF3YWl0IHRoaXMuc2ltY3RsLnNwYXduUHJvY2VzcyhbXG4gICAgICAnbm90aWZ5dXRpbCcsXG4gICAgICAnLXAnLCBFTlJPTExNRU5UX05PVElGSUNBVElPTl9SRUNFSVZFUlxuICAgIF0pO1xuICAgIGlmIChhd2FpdCB0aGlzLmlzQmlvbWV0cmljRW5yb2xsZWQoKSAhPT0gaXNFbmFibGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBzZXQgYmlvbWV0cmljIGVucm9sbGVkIHN0YXRlIGZvciAke3RoaXMudWRpZH0gU2ltdWxhdG9yIHRvICcke2lzRW5hYmxlZCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9J2ApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kcyBhIG5vdGlmaWNhdGlvbiB0byBtYXRjaC9ub3QgbWF0Y2ggdGhlIHBhcnRpY3VsYXIgYmlvbWV0cmljLlxuICAgKiBAb3ZlcnJpZGVcbiAgICpcbiAgICogQHBhcmFtIHs/Ym9vbGVhbn0gc2hvdWxkTWF0Y2ggW3RydWVdIC0gU2V0IGl0IHRvIHRydWUgb3IgZmFsc2UgaW4gb3JkZXIgdG8gZW11bGF0ZVxuICAgKiBtYXRjaGluZy9ub3QgbWF0Y2hpbmcgdGhlIGNvcnJlc3BvbmRpbmcgYmlvbWV0cmljXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gYmlvbWV0cmljTmFtZSBbdG91Y2hJZF0gLSBFaXRoZXIgdG91Y2hJZCBvciBmYWNlSWQgKGZhY2VJZCBpcyBvbmx5IGF2YWlsYWJsZSBzaW5jZSBpT1MgMTEpXG4gICAqL1xuICBhc3luYyBzZW5kQmlvbWV0cmljTWF0Y2ggKHNob3VsZE1hdGNoID0gdHJ1ZSwgYmlvbWV0cmljTmFtZSA9ICd0b3VjaElkJykge1xuICAgIGNvbnN0IGRvbWFpbkNvbXBvbmVudCA9IHRvQmlvbWV0cmljRG9tYWluQ29tcG9uZW50KGJpb21ldHJpY05hbWUpO1xuICAgIGNvbnN0IGRvbWFpbiA9IGBjb20uYXBwbGUuQmlvbWV0cmljS2l0X1NpbS4ke2RvbWFpbkNvbXBvbmVudH0uJHtzaG91bGRNYXRjaCA/ICcnIDogJ25vJ31tYXRjaGA7XG4gICAgYXdhaXQgdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICdub3RpZnl1dGlsJyxcbiAgICAgICctcCcsIGRvbWFpblxuICAgIF0pO1xuICAgIGxvZy5pbmZvKGBTZW50IG5vdGlmaWNhdGlvbiAke2RvbWFpbn0gdG8gJHtzaG91bGRNYXRjaCA/ICdtYXRjaCcgOiAnbm90IG1hdGNoJ30gJHtiaW9tZXRyaWNOYW1lfSBiaW9tZXRyaWMgYCArXG4gICAgICBgZm9yICR7dGhpcy51ZGlkfSBTaW11bGF0b3JgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIGdldExhdW5jaERhZW1vbnNSb290ICgpIHtcbiAgICBjb25zdCBkZXZSb290ID0gYXdhaXQgZ2V0RGV2ZWxvcGVyUm9vdCgpO1xuICAgIHJldHVybiBwYXRoLnJlc29sdmUoZGV2Um9vdCxcbiAgICAgICdQbGF0Zm9ybXMvaVBob25lT1MucGxhdGZvcm0vRGV2ZWxvcGVyL0xpYnJhcnkvQ29yZVNpbXVsYXRvci9Qcm9maWxlcy9SdW50aW1lcy9pT1Muc2ltcnVudGltZS9Db250ZW50cy9SZXNvdXJjZXMvUnVudGltZVJvb3QvU3lzdGVtL0xpYnJhcnkvTGF1bmNoRGFlbW9ucycpO1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IEtleWJvYXJkT3B0aW9uc1xuICAgKiBAcHJvcGVydHkgeyFzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGtleWJvYXJkIGxvY2FsZSwgZm9yIGV4YW1wbGUgYGVuX1VTYCBvciBgZGVfQ0hgXG4gICAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gbGF5b3V0IFRoZSBrZXlib2FyZCBsYXlvdXQsIGZvciBleGFtcGxlIGBRVUVSVFlgIG9yIGBVa3JhaW5pYW5gXG4gICAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gaGFyZHdhcmUgQ291bGQgZWl0aGVyIGJlIGBBdXRvbWF0aWNgIG9yIGBudWxsYFxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gTGFuZ3VhZ2VPcHRpb25zXG4gICAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgbGFuZ3VhZ2UsIGZvciBleGFtcGxlIGBkZWAgb3IgYHpoLUhhbnQtQ05gXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBMb2NhbGVPcHRpb25zXG4gICAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgc3lzdGVtIGxvY2FsZSwgZm9yIGV4YW1wbGUgYGRlX0NIYCBvciBgemhfQ05gXG4gICAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gY2FsZW5kYXIgT3B0aW9uYWwgY2FsZW5kYXIgZm9ybWF0LCBmb3IgZXhhbXBsZSBgZ3JlZ29yaWFuYCBvciBgcGVyc2lhbmBcbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IExvY2FsaXphdGlvbk9wdGlvbnNcbiAgICogQHByb3BlcnR5IHs/S2V5Ym9hcmRPcHRpb25zfSBrZXlib2FyZFxuICAgKiBAcHJvcGVydHkgez9MYW5ndWFnZU9wdGlvbnN9IGxhbmd1YWdlXG4gICAqIEBwcm9wZXJ0eSB7P0xvY2FsZU9wdGlvbnN9IGxvY2FsZVxuICAgKi9cblxuICAvKipcbiAgICogQ2hhbmdlIGxvY2FsaXphdGlvbiBzZXR0aW5ncyBvbiB0aGUgY3VycmVudGx5IGJvb3RlZCBzaW11bGF0b3JcbiAgICpcbiAgICogQHBhcmFtIHs/TG9jYWxpemF0aW9uT3B0aW9uc30gb3B0c1xuICAgKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgd2FzIGEgZmFpbHVyZSB3aGlsZSBzZXR0aW5nIHRoZSBwcmVmZXJlbmNlc1xuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gYHRydWVgIGlmIGFueSBvZiBzZXR0aW5ncyBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgY2hhbmdlZFxuICAgKi9cbiAgYXN5bmMgY29uZmlndXJlTG9jYWxpemF0aW9uIChvcHRzID0ge30pIHtcbiAgICBpZiAoXy5pc0VtcHR5KG9wdHMpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgeyBsYW5ndWFnZSwgbG9jYWxlLCBrZXlib2FyZCB9ID0gb3B0cztcbiAgICBjb25zdCBnbG9iYWxQcmVmcyA9IHt9O1xuICAgIGxldCBrZXlib2FyZElkID0gbnVsbDtcbiAgICBpZiAoXy5pc1BsYWluT2JqZWN0KGtleWJvYXJkKSkge1xuICAgICAgY29uc3QgeyBuYW1lLCBsYXlvdXQsIGhhcmR3YXJlIH0gPSBrZXlib2FyZDtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAna2V5Ym9hcmQnIGZpZWxkIG11c3QgaGF2ZSBhIHZhbGlkIG5hbWUgc2V0YCk7XG4gICAgICB9XG4gICAgICBpZiAoIWxheW91dCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAna2V5Ym9hcmQnIGZpZWxkIG11c3QgaGF2ZSBhIHZhbGlkIGxheW91dCBzZXRgKTtcbiAgICAgIH1cbiAgICAgIGtleWJvYXJkSWQgPSBgJHtuYW1lfUBzdz0ke2xheW91dH1gO1xuICAgICAgaWYgKGhhcmR3YXJlKSB7XG4gICAgICAgIGtleWJvYXJkSWQgKz0gYDtAaHc9JHtoYXJkd2FyZX1gO1xuICAgICAgfVxuICAgICAgZ2xvYmFsUHJlZnMuQXBwbGVLZXlib2FyZHMgPSBba2V5Ym9hcmRJZF07XG4gICAgfVxuICAgIGlmIChfLmlzUGxhaW5PYmplY3QobGFuZ3VhZ2UpKSB7XG4gICAgICBjb25zdCB7IG5hbWUgfSA9IGxhbmd1YWdlO1xuICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlICdsYW5ndWFnZScgZmllbGQgbXVzdCBoYXZlIGEgdmFsaWQgbmFtZSBzZXRgKTtcbiAgICAgIH1cbiAgICAgIGdsb2JhbFByZWZzLkFwcGxlTGFuZ3VhZ2VzID0gW25hbWVdO1xuICAgIH1cbiAgICBpZiAoXy5pc1BsYWluT2JqZWN0KGxvY2FsZSkpIHtcbiAgICAgIGNvbnN0IHsgbmFtZSwgY2FsZW5kYXIgfSA9IGxvY2FsZTtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAnbG9jYWxlJyBmaWVsZCBtdXN0IGhhdmUgYSB2YWxpZCBuYW1lIHNldGApO1xuICAgICAgfVxuICAgICAgbGV0IGxvY2FsZUlkID0gbmFtZTtcbiAgICAgIGlmIChjYWxlbmRhcikge1xuICAgICAgICBsb2NhbGVJZCArPSBgQGNhbGVuZGFyPSR7Y2FsZW5kYXJ9YDtcbiAgICAgIH1cbiAgICAgIGdsb2JhbFByZWZzLkFwcGxlTG9jYWxlID0gbG9jYWxlSWQ7XG4gICAgfVxuICAgIGlmIChfLmlzRW1wdHkoZ2xvYmFsUHJlZnMpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgYXJnQ2h1bmtzID0gZ2VuZXJhdGVEZWZhdWx0c0NvbW1hbmRBcmdzKGdsb2JhbFByZWZzLCB0cnVlKTtcbiAgICBhd2FpdCBCLmFsbChhcmdDaHVua3MubWFwKChhcmdzKSA9PiB0aGlzLnNpbWN0bC5zcGF3blByb2Nlc3MoW1xuICAgICAgJ2RlZmF1bHRzJywgJ3dyaXRlJywgJy5HbG9iYWxQcmVmZXJlbmNlcy5wbGlzdCcsIC4uLmFyZ3NcbiAgICBdKSkpO1xuXG4gICAgaWYgKGtleWJvYXJkSWQpIHtcbiAgICAgIGNvbnN0IGFyZ0NodW5rcyA9IGdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyh7XG4gICAgICAgIEtleWJvYXJkc0N1cnJlbnRBbmROZXh0OiBba2V5Ym9hcmRJZF0sXG4gICAgICAgIEtleWJvYXJkTGFzdFVzZWQ6IGtleWJvYXJkSWQsXG4gICAgICAgIEtleWJvYXJkTGFzdFVzZWRGb3JMYW5ndWFnZTogeyBba2V5Ym9hcmQubmFtZV06IGtleWJvYXJkSWQgfVxuICAgICAgfSwgdHJ1ZSk7XG4gICAgICBhd2FpdCBCLmFsbChhcmdDaHVua3MubWFwKChhcmdzKSA9PiB0aGlzLnNpbWN0bC5zcGF3blByb2Nlc3MoW1xuICAgICAgICAnZGVmYXVsdHMnLCAnd3JpdGUnLCAnY29tLmFwcGxlLlByZWZlcmVuY2VzJywgLi4uYXJnc1xuICAgICAgXSkpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaW5jZSBYY29kZSA5IFNpbXVsYXRvciBTYWZhcmkgaGFzIGJlZW4gbW92ZWQgdG8gYSBjb250YWluZXIsIGFuZCBpdHMgc2V0dGluZ3NcbiAgICogYXJlIG5vdCBiZWluZyBleHBvc2VkIGdsb2JhbGx5IGFueW1vcmUuXG4gICAqXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2FmYXJpR2xvYmFsU2V0dGluZ3MgKHVwZGF0ZXMpIHtcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZVNhZmFyaVNldHRpbmdzKHVwZGF0ZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSB1cGRhdGVzIEFuIG9iamVjdCBjb250YWluaW5nIFNhZmFyaSBzZXR0aW5ncyB0byBiZSB1cGRhdGVkLlxuICAgKiBUaGUgbGlzdCBvZiBhdmFpbGFibGUgc2V0dGluZyBuYW1lcyBhbmQgdGhlaXIgdmFsdWVzIGNvdWxkIGJlIHJldHJpdmVkIGJ5XG4gICAqIGNoYW5naW5nIHRoZSBjb3JyZXNwb25kaW5nIFNhZmFyaSBzZXR0aW5ncyBpbiB0aGUgVUkgYW5kIHRoZW4gaW5zcGVjdGluZ1xuICAgKiAnTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUubW9iaWxlc2FmYXJpLnBsaXN0JyBmaWxlIGluc2lkZSBvZlxuICAgKiBjb20uYXBwbGUubW9iaWxlc2FmYXJpIGFwcCBjb250YWluZXIuXG4gICAqIFRoZSBmdWxsIHBhdGggdG8gdGhlIE1vYmlsZSBTYWZhcmkncyBjb250YWluZXIgY291bGQgYmUgcmV0cmlldmVkIGZyb21cbiAgICogYHhjcnVuIHNpbWN0bCBnZXRfYXBwX2NvbnRhaW5lciA8c2ltX3VkaWQ+IGNvbS5hcHBsZS5tb2JpbGVzYWZhcmkgZGF0YWBcbiAgICogY29tbWFuZCBvdXRwdXQuXG4gICAqIFVzZSB0aGUgYHhjcnVuIHNpbWN0bCBzcGF3biA8c2ltX3VkaWQ+IGRlZmF1bHRzIHJlYWQgPHBhdGhfdG9fcGxpc3Q+YCBjb21tYW5kXG4gICAqIHRvIHByaW50IHRoZSBwbGlzdCBjb250ZW50IHRvIHRoZSBUZXJtaW5hbC5cbiAgICpcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBhc3luYyB1cGRhdGVTYWZhcmlTZXR0aW5ncyAodXBkYXRlcykge1xuICAgIGlmIChfLmlzRW1wdHkodXBkYXRlcykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBjb250YWluZXJSb290ID0gYXdhaXQgdGhpcy5zaW1jdGwuZ2V0QXBwQ29udGFpbmVyKE1PQklMRV9TQUZBUklfQlVORExFX0lELCAnZGF0YScpO1xuICAgIGNvbnN0IHBsaXN0UGF0aCA9IHBhdGguam9pbihjb250YWluZXJSb290LCAnTGlicmFyeScsICdQcmVmZXJlbmNlcycsICdjb20uYXBwbGUubW9iaWxlc2FmYXJpLnBsaXN0Jyk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZ3MocGxpc3RQYXRoLCB1cGRhdGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIHNldFJlZHVjZU1vdGlvbiAocmVkdWNlTW90aW9uID0gdHJ1ZSkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmdzKCdjb20uYXBwbGUuQWNjZXNzaWJpbGl0eScsIHtcbiAgICAgIFJlZHVjZU1vdGlvbkVuYWJsZWQ6IE51bWJlcihyZWR1Y2VNb3Rpb24pXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBhc3luYyBzZXRSZWR1Y2VUcmFuc3BhcmVuY3kgKHJlZHVjZVRyYW5zcGFyZW5jeSkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmdzKCdjb20uYXBwbGUuQWNjZXNzaWJpbGl0eScsIHtcbiAgICAgIEVuaGFuY2VkQmFja2dyb3VuZENvbnRyYXN0RW5hYmxlZDogTnVtYmVyKHJlZHVjZVRyYW5zcGFyZW5jeSlcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbGxvd3MgdG8gdXBkYXRlIFNpbXVsYXRvciBwcmVmZXJlbmNlcyBpbiBydW50aW1lLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZG9tYWluIFRoZSBuYW1lIG9mIHByZWZlcmVuY2VzIGRvbWFpbiB0byBiZSB1cGRhdGVkLFxuICAgKiBmb3IgZXhhbXBsZSwgJ2NvbS5hcHBsZS5QcmVmZXJlbmNlcycgb3IgJ2NvbS5hcHBsZS5BY2Nlc3NpYmlsaXR5JyBvclxuICAgKiBmdWxsIHBhdGggdG8gYSBwbGlzdCBmaWxlIG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbS5cbiAgICogQHBhcmFtIHtvYmplY3R9IHVwZGF0ZXMgTWFwcGluZyBvZiBrZXlzL3ZhbHVlcyB0byBiZSB1cGRhdGVkXG4gICAqXG4gICAqIEBvdmVycmlkZVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2V0dGluZ3MgKGRvbWFpbiwgdXBkYXRlcykge1xuICAgIGlmIChfLmlzRW1wdHkodXBkYXRlcykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoXy5rZXlzKFBMSVNUX0lERU5USUZJRVIpLmluY2x1ZGVzKGRvbWFpbikpIHtcbiAgICAgIC8vIFRPRE86IFRoaXMgaXMgdG8ga2VlcCB0aGUgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgICAgcmV0dXJuIGF3YWl0IHN1cGVyLnVwZGF0ZVNldHRpbmdzKGRvbWFpbiwgdXBkYXRlcyk7XG4gICAgfVxuXG4gICAgY29uc3QgYXJnQ2h1bmtzID0gZ2VuZXJhdGVEZWZhdWx0c0NvbW1hbmRBcmdzKHVwZGF0ZXMpO1xuICAgIGF3YWl0IEIuYWxsKGFyZ0NodW5rcy5tYXAoKGFyZ3MpID0+IHRoaXMuc2ltY3RsLnNwYXduUHJvY2VzcyhbXG4gICAgICAnZGVmYXVsdHMnLCAnd3JpdGUnLCBkb21haW4sIC4uLmFyZ3NcbiAgICBdKSkpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNpbXVsYXRvclhjb2RlOTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsTUFBTUEsMEJBQTBCLEdBQUcsRUFBRSxHQUFHLElBQUk7QUFDNUMsTUFBTUMsV0FBVyxHQUFHLElB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