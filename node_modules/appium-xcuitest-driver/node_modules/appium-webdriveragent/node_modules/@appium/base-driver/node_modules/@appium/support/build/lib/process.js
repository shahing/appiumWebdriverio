"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getProcessIds = getProcessIds;
exports.killProcess = killProcess;

require("source-map-support/register");

var _teen_process = require("teen_process");

async function getProcessIds(appName) {
  let pids;

  try {
    let {
      stdout
    } = await (0, _teen_process.exec)('pgrep', ['-x', appName]);
    pids = stdout.trim().split('\n').map(pid => parseInt(pid, 10));
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error getting process ids for app '${appName}': ${err.message}`);
    }

    pids = [];
  }

  return pids;
}

async function killProcess(appName, force = false) {
  let pids = await getProcessIds(appName);

  if (pids.length === 0) {
    return;
  }

  try {
    let args = force ? ['-9'] : [];
    args.push('-x', appName);
    await (0, _teen_process.exec)('pkill', args);
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error killing app '${appName}' with pkill: ${err.message}`);
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRQcm9jZXNzSWRzIiwiYXBwTmFtZSIsInBpZHMiLCJzdGRvdXQiLCJleGVjIiwidHJpbSIsInNwbGl0IiwibWFwIiwicGlkIiwicGFyc2VJbnQiLCJlcnIiLCJjb2RlIiwiRXJyb3IiLCJtZXNzYWdlIiwia2lsbFByb2Nlc3MiLCJmb3JjZSIsImxlbmd0aCIsImFyZ3MiLCJwdXNoIl0sInNvdXJjZXMiOlsiLi4vLi4vbGliL3Byb2Nlc3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtleGVjfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuXG4vKlxuICogRXhpdCBTdGF0dXMgZm9yIHBncmVwIGFuZCBwa2lsbCAoYG1hbiBwa2lsbGApXG4gKiAgMC4gT25lIG9yIG1vcmUgcHJvY2Vzc2VzIG1hdGNoZWQgdGhlIGNyaXRlcmlhLlxuICogIDEuIE5vIHByb2Nlc3NlcyBtYXRjaGVkLlxuICogIDIuIFN5bnRheCBlcnJvciBpbiB0aGUgY29tbWFuZCBsaW5lLlxuICogIDMuIEZhdGFsIGVycm9yOiBvdXQgb2YgbWVtb3J5IGV0Yy5cbiAqL1xuXG5hc3luYyBmdW5jdGlvbiBnZXRQcm9jZXNzSWRzKGFwcE5hbWUpIHtcbiAgbGV0IHBpZHM7XG4gIHRyeSB7XG4gICAgbGV0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygncGdyZXAnLCBbJy14JywgYXBwTmFtZV0pO1xuICAgIHBpZHMgPSBzdGRvdXRcbiAgICAgIC50cmltKClcbiAgICAgIC5zcGxpdCgnXFxuJylcbiAgICAgIC5tYXAoKHBpZCkgPT4gcGFyc2VJbnQocGlkLCAxMCkpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAocGFyc2VJbnQoZXJyLmNvZGUsIDEwKSAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIHByb2Nlc3MgaWRzIGZvciBhcHAgJyR7YXBwTmFtZX0nOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBwaWRzID0gW107XG4gIH1cbiAgcmV0dXJuIHBpZHM7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGtpbGxQcm9jZXNzKGFwcE5hbWUsIGZvcmNlID0gZmFsc2UpIHtcbiAgbGV0IHBpZHMgPSBhd2FpdCBnZXRQcm9jZXNzSWRzKGFwcE5hbWUpO1xuICBpZiAocGlkcy5sZW5ndGggPT09IDApIHtcbiAgICAvLyB0aGUgcHJvY2VzcyBpcyBub3QgcnVubmluZ1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRyeSB7XG4gICAgbGV0IGFyZ3MgPSBmb3JjZSA/IFsnLTknXSA6IFtdO1xuICAgIGFyZ3MucHVzaCgnLXgnLCBhcHBOYW1lKTtcbiAgICBhd2FpdCBleGVjKCdwa2lsbCcsIGFyZ3MpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAocGFyc2VJbnQoZXJyLmNvZGUsIDEwKSAhPT0gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBraWxsaW5nIGFwcCAnJHthcHBOYW1lfScgd2l0aCBwa2lsbDogJHtlcnIubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IHtnZXRQcm9jZXNzSWRzLCBraWxsUHJvY2Vzc307XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7QUFVQSxlQUFlQSxhQUFmLENBQTZCQyxPQUE3QixFQUFzQztFQUNwQyxJQUFJQyxJQUFKOztFQUNBLElBQUk7SUFDRixJQUFJO01BQUNDO0lBQUQsSUFBVyxNQUFNLElBQUFDLGtCQUFBLEVBQUssT0FBTCxFQUFjLENBQUMsSUFBRCxFQUFPSCxPQUFQLENBQWQsQ0FBckI7SUFDQUMsSUFBSSxHQUFHQyxNQUFNLENBQ1ZFLElBREksR0FFSkMsS0FGSSxDQUVFLElBRkYsRUFHSkMsR0FISSxDQUdDQyxHQUFELElBQVNDLFFBQVEsQ0FBQ0QsR0FBRCxFQUFNLEVBQU4sQ0FIakIsQ0FBUDtFQUlELENBTkQsQ0FNRSxPQUFPRSxHQUFQLEVBQVk7SUFDWixJQUFJRCxRQUFRLENBQUNDLEdBQUcsQ0FBQ0MsSUFBTCxFQUFXLEVBQVgsQ0FBUixLQUEyQixDQUEvQixFQUFrQztNQUNoQyxNQUFNLElBQUlDLEtBQUosQ0FBVyxzQ0FBcUNYLE9BQVEsTUFBS1MsR0FBRyxDQUFDRyxPQUFRLEVBQXpFLENBQU47SUFDRDs7SUFDRFgsSUFBSSxHQUFHLEVBQVA7RUFDRDs7RUFDRCxPQUFPQSxJQUFQO0FBQ0Q7O0FBRUQsZUFBZVksV0FBZixDQUEyQmIsT0FBM0IsRUFBb0NjLEtBQUssR0FBRyxLQUE1QyxFQUFtRDtFQUNqRCxJQUFJYixJQUFJLEdBQUcsTUFBTUYsYUFBYSxDQUFDQyxPQUFELENBQTlCOztFQUNBLElBQUlDLElBQUksQ0FBQ2MsTUFBTCxLQUFnQixDQUFwQixFQUF1QjtJQUVyQjtFQUNEOztFQUVELElBQUk7SUFDRixJQUFJQyxJQUFJLEdBQUdGLEtBQUssR0FBRyxDQUFDLElBQUQsQ0FBSCxHQUFZLEVBQTVCO0lBQ0FFLElBQUksQ0FBQ0MsSUFBTCxDQUFVLElBQVYsRUFBZ0JqQixPQUFoQjtJQUNBLE1BQU0sSUFBQUcsa0JBQUEsRUFBSyxPQUFMLEVBQWNhLElBQWQsQ0FBTjtFQUNELENBSkQsQ0FJRSxPQUFPUCxHQUFQLEVBQVk7SUFDWixJQUFJRCxRQUFRLENBQUNDLEdBQUcsQ0FBQ0MsSUFBTCxFQUFXLEVBQVgsQ0FBUixLQUEyQixDQUEvQixFQUFrQztNQUNoQyxNQUFNLElBQUlDLEtBQUosQ0FBVyxzQkFBcUJYLE9BQVEsaUJBQWdCUyxHQUFHLENBQUNHLE9BQVEsRUFBcEUsQ0FBTjtJQUNEO0VBQ0Y7QUFDRiJ9