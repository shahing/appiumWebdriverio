{"version":3,"file":"process.js","names":["getProcessIds","appName","pids","stdout","exec","trim","split","map","pid","parseInt","err","code","Error","message","killProcess","force","length","args","push"],"sources":["../../lib/process.js"],"sourcesContent":["import {exec} from 'teen_process';\n\n/*\n * Exit Status for pgrep and pkill (`man pkill`)\n *  0. One or more processes matched the criteria.\n *  1. No processes matched.\n *  2. Syntax error in the command line.\n *  3. Fatal error: out of memory etc.\n */\n\nasync function getProcessIds(appName) {\n  let pids;\n  try {\n    let {stdout} = await exec('pgrep', ['-x', appName]);\n    pids = stdout\n      .trim()\n      .split('\\n')\n      .map((pid) => parseInt(pid, 10));\n  } catch (err) {\n    if (parseInt(err.code, 10) !== 1) {\n      throw new Error(`Error getting process ids for app '${appName}': ${err.message}`);\n    }\n    pids = [];\n  }\n  return pids;\n}\n\nasync function killProcess(appName, force = false) {\n  let pids = await getProcessIds(appName);\n  if (pids.length === 0) {\n    // the process is not running\n    return;\n  }\n\n  try {\n    let args = force ? ['-9'] : [];\n    args.push('-x', appName);\n    await exec('pkill', args);\n  } catch (err) {\n    if (parseInt(err.code, 10) !== 1) {\n      throw new Error(`Error killing app '${appName}' with pkill: ${err.message}`);\n    }\n  }\n}\n\nexport {getProcessIds, killProcess};\n"],"mappings":";;;;;;;;;;AAAA;;AAUA,eAAeA,aAAf,CAA6BC,OAA7B,EAAsC;EACpC,IAAIC,IAAJ;;EACA,IAAI;IACF,IAAI;MAACC;IAAD,IAAW,MAAM,IAAAC,kBAAA,EAAK,OAAL,EAAc,CAAC,IAAD,EAAOH,OAAP,CAAd,CAArB;IACAC,IAAI,GAAGC,MAAM,CACVE,IADI,GAEJC,KAFI,CAEE,IAFF,EAGJC,GAHI,CAGCC,GAAD,IAASC,QAAQ,CAACD,GAAD,EAAM,EAAN,CAHjB,CAAP;EAID,CAND,CAME,OAAOE,GAAP,EAAY;IACZ,IAAID,QAAQ,CAACC,GAAG,CAACC,IAAL,EAAW,EAAX,CAAR,KAA2B,CAA/B,EAAkC;MAChC,MAAM,IAAIC,KAAJ,CAAW,sCAAqCX,OAAQ,MAAKS,GAAG,CAACG,OAAQ,EAAzE,CAAN;IACD;;IACDX,IAAI,GAAG,EAAP;EACD;;EACD,OAAOA,IAAP;AACD;;AAED,eAAeY,WAAf,CAA2Bb,OAA3B,EAAoCc,KAAK,GAAG,KAA5C,EAAmD;EACjD,IAAIb,IAAI,GAAG,MAAMF,aAAa,CAACC,OAAD,CAA9B;;EACA,IAAIC,IAAI,CAACc,MAAL,KAAgB,CAApB,EAAuB;IAErB;EACD;;EAED,IAAI;IACF,IAAIC,IAAI,GAAGF,KAAK,GAAG,CAAC,IAAD,CAAH,GAAY,EAA5B;IACAE,IAAI,CAACC,IAAL,CAAU,IAAV,EAAgBjB,OAAhB;IACA,MAAM,IAAAG,kBAAA,EAAK,OAAL,EAAca,IAAd,CAAN;EACD,CAJD,CAIE,OAAOP,GAAP,EAAY;IACZ,IAAID,QAAQ,CAACC,GAAG,CAACC,IAAL,EAAW,EAAX,CAAR,KAA2B,CAA/B,EAAkC;MAChC,MAAM,IAAIC,KAAJ,CAAW,sBAAqBX,OAAQ,iBAAgBS,GAAG,CAACG,OAAQ,EAApE,CAAN;IACD;EACF;AACF"}