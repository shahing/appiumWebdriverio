"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _lodash = _interopRequireDefault(require("lodash"));
var _support = require("appium/support");
var _driver = require("appium/driver");
var _appiumIosDevice = require("appium-ios-device");
const commands = {};
function requireOptions(opts = {}, reqKeys = []) {
  for (const key of reqKeys) {
    if (!_lodash.default.isString(opts[key]) || _lodash.default.isEmpty(opts[key])) {
      throw new _driver.errors.InvalidArgumentError(`'${key}' is expected to be a valid string. '${opts[key]}' is given instead`);
    }
  }
  return opts;
}
commands.mobileInstallApp = async function mobileInstallApp(opts = {}) {
  const {
    app,
    timeoutMs,
    strategy
  } = requireOptions(opts, ['app']);
  const srcAppPath = await this.helpers.configureApp(app, '.app');
  this.log.info(`Installing '${srcAppPath}' to the ${this.isRealDevice() ? 'real device' : 'Simulator'} ` + `with UDID '${this.opts.device.udid}'`);
  if (!(await _support.fs.exists(srcAppPath))) {
    this.log.errorAndThrow(`The application at '${srcAppPath}' does not exist or is not accessible`);
  }
  await this.opts.device.installApp(srcAppPath, timeoutMs ?? this.opts.appPushTimeout, strategy ?? this.opts.appInstallStrategy);
  this.log.info(`Installation of '${srcAppPath}' succeeded`);
};
commands.mobileIsAppInstalled = async function mobileIsAppInstalled(opts = {}) {
  const {
    bundleId
  } = requireOptions(opts, ['bundleId']);
  const installed = await this.opts.device.isAppInstalled(bundleId);
  this.log.info(`App '${bundleId}' is${installed ? '' : ' not'} installed`);
  return installed;
};
commands.mobileRemoveApp = async function mobileRemoveApp(opts = {}) {
  const {
    bundleId
  } = requireOptions(opts, ['bundleId']);
  this.log.info(`Uninstalling the application with bundle identifier '${bundleId}' ` + `from the ${this.isRealDevice() ? 'real device' : 'Simulator'} with UDID '${this.opts.device.udid}'`);
  try {
    await this.opts.device.removeApp(bundleId);
    this.log.info(`Removal of '${bundleId}' succeeded`);
    return true;
  } catch (err) {
    this.log.warn(`Cannot remove '${bundleId}'. Original error: ${err.message}`);
    return false;
  }
};
commands.mobileLaunchApp = async function mobileLaunchApp(opts = {}) {
  const launchOptions = requireOptions(opts, ['bundleId']);
  if (opts.arguments) {
    launchOptions.arguments = _lodash.default.isArray(opts.arguments) ? opts.arguments : [opts.arguments];
  }
  if (opts.environment) {
    launchOptions.environment = opts.environment;
  }
  return await this.proxyCommand('/wda/apps/launch', 'POST', launchOptions);
};
commands.mobileTerminateApp = async function mobileTerminateApp(opts = {}) {
  return await this.proxyCommand('/wda/apps/terminate', 'POST', requireOptions(opts, ['bundleId']));
};
commands.mobileActivateApp = async function mobileActivateApp(opts = {}) {
  return await this.proxyCommand('/wda/apps/activate', 'POST', requireOptions(opts, ['bundleId']));
};
commands.mobileKillApp = async function mobileKillApp(opts = {}) {
  if (!this.isRealDevice()) {
    throw new _driver.errors.UnsupportedOperationError('A real device is required');
  }
  const {
    bundleId
  } = requireOptions(opts, ['bundleId']);
  return await this.opts.device.terminateApp(bundleId);
};
commands.mobileQueryAppState = async function mobileQueryAppState(opts = {}) {
  return await this.proxyCommand('/wda/apps/state', 'POST', requireOptions(opts, ['bundleId']));
};
commands.installApp = async function installApp(appPath, opts = {}) {
  await this.mobileInstallApp({
    ...(_lodash.default.isPlainObject(opts) ? opts : {}),
    app: appPath
  });
};
commands.activateApp = async function activateApp(bundleId, opts = {}) {
  return await this.mobileLaunchApp(Object.assign({}, opts, {
    bundleId
  }));
};
commands.isAppInstalled = async function isAppInstalled(bundleId) {
  return await this.mobileIsAppInstalled({
    bundleId
  });
};
commands.terminateApp = async function terminateApp(bundleId) {
  return await this.mobileTerminateApp({
    bundleId
  });
};
commands.queryAppState = async function queryAppState(bundleId) {
  return await this.mobileQueryAppState({
    bundleId
  });
};
commands.mobileListApps = async function mobileListApps(opts = {}) {
  if (!this.isRealDevice()) {
    throw new _driver.errors.NotImplementedError(`This extension is only supported on real devices`);
  }
  const {
    applicationType = 'User'
  } = opts;
  const service = await _appiumIosDevice.services.startInstallationProxyService(this.opts.device.udid);
  try {
    return await service.listApplications({
      applicationType
    });
  } finally {
    service.close();
  }
};
var _default = commands;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb21tYW5kcyIsInJlcXVpcmVPcHRpb25zIiwib3B0cyIsInJlcUtleXMiLCJrZXkiLCJfIiwiaXNTdHJpbmciLCJpc0VtcHR5IiwiZXJyb3JzIiwiSW52YWxpZEFyZ3VtZW50RXJyb3IiLCJtb2JpbGVJbnN0YWxsQXBwIiwiYXBwIiwidGltZW91dE1zIiwic3RyYXRlZ3kiLCJzcmNBcHBQYXRoIiwiaGVscGVycyIsImNvbmZpZ3VyZUFwcCIsImxvZyIsImluZm8iLCJpc1JlYWxEZXZpY2UiLCJkZXZpY2UiLCJ1ZGlkIiwiZnMiLCJleGlzdHMiLCJlcnJvckFuZFRocm93IiwiaW5zdGFsbEFwcCIsImFwcFB1c2hUaW1lb3V0IiwiYXBwSW5zdGFsbFN0cmF0ZWd5IiwibW9iaWxlSXNBcHBJbnN0YWxsZWQiLCJidW5kbGVJZCIsImluc3RhbGxlZCIsImlzQXBwSW5zdGFsbGVkIiwibW9iaWxlUmVtb3ZlQXBwIiwicmVtb3ZlQXBwIiwiZXJyIiwid2FybiIsIm1lc3NhZ2UiLCJtb2JpbGVMYXVuY2hBcHAiLCJsYXVuY2hPcHRpb25zIiwiYXJndW1lbnRzIiwiaXNBcnJheSIsImVudmlyb25tZW50IiwicHJveHlDb21tYW5kIiwibW9iaWxlVGVybWluYXRlQXBwIiwibW9iaWxlQWN0aXZhdGVBcHAiLCJtb2JpbGVLaWxsQXBwIiwiVW5zdXBwb3J0ZWRPcGVyYXRpb25FcnJvciIsInRlcm1pbmF0ZUFwcCIsIm1vYmlsZVF1ZXJ5QXBwU3RhdGUiLCJhcHBQYXRoIiwiaXNQbGFpbk9iamVjdCIsImFjdGl2YXRlQXBwIiwiT2JqZWN0IiwiYXNzaWduIiwicXVlcnlBcHBTdGF0ZSIsIm1vYmlsZUxpc3RBcHBzIiwiTm90SW1wbGVtZW50ZWRFcnJvciIsImFwcGxpY2F0aW9uVHlwZSIsInNlcnZpY2UiLCJzZXJ2aWNlcyIsInN0YXJ0SW5zdGFsbGF0aW9uUHJveHlTZXJ2aWNlIiwibGlzdEFwcGxpY2F0aW9ucyIsImNsb3NlIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL2NvbW1hbmRzL2FwcC1tYW5hZ2VtZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBmcyB9IGZyb20gJ2FwcGl1bS9zdXBwb3J0JztcbmltcG9ydCB7IGVycm9ycyB9IGZyb20gJ2FwcGl1bS9kcml2ZXInO1xuaW1wb3J0IHsgc2VydmljZXMgfSBmcm9tICdhcHBpdW0taW9zLWRldmljZSc7XG5cbmNvbnN0IGNvbW1hbmRzID0ge307XG5cbmZ1bmN0aW9uIHJlcXVpcmVPcHRpb25zIChvcHRzID0ge30sIHJlcUtleXMgPSBbXSkge1xuICBmb3IgKGNvbnN0IGtleSBvZiByZXFLZXlzKSB7XG4gICAgaWYgKCFfLmlzU3RyaW5nKG9wdHNba2V5XSkgfHwgXy5pc0VtcHR5KG9wdHNba2V5XSkpIHtcbiAgICAgIHRocm93IG5ldyBlcnJvcnMuSW52YWxpZEFyZ3VtZW50RXJyb3IoXG4gICAgICAgIGAnJHtrZXl9JyBpcyBleHBlY3RlZCB0byBiZSBhIHZhbGlkIHN0cmluZy4gJyR7b3B0c1trZXldfScgaXMgZ2l2ZW4gaW5zdGVhZGBcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvcHRzO1xufVxuXG5jb21tYW5kcy5tb2JpbGVJbnN0YWxsQXBwID0gYXN5bmMgZnVuY3Rpb24gbW9iaWxlSW5zdGFsbEFwcCAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHsgYXBwLCB0aW1lb3V0TXMsIHN0cmF0ZWd5IH0gPSByZXF1aXJlT3B0aW9ucyhvcHRzLCBbJ2FwcCddKTtcbiAgY29uc3Qgc3JjQXBwUGF0aCA9IGF3YWl0IHRoaXMuaGVscGVycy5jb25maWd1cmVBcHAoYXBwLCAnLmFwcCcpO1xuICB0aGlzLmxvZy5pbmZvKGBJbnN0YWxsaW5nICcke3NyY0FwcFBhdGh9JyB0byB0aGUgJHt0aGlzLmlzUmVhbERldmljZSgpID8gJ3JlYWwgZGV2aWNlJyA6ICdTaW11bGF0b3InfSBgICtcbiAgICBgd2l0aCBVRElEICcke3RoaXMub3B0cy5kZXZpY2UudWRpZH0nYCk7XG4gIGlmICghYXdhaXQgZnMuZXhpc3RzKHNyY0FwcFBhdGgpKSB7XG4gICAgdGhpcy5sb2cuZXJyb3JBbmRUaHJvdyhgVGhlIGFwcGxpY2F0aW9uIGF0ICcke3NyY0FwcFBhdGh9JyBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYWNjZXNzaWJsZWApO1xuICB9XG4gIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UuaW5zdGFsbEFwcChcbiAgICBzcmNBcHBQYXRoLCB0aW1lb3V0TXMgPz8gdGhpcy5vcHRzLmFwcFB1c2hUaW1lb3V0LCBzdHJhdGVneSA/PyB0aGlzLm9wdHMuYXBwSW5zdGFsbFN0cmF0ZWd5XG4gICk7XG4gIHRoaXMubG9nLmluZm8oYEluc3RhbGxhdGlvbiBvZiAnJHtzcmNBcHBQYXRofScgc3VjY2VlZGVkYCk7XG59O1xuXG5jb21tYW5kcy5tb2JpbGVJc0FwcEluc3RhbGxlZCA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZUlzQXBwSW5zdGFsbGVkIChvcHRzID0ge30pIHtcbiAgY29uc3Qge2J1bmRsZUlkfSA9IHJlcXVpcmVPcHRpb25zKG9wdHMsIFsnYnVuZGxlSWQnXSk7XG4gIGNvbnN0IGluc3RhbGxlZCA9IGF3YWl0IHRoaXMub3B0cy5kZXZpY2UuaXNBcHBJbnN0YWxsZWQoYnVuZGxlSWQpO1xuICB0aGlzLmxvZy5pbmZvKGBBcHAgJyR7YnVuZGxlSWR9JyBpcyR7aW5zdGFsbGVkID8gJycgOiAnIG5vdCd9IGluc3RhbGxlZGApO1xuICByZXR1cm4gaW5zdGFsbGVkO1xufTtcblxuY29tbWFuZHMubW9iaWxlUmVtb3ZlQXBwID0gYXN5bmMgZnVuY3Rpb24gbW9iaWxlUmVtb3ZlQXBwIChvcHRzID0ge30pIHtcbiAgY29uc3Qge2J1bmRsZUlkfSA9IHJlcXVpcmVPcHRpb25zKG9wdHMsIFsnYnVuZGxlSWQnXSk7XG4gIHRoaXMubG9nLmluZm8oYFVuaW5zdGFsbGluZyB0aGUgYXBwbGljYXRpb24gd2l0aCBidW5kbGUgaWRlbnRpZmllciAnJHtidW5kbGVJZH0nIGAgK1xuICAgIGBmcm9tIHRoZSAke3RoaXMuaXNSZWFsRGV2aWNlKCkgPyAncmVhbCBkZXZpY2UnIDogJ1NpbXVsYXRvcid9IHdpdGggVURJRCAnJHt0aGlzLm9wdHMuZGV2aWNlLnVkaWR9J2ApO1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UucmVtb3ZlQXBwKGJ1bmRsZUlkKTtcbiAgICB0aGlzLmxvZy5pbmZvKGBSZW1vdmFsIG9mICcke2J1bmRsZUlkfScgc3VjY2VlZGVkYCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRoaXMubG9nLndhcm4oYENhbm5vdCByZW1vdmUgJyR7YnVuZGxlSWR9Jy4gT3JpZ2luYWwgZXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5jb21tYW5kcy5tb2JpbGVMYXVuY2hBcHAgPSBhc3luYyBmdW5jdGlvbiBtb2JpbGVMYXVuY2hBcHAgKG9wdHMgPSB7fSkge1xuICBjb25zdCBsYXVuY2hPcHRpb25zID0gcmVxdWlyZU9wdGlvbnMob3B0cywgWydidW5kbGVJZCddKTtcbiAgaWYgKG9wdHMuYXJndW1lbnRzKSB7XG4gICAgbGF1bmNoT3B0aW9ucy5hcmd1bWVudHMgPSBfLmlzQXJyYXkob3B0cy5hcmd1bWVudHMpID8gb3B0cy5hcmd1bWVudHMgOiBbb3B0cy5hcmd1bWVudHNdO1xuICB9XG4gIGlmIChvcHRzLmVudmlyb25tZW50KSB7XG4gICAgbGF1bmNoT3B0aW9ucy5lbnZpcm9ubWVudCA9IG9wdHMuZW52aXJvbm1lbnQ7XG4gIH1cbiAgcmV0dXJuIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvd2RhL2FwcHMvbGF1bmNoJywgJ1BPU1QnLCBsYXVuY2hPcHRpb25zKTtcbn07XG5cbmNvbW1hbmRzLm1vYmlsZVRlcm1pbmF0ZUFwcCA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZVRlcm1pbmF0ZUFwcCAob3B0cyA9IHt9KSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZCgnL3dkYS9hcHBzL3Rlcm1pbmF0ZScsICdQT1NUJywgcmVxdWlyZU9wdGlvbnMob3B0cywgWydidW5kbGVJZCddKSk7XG59O1xuXG5jb21tYW5kcy5tb2JpbGVBY3RpdmF0ZUFwcCA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZUFjdGl2YXRlQXBwIChvcHRzID0ge30pIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvd2RhL2FwcHMvYWN0aXZhdGUnLCAnUE9TVCcsIHJlcXVpcmVPcHRpb25zKG9wdHMsIFsnYnVuZGxlSWQnXSkpO1xufTtcblxuLyoqXG4gKiBLaWxsIHRoZSBnaXZlbiBidW5kbGUgaWQgcHJvY2VzcyB2aWEgaW5zdHJ1bWVudHMgc2VydmljZS5cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ZdWVDaGVuLUMvcHktaW9zLWRldmljZS9ibG9iLzUxZjQ2ODNjNWMzYzM4NWEwMTU4NThhZGEwN2E1ZjFjNjJkM2NmNTcvaW9zX2RldmljZS9jbGkvYmFzZS5weSNMMjIwXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBPcHRpb25zIHNldCwgd2hpY2ggbXVzdCBjb250YWluIGBidW5kbGVJZGAgcHJvcGVydHlcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgaWYgdGhlIGJ1bmRsZSBpZCBwcm9jZXNzIHdhcyBraWxsZWQuIE90aGVyd2lzZSBmYWxzZS5cbiAqL1xuY29tbWFuZHMubW9iaWxlS2lsbEFwcCA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZUtpbGxBcHAgKG9wdHMgPSB7fSkge1xuICBpZiAoIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVuc3VwcG9ydGVkT3BlcmF0aW9uRXJyb3IoJ0EgcmVhbCBkZXZpY2UgaXMgcmVxdWlyZWQnKTtcbiAgfVxuXG4gIGNvbnN0IHtidW5kbGVJZH0gPSByZXF1aXJlT3B0aW9ucyhvcHRzLCBbJ2J1bmRsZUlkJ10pO1xuICByZXR1cm4gYXdhaXQgdGhpcy5vcHRzLmRldmljZS50ZXJtaW5hdGVBcHAoYnVuZGxlSWQpO1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIHN0YXRlXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBPcHRpb25zIHNldCwgd2hpY2ggbXVzdCBjb250YWluIGBidW5kbGVJZGAgcHJvcGVydHlcbiAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBhY3R1YWwgYXBwbGljYXRpb24gc3RhdGUgY29kZS4gU2VlXG4gKiBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vZG9jdW1lbnRhdGlvbi94Y3Rlc3QveGN1aWFwcGxpY2F0aW9uc3RhdGU/bGFuZ3VhZ2U9b2JqY1xuICogdG8gZ2V0IHRoZSBsaXN0IG9mIHBvc3NpYmxlIHZhbHVlcy5cbiAqL1xuY29tbWFuZHMubW9iaWxlUXVlcnlBcHBTdGF0ZSA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZVF1ZXJ5QXBwU3RhdGUgKG9wdHMgPSB7fSkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy93ZGEvYXBwcy9zdGF0ZScsICdQT1NUJywgcmVxdWlyZU9wdGlvbnMob3B0cywgWydidW5kbGVJZCddKSk7XG59O1xuXG5jb21tYW5kcy5pbnN0YWxsQXBwID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbEFwcCAoYXBwUGF0aCwgb3B0cyA9IHt9KSB7XG4gIGF3YWl0IHRoaXMubW9iaWxlSW5zdGFsbEFwcCh7XG4gICAgLi4uKF8uaXNQbGFpbk9iamVjdChvcHRzKSA/IG9wdHMgOiB7fSksXG4gICAgYXBwOiBhcHBQYXRoLFxuICB9KTtcbn07XG5cbmNvbW1hbmRzLmFjdGl2YXRlQXBwID0gYXN5bmMgZnVuY3Rpb24gYWN0aXZhdGVBcHAgKGJ1bmRsZUlkLCBvcHRzID0ge30pIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMubW9iaWxlTGF1bmNoQXBwKE9iamVjdC5hc3NpZ24oe30sIG9wdHMsIHtidW5kbGVJZH0pKTtcbn07XG5cbmNvbW1hbmRzLmlzQXBwSW5zdGFsbGVkID0gYXN5bmMgZnVuY3Rpb24gaXNBcHBJbnN0YWxsZWQgKGJ1bmRsZUlkKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLm1vYmlsZUlzQXBwSW5zdGFsbGVkKHtidW5kbGVJZH0pO1xufTtcblxuY29tbWFuZHMudGVybWluYXRlQXBwID0gYXN5bmMgZnVuY3Rpb24gdGVybWluYXRlQXBwIChidW5kbGVJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5tb2JpbGVUZXJtaW5hdGVBcHAoe2J1bmRsZUlkfSk7XG59O1xuXG5jb21tYW5kcy5xdWVyeUFwcFN0YXRlID0gYXN5bmMgZnVuY3Rpb24gcXVlcnlBcHBTdGF0ZSAoYnVuZGxlSWQpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMubW9iaWxlUXVlcnlBcHBTdGF0ZSh7YnVuZGxlSWR9KTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gTGlzdEFwcHNPcHRpb25zXG4gKiBAcHJvcGVydHkgeydTeXN0ZW0nfCdVc2VyJ30gYXBwbGljYXRpb25UeXBlIFtVc2VyXSBUaGUgdHlwZSBvZiBhcHBsaWNhdGlvbnMgdG8gbGlzdFxuICovXG5cbi8qKlxuICogTGlzdCBhcHBsaWNhdGlvbnMgaW5zdGFsbGVkIG9uIHRoZSByZWFsIGRldmljZSB1bmRlciB0ZXN0XG4gKlxuICogQHBhcmFtIHtMaXN0QXBwc09wdGlvbnN9IG9wdHNcbiAqIEByZXR1cm5zIHtBcnJheTxPYmplY3Q+fSBBIGxpc3Qgb2YgYXBwcywgd2hlcmUgZWFjaCBpdGVtIGlzIGEgbWFwIHdoZXJlIGtleXMgYXJlXG4gKiBidW5kbGUgaWRlbnRpZmllcnMgYW5kIHZhbHVlcyBhcmUgbWFwcyBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBhcHAgcHJvcGVydGllcy5cbiAqL1xuY29tbWFuZHMubW9iaWxlTGlzdEFwcHMgPSBhc3luYyBmdW5jdGlvbiBtb2JpbGVMaXN0QXBwcyAob3B0cyA9IHt9KSB7XG4gIGlmICghdGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcihgVGhpcyBleHRlbnNpb24gaXMgb25seSBzdXBwb3J0ZWQgb24gcmVhbCBkZXZpY2VzYCk7XG4gIH1cblxuICBjb25zdCB7XG4gICAgYXBwbGljYXRpb25UeXBlID0gJ1VzZXInLFxuICB9ID0gb3B0cztcbiAgY29uc3Qgc2VydmljZSA9IGF3YWl0IHNlcnZpY2VzLnN0YXJ0SW5zdGFsbGF0aW9uUHJveHlTZXJ2aWNlKHRoaXMub3B0cy5kZXZpY2UudWRpZCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IHNlcnZpY2UubGlzdEFwcGxpY2F0aW9ucyh7YXBwbGljYXRpb25UeXBlfSk7XG4gIH0gZmluYWxseSB7XG4gICAgc2VydmljZS5jbG9zZSgpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFFBQVEsR0FBRyxDQUFDLENBQUM7QUFFbkIsU0FBU0MsY0FBYyxDQUFFQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEVBQUVDLE9BQU8sR0FBRyxFQUFFLEVBQUU7RUFDaEQsS0FBSyxNQUFNQyxHQUFHLElBQUlELE9BQU8sRUFBRTtJQUN6QixJQUFJLENBQUNFLGVBQUMsQ0FBQ0MsUUFBUSxDQUFDSixJQUFJLENBQUNFLEdBQUcsQ0FBQyxDQUFDLElBQUlDLGVBQUMsQ0FBQ0UsT0FBTyxDQUFDTCxJQUFJLENBQUNFLEdBQUcsQ0FBQyxDQUFDLEVBQUU7TUFDbEQsTUFBTSxJQUFJSSxjQUFNLENBQUNDLG9CQUFvQixDQUNsQyxJQUFHTCxHQUFJLHdDQUF1Q0YsSUFBSSxDQUFDRSxHQUFHLENBQUUsb0JBQW1CLENBQzdFO0lBQ0g7RUFDRjtFQUNBLE9BQU9GLElBQUk7QUFDYjtBQUVBRixRQUFRLENBQUNVLGdCQUFnQixHQUFHLGVBQWVBLGdCQUFnQixDQUFFUixJQUFJLEdBQUcsQ0FBQyxDQUFDLEVBQUU7RUFDdEUsTUFBTTtJ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