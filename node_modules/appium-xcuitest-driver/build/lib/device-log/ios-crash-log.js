"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.IOSCrashLog = void 0;
require("source-map-support/register");
var _support = require("appium/support");
var _bluebird = _interopRequireDefault(require("bluebird"));
var _logger = _interopRequireDefault(require("../logger"));
var _appiumIosDevice = require("appium-ios-device");
var _path = _interopRequireDefault(require("path"));
var _lodash = _interopRequireDefault(require("lodash"));
var _pyIosDeviceClient = _interopRequireDefault(require("../py-ios-device-client"));
const REAL_DEVICE_MAGIC = '3620bbb0-fb9f-4b62-a668-896f2edc4d88';
const MAGIC_SEP = '/';
class IOSCrashLog {
  constructor(opts = {}) {
    this.udid = opts.udid;
    this.pyideviceClient = this.udid ? new _pyIosDeviceClient.default(this.udid) : null;
    const logDir = opts.udid ? _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'CrashReporter', 'MobileDevice') : _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'DiagnosticReports');
    this.logDir = logDir || _path.default.resolve(process.env.HOME || '/', 'Library', 'Logs', 'DiagnosticReports');
    this.prevLogs = [];
    this.logsSinceLastRequest = [];
    this.phoneName = null;
    this.sim = opts.sim;
  }
  async _gatherFromRealDevice() {
    if (await this.pyideviceClient.assertExists(false)) {
      return (await this.pyideviceClient.listCrashes()).map(x => `${REAL_DEVICE_MAGIC}${MAGIC_SEP}${x}`);
    }
    let crashLogsRoot = this.logDir;
    if (this.udid) {
      this.phoneName = this.phoneName || (await _appiumIosDevice.utilities.getDeviceName(this.udid));
      crashLogsRoot = _path.default.resolve(crashLogsRoot, this.phoneName);
    }
    if (!(await _support.fs.exists(crashLogsRoot))) {
      _logger.default.debug(`Crash reports root '${crashLogsRoot}' does not exist. Got nothing to gather.`);
      return [];
    }
    const foundFiles = await _support.fs.glob(`${crashLogsRoot}/**/*.crash`, {
      strict: false
    });
    return foundFiles;
  }
  async _gatherFromSimulator() {
    if (!(await _support.fs.exists(this.logDir))) {
      _logger.default.debug(`Crash reports root '${this.logDir}' does not exist. Got nothing to gather.`);
      return [];
    }
    const foundFiles = await _support.fs.glob(`${this.logDir}/**/*.+(crash|ips)`, {
      strict: false
    });
    return await _bluebird.default.filter(foundFiles, async x => {
      try {
        const content = await _support.fs.readFile(x, 'utf8');
        return content.toUpperCase().includes(this.sim.udid.toUpperCase());
      } catch (err) {
        return false;
      }
    });
  }
  async getCrashes() {
    return this.udid ? await this._gatherFromRealDevice() : await this._gatherFromSimulator();
  }
  async startCapture() {
    this.prevLogs = await this.getCrashes();
  }
  async stopCapture() {}
  async getLogs() {
    let crashFiles = await this.getCrashes();
    let diff = _lodash.default.difference(crashFiles, this.prevLogs, this.logsSinceLastRequest);
    this.logsSinceLastRequest = _lodash.default.union(this.logsSinceLastRequest, diff);
    return await this.filesToJSON(diff);
  }
  async getAllLogs() {
    let crashFiles = await this.getCrashes();
    let logFiles = _lodash.default.difference(crashFiles, this.prevLogs);
    return await this.filesToJSON(logFiles);
  }
  async filesToJSON(paths) {
    const tmpRoot = await _support.tempDir.openDir();
    try {
      return (await _bluebird.default.map(paths, async fullPath => {
        if (_lodash.default.includes(fullPath, REAL_DEVICE_MAGIC)) {
          const fileName = _lodash.default.last(fullPath.split(MAGIC_SEP));
          try {
            await this.pyideviceClient.exportCrash(fileName, tmpRoot);
          } catch (e) {
            _logger.default.warn(`Cannot export the crash report '${fileName}'. Skipping it. ` + `Original error: ${e.message}`);
            return;
          }
          fullPath = _path.default.join(tmpRoot, fileName);
        }
        const stat = await _support.fs.stat(fullPath);
        return {
          timestamp: stat.ctime.getTime(),
          level: 'ALL',
          message: await _support.fs.readFile(fullPath, 'utf8')
        };
      })).filter(Boolean);
    } finally {
      await _support.fs.rimraf(tmpRoot);
    }
  }
}
exports.IOSCrashLog = IOSCrashLog;
var _default = IOSCrashLog;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSRUFMX0RFVklDRV9NQUdJQyIsIk1BR0lDX1NFUCIsIklPU0NyYXNoTG9nIiwiY29uc3RydWN0b3IiLCJvcHRzIiwidWRpZCIsInB5aWRldmljZUNsaWVudCIsIlB5aWRldmljZSIsImxvZ0RpciIsInBhdGgiLCJyZXNvbHZlIiwicHJvY2VzcyIsImVudiIsIkhPTUUiLCJwcmV2TG9ncyIsImxvZ3NTaW5jZUxhc3RSZXF1ZXN0IiwicGhvbmVOYW1lIiwic2ltIiwiX2dhdGhlckZyb21SZWFsRGV2aWNlIiwiYXNzZXJ0RXhpc3RzIiwibGlzdENyYXNoZXMiLCJtYXAiLCJ4IiwiY3Jhc2hMb2dzUm9vdCIsInV0aWxpdGllcyIsImdldERldmljZU5hbWUiLCJmcyIsImV4aXN0cyIsImxvZyIsImRlYnVnIiwiZm91bmRGaWxlcyIsImdsb2IiLCJzdHJpY3QiLCJfZ2F0aGVyRnJvbVNpbXVsYXRvciIsIkIiLCJmaWx0ZXIiLCJjb250ZW50IiwicmVhZEZpbGUiLCJ0b1VwcGVyQ2FzZSIsImluY2x1ZGVzIiwiZXJyIiwiZ2V0Q3Jhc2hlcyIsInN0YXJ0Q2FwdHVyZSIsInN0b3BDYXB0dXJlIiwiZ2V0TG9ncyIsImNyYXNoRmlsZXMiLCJkaWZmIiwiXyIsImRpZmZlcmVuY2UiLCJ1bmlvbiIsImZpbGVzVG9KU09OIiwiZ2V0QWxsTG9ncyIsImxvZ0ZpbGVzIiwicGF0aHMiLCJ0bXBSb290IiwidGVtcERpciIsIm9wZW5EaXIiLCJmdWxsUGF0aCIsImZpbGVOYW1lIiwibGFzdCIsInNwbGl0IiwiZXhwb3J0Q3Jhc2giLCJlIiwid2FybiIsIm1lc3NhZ2UiLCJqb2luIiwic3RhdCIsInRpbWVzdGFtcCIsImN0aW1lIiwiZ2V0VGltZSIsImxldmVsIiwiQm9vbGVhbiIsInJpbXJhZiJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9kZXZpY2UtbG9nL2lvcy1jcmFzaC1sb2cuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZnMsIHRlbXBEaXIgfSBmcm9tICdhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgbG9nIGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQgeyB1dGlsaXRpZXMgfSBmcm9tICdhcHBpdW0taW9zLWRldmljZSc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgUHlpZGV2aWNlIGZyb20gJy4uL3B5LWlvcy1kZXZpY2UtY2xpZW50JztcblxuY29uc3QgUkVBTF9ERVZJQ0VfTUFHSUMgPSAnMzYyMGJiYjAtZmI5Zi00YjYyLWE2NjgtODk2ZjJlZGM0ZDg4JztcbmNvbnN0IE1BR0lDX1NFUCA9ICcvJztcblxuXG5jbGFzcyBJT1NDcmFzaExvZyB7XG4gIGNvbnN0cnVjdG9yIChvcHRzID0ge30pIHtcbiAgICB0aGlzLnVkaWQgPSBvcHRzLnVkaWQ7XG4gICAgdGhpcy5weWlkZXZpY2VDbGllbnQgPSB0aGlzLnVkaWQgPyBuZXcgUHlpZGV2aWNlKHRoaXMudWRpZCkgOiBudWxsO1xuICAgIGNvbnN0IGxvZ0RpciA9IG9wdHMudWRpZFxuICAgICAgPyBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuSE9NRSwgJ0xpYnJhcnknLCAnTG9ncycsICdDcmFzaFJlcG9ydGVyJywgJ01vYmlsZURldmljZScpXG4gICAgICA6IHBhdGgucmVzb2x2ZShwcm9jZXNzLmVudi5IT01FLCAnTGlicmFyeScsICdMb2dzJywgJ0RpYWdub3N0aWNSZXBvcnRzJyk7XG4gICAgdGhpcy5sb2dEaXIgPSBsb2dEaXJcbiAgICAgIHx8IHBhdGgucmVzb2x2ZShwcm9jZXNzLmVudi5IT01FIHx8ICcvJywgJ0xpYnJhcnknLCAnTG9ncycsICdEaWFnbm9zdGljUmVwb3J0cycpO1xuICAgIHRoaXMucHJldkxvZ3MgPSBbXTtcbiAgICB0aGlzLmxvZ3NTaW5jZUxhc3RSZXF1ZXN0ID0gW107XG4gICAgdGhpcy5waG9uZU5hbWUgPSBudWxsO1xuICAgIHRoaXMuc2ltID0gb3B0cy5zaW07XG4gIH1cblxuICBhc3luYyBfZ2F0aGVyRnJvbVJlYWxEZXZpY2UgKCkge1xuICAgIGlmIChhd2FpdCB0aGlzLnB5aWRldmljZUNsaWVudC5hc3NlcnRFeGlzdHMoZmFsc2UpKSB7XG4gICAgICByZXR1cm4gKGF3YWl0IHRoaXMucHlpZGV2aWNlQ2xpZW50Lmxpc3RDcmFzaGVzKCkpXG4gICAgICAgIC5tYXAoKHgpID0+IGAke1JFQUxfREVWSUNFX01BR0lDfSR7TUFHSUNfU0VQfSR7eH1gKTtcbiAgICB9XG5cbiAgICBsZXQgY3Jhc2hMb2dzUm9vdCA9IHRoaXMubG9nRGlyO1xuICAgIGlmICh0aGlzLnVkaWQpIHtcbiAgICAgIHRoaXMucGhvbmVOYW1lID0gdGhpcy5waG9uZU5hbWUgfHwgYXdhaXQgdXRpbGl0aWVzLmdldERldmljZU5hbWUodGhpcy51ZGlkKTtcbiAgICAgIGNyYXNoTG9nc1Jvb3QgPSBwYXRoLnJlc29sdmUoY3Jhc2hMb2dzUm9vdCwgdGhpcy5waG9uZU5hbWUpO1xuICAgIH1cbiAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyhjcmFzaExvZ3NSb290KSkge1xuICAgICAgbG9nLmRlYnVnKGBDcmFzaCByZXBvcnRzIHJvb3QgJyR7Y3Jhc2hMb2dzUm9vdH0nIGRvZXMgbm90IGV4aXN0LiBHb3Qgbm90aGluZyB0byBnYXRoZXIuYCk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGNvbnN0IGZvdW5kRmlsZXMgPSBhd2FpdCBmcy5nbG9iKGAke2NyYXNoTG9nc1Jvb3R9LyoqLyouY3Jhc2hgLCB7XG4gICAgICBzdHJpY3Q6IGZhbHNlXG4gICAgfSk7XG4gICAgcmV0dXJuIGZvdW5kRmlsZXM7XG4gIH1cblxuICBhc3luYyBfZ2F0aGVyRnJvbVNpbXVsYXRvciAoKSB7XG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHModGhpcy5sb2dEaXIpKSB7XG4gICAgICBsb2cuZGVidWcoYENyYXNoIHJlcG9ydHMgcm9vdCAnJHt0aGlzLmxvZ0Rpcn0nIGRvZXMgbm90IGV4aXN0LiBHb3Qgbm90aGluZyB0byBnYXRoZXIuYCk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8vIFRoZSBmaWxlIGZvcm1hdCBoYXMgYmVlbiBjaGFuZ2VkIGZyb20gJy5jcmFzaCcgdG8gJy5pcHMnIHNpbmNlIE1vbnRlcmV5LlxuICAgIGNvbnN0IGZvdW5kRmlsZXMgPSBhd2FpdCBmcy5nbG9iKGAke3RoaXMubG9nRGlyfS8qKi8qLisoY3Jhc2h8aXBzKWAsIHtcbiAgICAgIHN0cmljdDogZmFsc2VcbiAgICB9KTtcbiAgICAvLyBGb3IgU2ltdWxhdG9yIG9ubHkgaW5jbHVkZSBmaWxlcywgdGhhdCBjb250YWluIGN1cnJlbnQgVURJRFxuICAgIHJldHVybiBhd2FpdCBCLmZpbHRlcihmb3VuZEZpbGVzLCBhc3luYyAoeCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKHgsICd1dGY4Jyk7XG4gICAgICAgIHJldHVybiBjb250ZW50LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zaW0udWRpZC50b1VwcGVyQ2FzZSgpKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRDcmFzaGVzICgpIHtcbiAgICByZXR1cm4gdGhpcy51ZGlkXG4gICAgICA/IGF3YWl0IHRoaXMuX2dhdGhlckZyb21SZWFsRGV2aWNlKClcbiAgICAgIDogYXdhaXQgdGhpcy5fZ2F0aGVyRnJvbVNpbXVsYXRvcigpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRDYXB0dXJlICgpIHtcbiAgICB0aGlzLnByZXZMb2dzID0gYXdhaXQgdGhpcy5nZXRDcmFzaGVzKCk7XG4gIH1cblxuICBhc3luYyBzdG9wQ2FwdHVyZSAoKSB7XG4gICAgLy8gbmVlZGVkIGZvciBjb25zaXN0ZW50IEFQSSB3aXRoIG90aGVyIGxvZ3NcbiAgfVxuXG4gIGFzeW5jIGdldExvZ3MgKCkge1xuICAgIGxldCBjcmFzaEZpbGVzID0gYXdhaXQgdGhpcy5nZXRDcmFzaGVzKCk7XG4gICAgbGV0IGRpZmYgPSBfLmRpZmZlcmVuY2UoY3Jhc2hGaWxlcywgdGhpcy5wcmV2TG9ncywgdGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCk7XG4gICAgdGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCA9IF8udW5pb24odGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCwgZGlmZik7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZmlsZXNUb0pTT04oZGlmZik7XG4gIH1cblxuICBhc3luYyBnZXRBbGxMb2dzICgpIHtcbiAgICBsZXQgY3Jhc2hGaWxlcyA9IGF3YWl0IHRoaXMuZ2V0Q3Jhc2hlcygpO1xuICAgIGxldCBsb2dGaWxlcyA9IF8uZGlmZmVyZW5jZShjcmFzaEZpbGVzLCB0aGlzLnByZXZMb2dzKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5maWxlc1RvSlNPTihsb2dGaWxlcyk7XG4gIH1cblxuICBhc3luYyBmaWxlc1RvSlNPTiAocGF0aHMpIHtcbiAgICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiAoYXdhaXQgQi5tYXAocGF0aHMsIGFzeW5jIChmdWxsUGF0aCkgPT4ge1xuICAgICAgICBpZiAoXy5pbmNsdWRlcyhmdWxsUGF0aCwgUkVBTF9ERVZJQ0VfTUFHSUMpKSB7XG4gICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBfLmxhc3QoZnVsbFBhdGguc3BsaXQoTUFHSUNfU0VQKSk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucHlpZGV2aWNlQ2xpZW50LmV4cG9ydENyYXNoKGZpbGVOYW1lLCB0bXBSb290KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2cud2FybihgQ2Fubm90IGV4cG9ydCB0aGUgY3Jhc2ggcmVwb3J0ICcke2ZpbGVOYW1lfScuIFNraXBwaW5nIGl0LiBgICtcbiAgICAgICAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVsbFBhdGggPSBwYXRoLmpvaW4odG1wUm9vdCwgZmlsZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXQgPSBhd2FpdCBmcy5zdGF0KGZ1bGxQYXRoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0aW1lc3RhbXA6IHN0YXQuY3RpbWUuZ2V0VGltZSgpLFxuICAgICAgICAgIGxldmVsOiAnQUxMJyxcbiAgICAgICAgICBtZXNzYWdlOiBhd2FpdCBmcy5yZWFkRmlsZShmdWxsUGF0aCwgJ3V0ZjgnKVxuICAgICAgICB9O1xuICAgICAgfSkpLmZpbHRlcihCb29sZWFuKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgeyBJT1NDcmFzaExvZyB9O1xuZXhwb3J0IGRlZmF1bHQgSU9TQ3Jhc2hMb2c7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQSxNQUFNQSxpQkFBaUIsR0FBRyxzQ0FBc0M7QUFDaEUsTUFBTUMsU0FBUyxHQUFHLEdBQUc7QUFHckIsTUFBTUMsV0FBVyxDQUFDO0VBQ2hCQyxXQUFXLENBQUVDLElBQUksR0FBRyxDQUFDLENBQUMsRUFBRTtJQUN0QixJQUFJLENBQUNDLElBQUksR0FBR0QsSUFBSSxDQUFDQyxJQUFJO0lBQ3JCLElBQUksQ0FBQ0MsZUFBZSxHQUFHLElBQUksQ0FBQ0QsSUFBSSxHQUFHLElBQUlFLDBCQUFTLENBQUMsSUFBSSxDQUFDRixJQUFJLENBQUMsR0FBRyxJQUFJO0lBQ2xFLE1BQU1HLE1BQU0sR0FBR0osSUFBSSxDQUFDQyxJQUFJLEdBQ3BCSSxhQUFJLENBQUNDLE9BQU8sQ0FBQ0MsT0FBTyxDQUFD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