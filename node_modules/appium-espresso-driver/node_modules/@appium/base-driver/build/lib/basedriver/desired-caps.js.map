{"version":3,"file":"desired-caps.js","names":["validator","_validator","validators","isString","value","isNumber","isNaN","Number","log","warn","isBoolean","includes","isObject","isArray","Array","deprecated","options","key","inclusionCaseInsensitive","option","toLowerCase","toString","promise","B","prettify","val"],"sources":["../../../lib/basedriver/desired-caps.js"],"sourcesContent":["import log from './logger';\nimport _validator from 'validate.js';\nimport B from 'bluebird';\n\nexport const validator =\n  /** @type {import('validate.js').ValidateJS & {promise: typeof import('bluebird')}} */ (\n    _validator\n  );\n\nvalidator.validators.isString = function isString(value) {\n  if (typeof value === 'string') {\n    return null;\n  }\n\n  if (typeof value === 'undefined') {\n    return null;\n  }\n\n  return 'must be of type string';\n};\nvalidator.validators.isNumber = function isNumber(value) {\n  if (typeof value === 'number') {\n    return null;\n  }\n\n  if (typeof value === 'undefined') {\n    return null;\n  }\n\n  // allow a string value\n  if (typeof value === 'string' && !isNaN(Number(value))) {\n    log.warn('Number capability passed in as string. Functionality may be compromised.');\n    return null;\n  }\n\n  return 'must be of type number';\n};\nvalidator.validators.isBoolean = function isBoolean(value) {\n  if (typeof value === 'boolean') {\n    return null;\n  }\n\n  // allow a string value\n  if (typeof value === 'string' && ['true', 'false', ''].includes(value)) {\n    return null;\n  }\n\n  if (typeof value === 'undefined') {\n    return null;\n  }\n\n  return 'must be of type boolean';\n};\nvalidator.validators.isObject = function isObject(value) {\n  if (typeof value === 'object') {\n    return null;\n  }\n\n  if (typeof value === 'undefined') {\n    return null;\n  }\n\n  return 'must be of type object';\n};\nvalidator.validators.isArray = function isArray(value) {\n  if (Array.isArray(value)) {\n    return null;\n  }\n\n  if (typeof value === 'undefined') {\n    return null;\n  }\n\n  return 'must be of type array';\n};\nvalidator.validators.deprecated = function deprecated(value, options, key) {\n  if (options) {\n    log.warn(`${key} is a deprecated capability`);\n  }\n  return null;\n};\nvalidator.validators.inclusionCaseInsensitive = function inclusionCaseInsensitive(value, options) {\n  if (typeof value === 'undefined') {\n    return null;\n  } else if (typeof value !== 'string') {\n    return 'unrecognised';\n  }\n  for (let option of options) {\n    if (option.toLowerCase() === value.toLowerCase()) {\n      return null;\n    }\n  }\n  return `${value} not part of ${options.toString()}`;\n};\n\nvalidator.promise = B;\nvalidator.prettify = function prettify(val) {\n  return val;\n};\n"],"mappings":"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"}