{"version":3,"file":"system.js","names":["VERSION_PATTERN","isWindows","os","type","isMac","isLinux","isOSWin64","process","arch","_","has","env","stdout","exec","trim","is64","macOsxVersion","err","Error","versionMatch"],"sources":["../../lib/system.js"],"sourcesContent":["import {exec} from 'teen_process';\nimport _ from 'lodash';\nimport os from 'os';\n\nconst VERSION_PATTERN = /^(\\d+\\.\\d+)/m;\n\nfunction isWindows() {\n  return os.type() === 'Windows_NT';\n}\n\nfunction isMac() {\n  return os.type() === 'Darwin';\n}\n\nfunction isLinux() {\n  return !isWindows() && !isMac();\n}\n\nfunction isOSWin64() {\n  return process.arch === 'x64' || _.has(process.env, 'PROCESSOR_ARCHITEW6432');\n}\n\nasync function arch() {\n  if (isLinux() || isMac()) {\n    let {stdout} = await exec('uname', ['-m']);\n    return stdout.trim() === 'i686' ? '32' : '64';\n  } else if (isWindows()) {\n    let is64 = this.isOSWin64();\n    return is64 ? '64' : '32';\n  }\n}\n\nasync function macOsxVersion() {\n  let stdout;\n  try {\n    stdout = (await exec('sw_vers', ['-productVersion'])).stdout.trim();\n  } catch (err) {\n    throw new Error(`Could not detect Mac OS X Version: ${err}`);\n  }\n\n  const versionMatch = VERSION_PATTERN.exec(stdout);\n  if (!versionMatch) {\n    throw new Error(`Could not detect Mac OS X Version from sw_vers output: '${stdout}'`);\n  }\n  return versionMatch[1];\n}\n\nexport {isWindows, isMac, isLinux, isOSWin64, arch, macOsxVersion};\n"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;AAEA,MAAMA,eAAe,GAAG,cAAxB;;AAEA,SAASC,SAAT,GAAqB;EACnB,OAAOC,WAAA,CAAGC,IAAH,OAAc,YAArB;AACD;;AAED,SAASC,KAAT,GAAiB;EACf,OAAOF,WAAA,CAAGC,IAAH,OAAc,QAArB;AACD;;AAED,SAASE,OAAT,GAAmB;EACjB,OAAO,CAACJ,SAAS,EAAV,IAAgB,CAACG,KAAK,EAA7B;AACD;;AAED,SAASE,SAAT,GAAqB;EACnB,OAAOC,OAAO,CAACC,IAAR,KAAiB,KAAjB,IAA0BC,eAAA,CAAEC,GAAF,CAAMH,OAAO,CAACI,GAAd,EAAmB,wBAAnB,CAAjC;AACD;;AAED,eAAeH,IAAf,GAAsB;EACpB,IAAIH,OAAO,MAAMD,KAAK,EAAtB,EAA0B;IACxB,IAAI;MAACQ;IAAD,IAAW,MAAM,IAAAC,kBAAA,EAAK,OAAL,EAAc,CAAC,IAAD,CAAd,CAArB;IACA,OAAOD,MAAM,CAACE,IAAP,OAAkB,MAAlB,GAA2B,IAA3B,GAAkC,IAAzC;EACD,CAHD,MAGO,IAAIb,SAAS,EAAb,EAAiB;IACtB,IAAIc,IAAI,GAAG,KAAKT,SAAL,EAAX;IACA,OAAOS,IAAI,GAAG,IAAH,GAAU,IAArB;EACD;AACF;;AAED,eAAeC,aAAf,GAA+B;EAC7B,IAAIJ,MAAJ;;EACA,IAAI;IACFA,MAAM,GAAG,CAAC,MAAM,IAAAC,kBAAA,EAAK,SAAL,EAAgB,CAAC,iBAAD,CAAhB,CAAP,EAA6CD,MAA7C,CAAoDE,IAApD,EAAT;EACD,CAFD,CAEE,OAAOG,GAAP,EAAY;IACZ,MAAM,IAAIC,KAAJ,CAAW,sCAAqCD,GAAI,EAApD,CAAN;EACD;;EAED,MAAME,YAAY,GAAGnB,eAAe,CAACa,IAAhB,CAAqBD,MAArB,CAArB;;EACA,IAAI,CAACO,YAAL,EAAmB;IACjB,MAAM,IAAID,KAAJ,CAAW,2DAA0DN,MAAO,GAA5E,CAAN;EACD;;EACD,OAAOO,YAAY,CAAC,CAAD,CAAnB;AACD"}